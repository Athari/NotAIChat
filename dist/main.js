(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t){return 0===Object.keys(t).length}function i(e){return e&&o(e.destroy)?e.destroy:t}new Set;let c,r=!1;function u(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function g(){return m(" ")}function $(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){t.value=null==e?"":e}function v(t){c=t}new Map;const w=[],x=[];let k=[];const _=[],E=Promise.resolve();let S=!1;function M(t){k.push(t)}const C=new Set;let T=0;function L(){if(0!==T)return;const t=c;do{try{for(;T<w.length;){const t=w[T];T++,v(t),O(t.$$)}}catch(t){throw w.length=0,T=0,t}for(v(null),w.length=0,T=0;x.length;)x.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];C.has(e)||(C.add(e),e())}k.length=0}while(w.length);for(;_.length;)_.pop()();S=!1,C.clear(),v(t)}function O(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const A=new Set;const H="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;let j;function q(t,e){const n=t.$$;null!==n.fragment&&(function(t){const e=[],n=[];k.forEach((s=>-1===t.indexOf(s)?e.push(s):n.push(s))),n.forEach((t=>t())),k=e}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function N(a,l,i,u,d,p,h,m=[-1]){const g=c;v(a);const $=a.$$={fragment:null,ctx:[],props:p,update:t,not_equal:d,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(g?g.$$.context:[])),callbacks:n(),dirty:m,skip_bound:!1,root:l.target||g.$$.root};h&&h($.root);let y=!1;if($.ctx=i?i(a,l.props||{},((t,e,...n)=>{const s=n.length?n[0]:e;return $.ctx&&d($.ctx[t],$.ctx[t]=s)&&(!$.skip_bound&&$.bound[t]&&$.bound[t](s),y&&function(t,e){-1===t.$$.dirty[0]&&(w.push(t),S||(S=!0,E.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(a,t)),e})):[],$.update(),y=!0,s($.before_update),$.fragment=!!u&&u($.ctx),l.target){if(l.hydrate){r=!0;const t=(k=l.target,Array.from(k.childNodes));$.fragment&&$.fragment.l(t),t.forEach(f)}else $.fragment&&$.fragment.c();l.intro&&((b=a.$$.fragment)&&b.i&&(A.delete(b),b.i(x))),function(t,n,a,l){const{fragment:i,after_update:c}=t.$$;i&&i.m(n,a),l||M((()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):s(n),t.$$.on_mount=[]})),c.forEach(M)}(a,l.target,l.anchor,l.customElement),r=!1,L()}var b,x,k;v(g)}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(j=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){q(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const t=s.indexOf(n);-1!==t&&s.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class I{$destroy(){q(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const t=s.indexOf(n);-1!==t&&s.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const{document:P,window:R}=H;function F(t,e,n){const s=t.slice();return s[40]=e[n],s[41]=e,s[42]=n,s}function z(t,e,n){const s=t.slice();return s[43]=e[n],s[44]=e,s[45]=n,s}function B(t){let e,n,o,a,l,i,c,r,p,m,v,w,x,k;function _(){t[19].call(l,t[44],t[45])}function E(){t[20].call(c,t[44],t[45])}function S(){t[21].call(p,t[44],t[45])}function M(){return t[22](t[45])}return w=function(t){let e;return{p(...n){e=n,e.forEach((e=>t.push(e)))},r(){e.forEach((e=>t.splice(t.indexOf(e),1)))}}}(t[18][0]),{c(){e=h("div"),n=h("input"),a=g(),l=h("input"),i=g(),c=h("input"),r=g(),p=h("input"),m=g(),v=h("button"),v.innerHTML='<i class="fa fa-trash-o s-a"></i>',y(n,"type","radio"),y(n,"name","selectedEndpoint"),n.__value=o=t[45],n.value=n.__value,y(n,"title","Set endpoint as current"),y(n,"class","s-a"),y(l,"type","text"),y(l,"placeholder","Display name"),y(l,"class","s-a"),y(c,"type","text"),y(c,"placeholder","API Key"),y(c,"class","s-a"),y(p,"type","text"),y(p,"placeholder","Endpoint URL"),y(p,"class","s-a"),y(v,"title","Delete endpoint"),y(v,"class","s-a"),y(e,"class","endpoint s-a"),w.p(n)},m(s,o){d(s,e,o),u(e,n),n.checked=n.__value===t[1],u(e,a),u(e,l),b(l,t[43].name),u(e,i),u(e,c),b(c,t[43].key),u(e,r),u(e,p),b(p,t[43].url),u(e,m),u(e,v),x||(k=[$(n,"change",t[17]),$(l,"input",_),$(c,"input",E),$(p,"input",S),$(v,"click",M)],x=!0)},p(e,s){t=e,3&s[0]&&(n.checked=n.__value===t[1]),1&s[0]&&l.value!==t[43].name&&b(l,t[43].name),1&s[0]&&c.value!==t[43].key&&b(c,t[43].key),1&s[0]&&p.value!==t[43].url&&b(p,t[43].url)},d(t){t&&f(e),w.r(),x=!1,s(k)}}}function D(t){let e,n,o,a,l,c,r,p,m,v,w,x,k,_,E,S;function M(){t[24].call(n,t[41],t[42])}function C(){return t[25](t[42])}function T(){return t[26](t[42])}function L(){return t[27](t[42])}return{c(){e=h("div"),n=h("textarea"),a=g(),l=h("div"),c=h("button"),c.innerHTML='<i class="fa fa-arrow-up s-a"></i>',p=g(),m=h("button"),v=h("i"),x=g(),k=h("button"),k.innerHTML='<i class="fa fa-trash-o s-a"></i>',_=g(),y(n,"autocomplete","false"),y(n,"class","s-a"),c.disabled=r=t[42]<=0,y(c,"title","Move message up"),y(c,"class","s-a"),y(v,"class","fa fa-arrow-down s-a"),m.disabled=w=t[42]>=t[3].length-1,y(m,"title","Move message down"),y(m,"class","s-a"),y(k,"title","Delete message"),y(k,"class","s-a"),y(l,"class","buttons s-a"),y(e,"class","message s-a")},m(s,r){d(s,e,r),u(e,n),b(n,t[40].text),u(e,a),u(e,l),u(l,c),u(l,p),u(l,m),u(m,v),u(l,x),u(l,k),u(e,_),E||(S=[$(n,"input",M),i(o=X.call(null,n)),$(c,"click",C),$(m,"click",T),$(k,"click",L)],E=!0)},p(e,s){t=e,8&s[0]&&b(n,t[40].text),8&s[0]&&w!==(w=t[42]>=t[3].length-1)&&(m.disabled=w)},d(t){t&&f(e),E=!1,s(S)}}}function J(e){let n,o,a,l,c,r,v,w,x,k,_,E,S,M,C,T,L,O,A,H,j,q,N,I,J,K,U,W,Y,Q,V,Z,tt,et,nt,st,ot,at,lt,it,ct,rt,ut,dt,ft,pt,ht,mt=e[0],gt=[];for(let t=0;t<mt.length;t+=1)gt[t]=B(z(e,mt,t));let $t=e[3],yt=[];for(let t=0;t<$t.length;t+=1)yt[t]=D(F(e,$t,t));return{c(){n=h("link"),o=g(),a=h("div"),l=h("details"),c=h("summary"),c.textContent="Options",r=g(),v=h("div"),w=h("h3"),x=m("Scale Endpoints "),k=h("button"),k.innerHTML='<i class="fa fa-plus s-a"></i>',_=g();for(let t=0;t<gt.length;t+=1)gt[t].c();E=g(),S=h("h3"),S.textContent="Behavior",M=g(),C=h("div"),T=h("div"),L=h("label"),L.textContent="Multi-message count",O=g(),A=h("input"),H=g(),j=h("div");for(let t=0;t<yt.length;t+=1)yt[t].c();q=g(),N=h("div"),I=h("textarea"),K=g(),U=h("div"),W=h("button"),Y=h("i"),Q=g(),V=h("button"),Z=h("i"),et=g(),nt=h("button"),st=h("i"),at=g(),lt=h("button"),it=h("i"),ct=g(),rt=h("button"),rt.innerHTML='<i class="fa fa-clone s-a"></i>',ut=g(),dt=h("p"),ft=m(e[6]),y(n,"rel","stylesheet"),y(n,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"),y(c,"class","s-a"),y(k,"title","Add endpoint"),y(k,"class","s-a"),y(w,"class","s-a"),y(S,"class","s-a"),y(L,"for","multiMessageCount"),y(L,"class","s-a"),y(A,"type","text"),y(A,"id","multiMessageCount"),y(A,"class","s-a"),y(T,"class","option s-a"),y(C,"class","options s-a"),y(v,"class","endpoints s-a"),l.open=!0,y(l,"class","s-a"),y(j,"class","messages s-a"),I.disabled=e[5],y(I,"autocomplete","false"),y(I,"class","s-a"),y(Y,"class","fa fa-paper-plane s-a"),W.disabled=e[5],y(W,"title","Send message"),y(W,"class","s-a"),y(Z,"class","fa fa-rocket s-a"),V.disabled=e[5],y(V,"title",tt="Send message and receive "+e[2]+" messages"),y(V,"class","s-a"),y(st,"class","fa fa-ban s-a"),nt.disabled=ot=!e[5],y(nt,"title","Cancel sending"),y(nt,"class","s-a"),y(it,"class","fa fa-plus s-a"),lt.disabled=e[5],y(lt,"title","Add message without sending"),y(lt,"class","s-a"),y(rt,"title","Copy messages to clipboard"),y(rt,"class","s-a"),y(U,"class","buttons s-a"),y(N,"class","message new-message s-a"),y(dt,"class","status s-a"),y(a,"class","app s-a")},m(t,s){u(P.head,n),d(t,o,s),d(t,a,s),u(a,l),u(l,c),u(l,r),u(l,v),u(v,w),u(w,x),u(w,k),u(v,_);for(let t=0;t<gt.length;t+=1)gt[t]&&gt[t].m(v,null);u(v,E),u(v,S),u(v,M),u(v,C),u(C,T),u(T,L),u(T,O),u(T,A),b(A,e[2]),u(a,H),u(a,j);for(let t=0;t<yt.length;t+=1)yt[t]&&yt[t].m(j,null);u(a,q),u(a,N),u(N,I),b(I,e[4]),u(N,K),u(N,U),u(U,W),u(W,Y),u(U,Q),u(U,V),u(V,Z),u(U,et),u(U,nt),u(nt,st),u(U,at),u(U,lt),u(lt,it),u(U,ct),u(U,rt),u(a,ut),u(a,dt),u(dt,ft),pt||(ht=[$(R,"resize",G),$(k,"click",e[14]),$(A,"input",e[23]),$(I,"input",e[28]),i(J=X.call(null,I)),$(W,"click",e[29]),$(V,"click",e[30]),$(nt,"click",e[9]),$(lt,"click",e[31]),$(rt,"click",e[13])],pt=!0)},p(t,e){if(32771&e[0]){let n;for(mt=t[0],n=0;n<mt.length;n+=1){const s=z(t,mt,n);gt[n]?gt[n].p(s,e):(gt[n]=B(s),gt[n].c(),gt[n].m(v,E))}for(;n<gt.length;n+=1)gt[n].d(1);gt.length=mt.length}if(4&e[0]&&A.value!==t[2]&&b(A,t[2]),6152&e[0]){let n;for($t=t[3],n=0;n<$t.length;n+=1){const s=F(t,$t,n);yt[n]?yt[n].p(s,e):(yt[n]=D(s),yt[n].c(),yt[n].m(j,null))}for(;n<yt.length;n+=1)yt[n].d(1);yt.length=$t.length}var n,s;32&e[0]&&(I.disabled=t[5]),16&e[0]&&b(I,t[4]),32&e[0]&&(W.disabled=t[5]),32&e[0]&&(V.disabled=t[5]),4&e[0]&&tt!==(tt="Send message and receive "+t[2]+" messages")&&y(V,"title",tt),32&e[0]&&ot!==(ot=!t[5])&&(nt.disabled=ot),32&e[0]&&(lt.disabled=t[5]),64&e[0]&&(n=ft,s=""+(s=t[6]),n.wholeText!==s&&(n.data=s))},i:t,o:t,d(t){f(n),t&&f(o),t&&f(a),p(gt,t),p(yt,t),pt=!1,s(ht)}}}const K=20;function U(t){Y({target:t.target.closest(".message").querySelector("textarea")})}function W({target:t}){const e=window.pageYOffset;t.style.height="0",t.style.overflow="hidden",t.style.height=`${Math.max(t.scrollHeight,K)}px`,t.style.overflow="",window.scrollTo(window.pageXOffset,e)}function Y({target:t}){W({target:t}),setTimeout((()=>{W({target:t})}),50)}function G(){for(const t of document.querySelectorAll("textarea"))W({target:t})}function X(t){return Y({target:t}),t.addEventListener("input",W),{destroy:()=>t.removeEventListener("input",W)}}function Q(t,e,n){let s=[],o=0,a=10,l=[],i="",r=!1,u="Welcome!",d=null,f=!1;var p;function h(t,...e){console.log(t,...e),n(6,u=t)}function m(t,e){try{const n=JSON.parse(localStorage.getItem(t))??e;return typeof n==typeof e&&n.constructor.name===e.constructor.name?n:e}catch(n){return h(`Warning: Failed to load ${t} from localStorage: ${n.message}`,n),e}}function g(t,e){try{localStorage.setItem(t,JSON.stringify(e))}catch(e){h(`Warning: Failed to save ${t} to localStorage: ${e.message}`,e)}}function $(){return(Math.max(...l.map((t=>t.id)))??0)+1}async function y(t){return await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+t.key},body:JSON.stringify({input:{input:l.map((t=>t.text)).join("\n")}}),signal:d.signal})}async function b(t,e,s,o){const a=await s.json();return null!=a.error?h(`Received error${o}: ${a.error.code}: ${a.error.message}`):null!=a.output&&(null==e?(e={id:$(),text:a.output},k({target:t.target}),n(3,l=[...l,e])):(e.text+=` ${a.output}`,n(3,l=[...l]),U({target:[...document.querySelectorAll(".messages textarea")].slice(-1)[0]})),h(`Received message${o}`,a)),e}async function v(t,e){n(5,r=!0);try{const n=s[o];if(null==n)throw new Error("No endpoint selected");let a=null;for(let s=0;s<e;s++){const o=e>1?` (${s+1}/${e})`:"";d=new AbortController;const l=performance.now(),i=await y(n),c=`${(performance.now()-l).toFixed(2)} ms`;if(d.signal.aborted)return;if(!i.ok)throw new Error(`${i.status} ${i.statusText}`);a=await b(t,a,i,`${o} in ${c}`)}}catch(t){h(`Error: ${t.message}`,t)}n(5,r=!1)}async function w(t){return await v(t,1)}async function x(t){return await v(t,+a)}function k(t){""!=i&&(n(3,l=[...l,{id:$(),text:i}]),n(4,i=""),U(t))}function _(t){n(3,l=l.filter(((e,n)=>n!==t)))}function E(t,e){void 0!==l[t]&&void 0!==l[e]&&(n(3,[l[t],l[e]]=[l[e],l[t]],l),n(3,l=[...l]))}function S(t){n(0,s=s.filter(((e,n)=>n!==t))),void 0===s[o]&&n(1,o=null)}return p=()=>{n(16,f=!0),"about:"==location.protocol&&(document.querySelector("head style").innerHTML=""),n(3,l=m("messages",[{id:1,text:"Hello GPT-4!"}])),n(0,s=m("endpoints",[{name:"Pretty name",key:"KEY",url:"https://dashboard.scale.com/spellbook/api/v2/deploy/URL"}])),n(1,({selectedEndpointIndex:o,multiMessageCount:a}=m("options",{selectedEndpointIndex:o,multiMessageCount:a})),o,n(2,a))},function(){if(!c)throw new Error("Function called outside component initialization");return c}().$$.on_mount.push(p),t.$$.update=()=>{65551&t.$$.dirty[0]&&f&&(g("messages",l),g("endpoints",s),g("options",{selectedEndpointIndex:o,multiMessageCount:a}))},[s,o,a,l,i,r,u,w,x,function(){null!=d&&(n(5,r=!1),d.abort(),h("Receiving message cancelled"))},k,_,E,async function(){try{await navigator.clipboard.writeText(l.map((t=>t.text)).join("\n")),h("Messages copied to clipboard")}catch(t){h(`Failed to copy messages to clipboard: ${t.message}`,t)}},function(){n(0,s=[...s,{name:"Pretty name",key:"KEY",url:"https://dashboard.scale.com/spellbook/api/v2/deploy/URL"}])},S,f,function(){o=this.__value,n(1,o)},[[]],function(t,e){t[e].name=this.value,n(0,s)},function(t,e){t[e].key=this.value,n(0,s)},function(t,e){t[e].url=this.value,n(0,s)},t=>S(t),function(){a=this.value,n(2,a)},function(t,e){t[e].text=this.value,n(3,l)},t=>E(t,t-1),t=>E(t,t+1),t=>_(t),function(){i=this.value,n(4,i)},t=>w(t),t=>x(t),t=>k(t)]}new class extends I{constructor(t){super(),N(this,t,Q,J,a,{},null,[-1,-1])}}({target:document.querySelector("#root")})})();