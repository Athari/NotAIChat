<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Scale Chat</title><style>:root{--button-width:38px;--gap:8px;color-scheme:dark;overflow-wrap:break-word;font:15px/1.2 Segoe UI, sans-serif}:root .a.a,:root .a.a::before,:root .a.a::after{box-sizing:border-box}.app.a.a{border:solid 1px #666;background:#111;padding:8px;border-radius:8px}details.a.a{border:solid 1px #666;background:#222;padding:8px;margin:0 0 8px 0;border-radius:8px}details.a>details.a{margin:8px 0 0 0}details.a>summary.a{cursor:pointer}details[open].a>summary.a{padding:0 0 8px 0;font-weight:700}h3.a.a{font:inherit;font-weight:500;font-size:1.2em;margin:2px 0}header.a.a{font:inherit;font-weight:400;margin:0}.messages.a.a,.endpoints.a.a,.options.a.a{display:flex;flex-flow:column;gap:8px}.options.a.a{flex-flow:row wrap;gap:8px 24px}.message.a.a,.endpoint.a.a,.option.a.a,.buttons.a.a{display:flex;flex-flow:row;align-items:stretch;gap:8px}.message.a.a{align-items:flex-start}.message.a input[type=text][list].a{flex:0 0 120px}.endpoint.a.a{flex-flow:row wrap}.option.a.a{width:400px}.option.a label.a{flex:1}.option-long.a.a{display:flex;flex-flow:row wrap;gap:8px;align-items:center}.option-long.a button.a{width:auto;padding:0 12px}.a:is(.endpoint) .buttons.a{padding:calc(1lh + 4px) 0 0 0}.new-message.a.a{margin:12px 0 0 0}.new-message.a .buttons.a{flex:0 0 calc((var(--button-width) + var(--gap) + 0px) * 3 - var(--gap));flex-flow:row wrap}label.over.a.a{display:flex;flex-flow:column;flex:1 250px}label.over.a b.a{margin:0 0 4px 0;font-weight:inherit}label.side.a.a{display:flex;flex-flow:row;align-items:center;flex:0;gap:8px;padding:calc(1lh + 4px) 0 0 0}label.side.a b.a{font-weight:inherit}label.side.a input.a:is([type=checkbox], [type=radio]){width:20px;min-height:20px;padding:0;margin:0}textarea.a.a,input[type=text].a.a,select.a.a{flex:1;border-style:solid;border-width:1px;border-radius:4px;padding:2px 6px;font:inherit;resize:none;overflow:hidden}input[type=radio].a.a{align-self:stretch}textarea.a.a:hover{overflow-y:overlay}.status.a.a{display:flex;flex-flow:row;opacity:0.6}.status.a .message.a{flex:1}.status.a .time.a{white-space:nowrap}button.a.a{height:26px;width:var(--button-width);font-size:1em}p.a.a,ul.a.a{margin:4px 0}@media(max-width: 740px){:root.d-compact .buttons.a.a{flex-flow:column}:root.d-compact .endpoint.a.a{flex-flow:row wrap}:root.d-compact .endpoint.a input[type=text].a{flex:200px 1}}@media(max-width: 480px){:root.d-compact .option.a.a{width:100%}}:root:is(.d-mobile, .d-access){--button-width:48px;line-height:1.4}:root:is(.d-mobile, .d-access) button.a.a{height:32px}:root:is(.d-mobile, .d-access) textarea.a.a,:root:is(.d-mobile, .d-access) input[type=text].a.a,:root:is(.d-mobile, .d-access) select.a.a{padding:4px 8px}:root:is(.d-mobile, .d-access) p.a.a,:root:is(.d-mobile, .d-access) ul.a.a{margin:10px 0}:root:is(.d-mobile, .d-access) li.a.a{margin:6px 0}@media(max-width: 840px){:root:is(.d-mobile, .d-access) .buttons.a.a{flex-flow:column}:root:is(.d-mobile, .d-access) .endpoint.a.a{flex-flow:row wrap}:root:is(.d-mobile, .d-access) .endpoint.a input[type=text].a{flex:260px 1}:root:is(.d-mobile, .d-access) .new-message.a .buttons.a{flex:0 0 var(--button-width)}}@media(max-width: 500px){:root:is(.d-mobile, .d-access) .option.a.a{width:100%}}:root.d-access{--button-width:52px;font-size:17px;line-height:1.6}:root.d-access button.a.a{height:38px}</style></head><body><div id="root"></div><script>(()=>{var e={508:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function i(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}l((o=o.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Client=t.AI_PROMPT=t.HUMAN_PROMPT=void 0;const r=n(806),a=s(n(256));t.HUMAN_PROMPT="\n\nHuman:",t.AI_PROMPT="\n\nAssistant:";const i="anthropic-typescript/0.4.3";var l;!function(e){e.Ping="ping"}(l||(l={}));t.Client=class{constructor(e,t){var n;this.apiKey=e,this.apiUrl=null!==(n=null==t?void 0:t.apiUrl)&&void 0!==n?n:"https://api.anthropic.com"}complete(e,t){return o(this,void 0,void 0,(function*(){const n=yield(0,a.default)(`${this.apiUrl}/v1/complete`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Client:i,"X-API-Key":this.apiKey},body:JSON.stringify(Object.assign(Object.assign({},e),{stream:!1})),signal:null==t?void 0:t.signal});if(!n.ok){const e=new Error(`Sampling error: ${n.status} ${n.statusText}`);throw console.error(e),e}return yield n.json()}))}completeStream(e,{onOpen:t,onUpdate:n,signal:s}){const a=new AbortController;return new Promise(((c,u)=>{null==s||s.addEventListener("abort",(e=>{a.abort(e),u({name:"AbortError",message:"Caller aborted completeStream"})})),(0,r.fetchEventSource)(`${this.apiUrl}/v1/complete`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Client:i,"X-API-Key":this.apiKey},body:JSON.stringify(Object.assign(Object.assign({},e),{stream:!0})),signal:a.signal,onopen:e=>o(this,void 0,void 0,(function*(){if(!e.ok)return a.abort(),u(Error(`Failed to open sampling stream, HTTP status code ${e.status}: ${e.statusText}`));t&&(yield Promise.resolve(t(e)))})),onmessage:e=>{if(e.event===l.Ping)return;if("[DONE]"===e.data)return void console.error("Unexpected done message before stop_reason has been issued");const t=JSON.parse(e.data);return n&&Promise.resolve(n(t)).catch((e=>{a.abort(),u(e)})),null!==t.stop_reason?(a.abort(),c(t)):void 0},onerror:e=>(console.error("Sampling error:",e),a.abort(),u(e))})}))}}},366:(e,t)=>{"use strict";var n="copy",o=[],s="f0c5",r="M224 0c-35.3 0-64 28.7-64 64V288c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H224zM64 160c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H288c35.3 0 64-28.7 64-64V384H304v64c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224c0-8.8 7.2-16 16-16h64V160H64z";t.DF={prefix:"far",iconName:n,icon:[512,512,o,s,r]},t.kZ=t.DF},261:(e,t)=>{"use strict";var n="floppy-disk",o=[128190,128426,"save"],s="f0c7",r="M48 96V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V170.5c0-4.2-1.7-8.3-4.7-11.3l33.9-33.9c12 12 18.7 28.3 18.7 45.3V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H309.5c17 0 33.3 6.7 45.3 18.7l74.5 74.5-33.9 33.9L320.8 84.7c-.3-.3-.5-.5-.8-.8V184c0 13.3-10.7 24-24 24H104c-13.3 0-24-10.7-24-24V80H64c-8.8 0-16 7.2-16 16zm80-16v80H272V80H128zm32 240a64 64 0 1 1 128 0 64 64 0 1 1 -128 0z";t.DF={prefix:"far",iconName:n,icon:[448,512,o,s,r]},t.Ed=t.DF},450:(e,t)=>{"use strict";var n="folder-open",o=[128194,128449,61717],s="f07c",r="M384 480h48c11.4 0 21.9-6 27.6-15.9l112-192c5.8-9.9 5.8-22.1 .1-32.1S555.5 224 544 224H144c-11.4 0-21.9 6-27.6 15.9L48 357.1V96c0-8.8 7.2-16 16-16H181.5c4.2 0 8.3 1.7 11.3 4.7l26.5 26.5c21 21 49.5 32.8 79.2 32.8H416c8.8 0 16 7.2 16 16v32h48V160c0-35.3-28.7-64-64-64H298.5c-17 0-33.3-6.7-45.3-18.7L226.7 50.7c-12-12-28.3-18.7-45.3-18.7H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H87.7 384z";t.DF={prefix:"far",iconName:n,icon:[576,512,o,s,r]},t.cC=t.DF},674:(e,t)=>{"use strict";var n="rocket-launch",o=[128640],s="e027",r="M197.9 253.9c12.9 6.4 24.7 14.8 35 25.2s18.8 22.2 25.2 35c105.8-30 156.7-79.5 181.5-126c25-46.8 27.3-97.6 22-137.7c-40.1-5.3-90.9-3-137.7 22c-46.5 24.8-96 75.8-126 181.5zM384 312.1v82.2c0 25.4-13.4 49-35.3 61.9l-88.5 52.5c-7.4 4.4-16.6 4.5-24.1 .2s-12.1-12.2-12.1-20.9l0-114.7c0-22.6-9-44.3-25-60.3s-37.7-25-60.3-25H24c-8.6 0-16.6-4.6-20.9-12.1s-4.2-16.7 .2-24.1l52.5-88.5c13-21.9 36.5-35.3 61.9-35.3h82.2C281.7-3.8 408.8-8.5 483.9 5.3c11.6 2.1 20.7 11.2 22.8 22.8c13.8 75.1 9.1 202.2-122.7 284zM28.3 511.9c-16 .4-28.6-12.2-28.2-28.2C1 446 7.7 379.7 42 345.5c34.4-34.4 90.1-34.4 124.5 0s34.4 90.1 0 124.5C132.3 504.3 66 511 28.3 511.9zm50.2-64.5c12.8-.7 31.2-3.7 41.3-13.7c11.4-11.4 11.4-30 0-41.4s-30-11.4-41.4 0c-10.1 10.1-13 28.5-13.7 41.3c-.5 8 5.9 14.3 13.9 13.9zM328 144a40 40 0 1 1 80 0 40 40 0 1 1 -80 0z";t.DF={prefix:"far",iconName:n,icon:[512,512,o,s,r]},t.XE=t.DF},38:(e,t)=>{"use strict";var n="share-nodes",o=["share-alt"],s="f1e0",r="M448 128C448 181 405 224 352 224C323.1 224 297.2 211.2 279.6 191L189.9 235.9C191.3 242.4 191.1 249.1 191.1 255.1C191.1 262.9 191.3 269.6 189.9 276.1L279.6 320.1C297.2 300.8 323.1 287.1 352 287.1C405 287.1 448 330.1 448 384C448 437 405 480 352 480C298.1 480 256 437 256 384C256 377.1 256.7 370.4 258.1 363.9L168.4 319C150.8 339.2 124.9 352 96 352C42.98 352 0 309 0 255.1C0 202.1 42.98 159.1 96 159.1C124.9 159.1 150.8 172.8 168.4 192.1L258.1 148.1C256.7 141.6 256 134.9 256 128C256 74.98 298.1 32 352 32C405 32 448 74.98 448 128H448zM95.1 304C122.5 304 143.1 282.5 143.1 256C143.1 229.5 122.5 208 95.1 208C69.49 208 47.1 229.5 47.1 256C47.1 282.5 69.49 304 95.1 304zM352 80C325.5 80 304 101.5 304 128C304 154.5 325.5 176 352 176C378.5 176 400 154.5 400 128C400 101.5 378.5 80 352 80zM352 432C378.5 432 400 410.5 400 384C400 357.5 378.5 336 352 336C325.5 336 304 357.5 304 384C304 410.5 325.5 432 352 432z";t.DF={prefix:"far",iconName:n,icon:[448,512,o,s,r]},t.M6=t.DF},929:(e,t)=>{"use strict";var n="turtle",o=[128034],s="f726",r="M336 240V208c0-70.7-57.3-128-128-128S80 137.3 80 208v32H336zm48-32v41.2c0 21.4-17.4 38.8-38.8 38.8H70.8C49.4 288 32 270.6 32 249.2V208c0-97.2 78.8-176 176-176s176 78.8 176 176zm96 80c-8.3 0-16.3-1.6-23.6-4.5C440.3 328 400.4 361 352 367v1 72c0 22.1-17.9 40-40 40H264c-22.1 0-40-17.9-40-40V368H192v72c0 22.1-17.9 40-40 40H104c-22.1 0-40-17.9-40-40V368H24c-13.3 0-24-10.7-24-24s10.7-24 24-24H64h48 32 48 32 48 32 32c44.2 0 80-35.8 80-80V224 192 176c0-35.3 28.7-64 64-64c53 0 96 43 96 96v16c0 35.3-28.7 64-64 64H480zM272 368v64h32V368H272zm-160 0v64h32V368H112zM496 224a16 16 0 1 0 0-32 16 16 0 1 0 0 32z";t.DF={prefix:"far",iconName:n,icon:[576,512,o,s,r]},t.ct=t.DF},743:(e,t)=>{"use strict";var n="arrow-down",o=[8595],s="f063",r="M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z";t.DF={prefix:"fas",iconName:n,icon:[384,512,o,s,r]},t.r5=t.DF},608:(e,t)=>{"use strict";var n="arrow-up",o=[8593],s="f062",r="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z";t.DF={prefix:"fas",iconName:n,icon:[384,512,o,s,r]},t.FP=t.DF},790:(e,t)=>{"use strict";var n=[128683,"cancel"],o="f05e",s="M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z";t.DF={prefix:"fas",iconName:"ban",icon:[512,512,n,o,s]},t.gP=t.DF},531:(e,t)=>{"use strict";var n="paper-plane",o=[61913],s="f1d8",r="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z";t.DF={prefix:"fas",iconName:n,icon:[512,512,o,s,r]},t.XC=t.DF},577:(e,t)=>{"use strict";var n="plus-large",o=[],s="e59e",r="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 192H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H224V480c0 17.7 14.3 32 32 32s32-14.3 32-32V288l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-192 0 0-192z";t.DF={prefix:"fas",iconName:n,icon:[512,512,o,s,r]},t.RL=t.DF},285:(e,t)=>{"use strict";var n="xmark-large",o=[],s="e59b",r="M393.4 41.4c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3L269.3 256 438.6 425.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 301.3 54.6 470.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256 9.4 86.6C-3.1 74.1-3.1 53.9 9.4 41.4s32.8-12.5 45.3 0L224 210.7 393.4 41.4z";t.DF={prefix:"fas",iconName:n,icon:[448,512,o,s,r]},t.FG=t.DF},256:function(e,t){var n="undefined"!=typeof self?self:this,o=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n.iterable&&(t[Symbol.iterator]=function(){return t}),t}function l(e){this.map={},e instanceof l?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function d(e){var t=new FileReader,n=u(t);return t.readAsArrayBuffer(e),n}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:n.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:n.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():n.arrayBuffer&&n.blob&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||s(e))?this._bodyArrayBuffer=p(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var e,t,n,o=c(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=u(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(e,t){e=r(e),t=a(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},l.prototype.delete=function(e){delete this.map[r(e)]},l.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},l.prototype.set=function(e,t){this.map[r(e)]=a(t)},l.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},l.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),i(e)},l.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),i(e)},l.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),i(e)},n.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var h=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(e,t){var n,o,s=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=(n=t.method||this.method||"GET",o=n.toUpperCase(),h.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}function y(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),s=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(s))}})),t}function g(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},f.call(m.prototype),f.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];g.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function v(e,o){return new Promise((function(s,r){var a=new m(e,o);if(a.signal&&a.signal.aborted)return r(new t.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function c(){i.abort()}i.onload=function(){var e,t,n={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",t=new l,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var s=n.join(":").trim();t.append(o,s)}})),t)};n.url="responseURL"in i?i.responseURL:n.headers.get("X-Request-URL");var o="response"in i?i.response:i.responseText;s(new g(o,n))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.onabort=function(){r(new t.DOMException("Aborted","AbortError"))},i.open(a.method,a.url,!0),"include"===a.credentials?i.withCredentials=!0:"omit"===a.credentials&&(i.withCredentials=!1),"responseType"in i&&n.blob&&(i.responseType="blob"),a.headers.forEach((function(e,t){i.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",c),i.onreadystatechange=function(){4===i.readyState&&a.signal.removeEventListener("abort",c)}),i.send(void 0===a._bodyInit?null:a._bodyInit)}))}v.polyfill=!0,e.fetch||(e.fetch=v,e.Headers=l,e.Request=m,e.Response=g),t.Headers=l,t.Request=m,t.Response=g,t.fetch=v,Object.defineProperty(t,"__esModule",{value:!0})}({})}(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var s=o;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},806:(e,t,n)=>{"use strict";function o(e){let t,n,o,s=!1;return function(r){void 0===t?(t=r,n=0,o=-1):t=function(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(t,r);const a=t.length;let i=0;for(;n<a;){s&&(10===t[n]&&(i=++n),s=!1);let r=-1;for(;n<a&&-1===r;++n)switch(t[n]){case 58:-1===o&&(o=n-i);break;case 13:s=!0;case 10:r=n}if(-1===r)break;e(t.subarray(i,r),o),i=n,o=-1}i===a?t=void 0:0!==i&&(t=t.subarray(i),n-=i)}}n.r(t),n.d(t,{EventStreamContentType:()=>r,fetchEventSource:()=>l});var s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n};const r="text/event-stream",a=1e3,i="last-event-id";function l(e,t){var{signal:n,headers:l,onopen:u,onmessage:d,onclose:p,onerror:f,openWhenHidden:h,fetch:m}=t,y=s(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((t,s)=>{const g=Object.assign({},l);let b;function v(){b.abort(),document.hidden||P()}g.accept||(g.accept=r),"undefined"==typeof document||h||document.addEventListener("visibilitychange",v);let x=a,$=0;function w(){"undefined"==typeof document||h||document.removeEventListener("visibilitychange",v),clearTimeout($),b.abort()}null==n||n.addEventListener("abort",(()=>{w(),t()}));const k=null!=m?m:fetch,C=null!=u?u:c;async function P(){var n;b=new AbortController;try{const n=await k(e,Object.assign(Object.assign({},y),{headers:g,signal:b.signal}));await C(n),await async function(e,t){const n=e.getReader();let o;for(;!(o=await n.read()).done;)t(o.value)}(n.body,o(function(e,t,n){let o={data:"",event:"",id:"",retry:void 0};const s=new TextDecoder;return function(r,a){if(0===r.length)null==e||e(o),o={data:"",event:"",id:"",retry:void 0};else if(a>0){const e=s.decode(r.subarray(0,a)),i=a+(32===r[a+1]?2:1),l=s.decode(r.subarray(i));switch(e){case"data":o.data=o.data?o.data+"\n"+l:l;break;case"event":o.event=l;break;case"id":null==t||t(o.id=l);break;case"retry":const e=parseInt(l,10);isNaN(e)||null==n||n(o.retry=e)}}}}(d,(e=>{e?g[i]=e:delete g[i]}),(e=>{x=e})))),null==p||p(),w(),t()}catch(e){if(!b.signal.aborted)try{const t=null!==(n=null==f?void 0:f(e))&&void 0!==n?n:x;clearTimeout($),$=setTimeout(P,t)}catch(e){w(),s(e)}}}P()}))}function c(e){const t=e.headers.get("content-type");if(!(null==t?void 0:t.startsWith(r)))throw new Error(`Expected content-type to be ${r}, Actual: ${t}`)}}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function s(){return Object.create(null)}function r(e){e.forEach(o)}function a(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e){return 0===Object.keys(e).length}function c(t){return t&&a(t.destroy)?t.destroy:e}new Set;let u=!1;function d(e,t){e.appendChild(t)}function p(e,t,n){e.insertBefore(t,n||null)}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function h(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function y(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function g(e){return document.createTextNode(e)}function b(){return g(" ")}function v(){return g("")}function x(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e){let t;return{p(...n){t=n,t.forEach((t=>e.push(t)))},r(){t.forEach((t=>e.splice(e.indexOf(t),1)))}}}function k(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function C(e,t){e.value=null==t?"":t}function P(e,t,n,o){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function _(e,t,n){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}function O(e){const t=e.querySelector(":checked");return t&&t.__value}function E(e,t,n){e.classList[n?"add":"remove"](t)}new Map;let S;function A(e){S=e}function T(){if(!S)throw new Error("Function called outside component initialization");return S}const M=[],R=[];let I=[];const D=[],L=Promise.resolve();let j=!1;function U(){j||(j=!0,L.then(B))}function F(e){I.push(e)}const H=new Set;let N=0;function B(){if(0!==N)return;const e=S;do{try{for(;N<M.length;){const e=M[N];N++,A(e),z(e.$$)}}catch(e){throw M.length=0,N=0,e}for(A(null),M.length=0,N=0;R.length;)R.pop()();for(let e=0;e<I.length;e+=1){const t=I[e];H.has(t)||(H.add(t),t())}I.length=0}while(M.length);for(;D.length;)D.pop()();j=!1,H.clear(),A(e)}function z(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(F)}}const q=new Set;let V;function J(){V={r:0,c:[],p:V}}function G(){V.r||r(V.c),V=V.p}function X(e,t){e&&e.i&&(q.delete(e),e.i(t))}function W(e,t,n,o){if(e&&e.o){if(q.has(e))return;q.add(e),V.c.push((()=>{q.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}else o&&o()}function Y(e,t){const n=t.token={};function o(e,o,s,r){if(t.token!==n)return;t.resolved=r;let a=t.ctx;void 0!==s&&(a=a.slice(),a[s]=r);const i=e&&(t.current=e)(a);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(J(),W(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),G())})):t.block.d(1),i.c(),X(i,1),i.m(t.mount(),t.anchor),l=!0),t.block=i,t.blocks&&(t.blocks[o]=i),l&&B()}if(!(s=e)||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof s.then){if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}else{const n=T();if(e.then((e=>{A(n),o(t.then,1,t.value,e),A(null)}),(e=>{if(A(n),o(t.catch,2,t.error,e),A(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}var s}function K(e,t,n){const o=t.slice(),{resolved:s}=e;e.current===e.then&&(o[e.value]=s),e.current===e.catch&&(o[e.error]=s),e.block.p(o,n)}const Z="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Q(e,t){const n={},o={},s={$$scope:1};let r=e.length;for(;r--;){const a=e[r],i=t[r];if(i){for(const e in a)e in i||(o[e]=1);for(const e in i)s[e]||(n[e]=i[e],s[e]=1);e[r]=i}else for(const e in a)s[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}function ee(e){return"object"==typeof e&&null!==e?e:{}}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let te;function ne(e){e&&e.c()}function oe(e,t,n,s){const{fragment:i,after_update:l}=e.$$;i&&i.m(t,n),s||F((()=>{const t=e.$$.on_mount.map(o).filter(a);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),l.forEach(F)}function se(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];I.forEach((o=>-1===e.indexOf(o)?t.push(o):n.push(o))),n.forEach((e=>e())),I=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function re(t,n,o,a,i,l,c,d=[-1]){const p=S;A(t);const h=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:i,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(p?p.$$.context:[])),callbacks:s(),dirty:d,skip_bound:!1,root:n.target||p.$$.root};c&&c(h.root);let m=!1;if(h.ctx=o?o(t,n.props||{},((e,n,...o)=>{const s=o.length?o[0]:n;return h.ctx&&i(h.ctx[e],h.ctx[e]=s)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](s),m&&function(e,t){-1===e.$$.dirty[0]&&(M.push(e),U(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],h.update(),m=!0,r(h.before_update),h.fragment=!!a&&a(h.ctx),n.target){if(n.hydrate){u=!0;const e=(y=n.target,Array.from(y.childNodes));h.fragment&&h.fragment.l(e),e.forEach(f)}else h.fragment&&h.fragment.c();n.intro&&X(t.$$.fragment),oe(t,n.target,n.anchor,n.customElement),u=!1,B()}var y;A(p)}"function"==typeof HTMLElement&&(te=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(o).filter(a);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){se(this,1),this.$destroy=e}$on(t,n){if(!a(n))return e;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const e=o.indexOf(n);-1!==e&&o.splice(e,1)}}$set(e){this.$$set&&!l(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ae{$destroy(){se(this,1),this.$destroy=e}$on(t,n){if(!a(n))return e;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const e=o.indexOf(n);-1!==e&&o.splice(e,1)}}$set(e){this.$$set&&!l(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ie=parseFloat;function le(e,t=";"){let n;if(Array.isArray(e))n=e.filter((e=>e));else{n=[];for(const t in e)e[t]&&n.push(`${t}:${e[t]}`)}return n.join(t)}function ce(e){let t,n,o,s,r,a,i,l;function c(e,t){return"string"==typeof e[10][4]?de:ue}let u=c(e),h=u(e);return{c(){t=y("svg"),n=y("g"),o=y("g"),h.c(),$(o,"transform",e[12]),$(n,"transform",s="translate("+e[10][0]/2+" "+e[10][1]/2+")"),$(n,"transform-origin",r=e[10][0]/4+" 0"),$(t,"id",a=e[1]||void 0),$(t,"class",i="svelte-fa "+e[0]+" f"),$(t,"style",e[11]),$(t,"viewBox",l="0 0 "+e[10][0]+" "+e[10][1]),$(t,"aria-hidden","true"),$(t,"role","img"),$(t,"xmlns","http://www.w3.org/2000/svg"),E(t,"pulse",e[4]),E(t,"spin",e[3])},m(e,s){p(e,t,s),d(t,n),d(n,o),h.m(o,null)},p(e,d){u===(u=c(e))&&h?h.p(e,d):(h.d(1),h=u(e),h&&(h.c(),h.m(o,null))),4096&d&&$(o,"transform",e[12]),1024&d&&s!==(s="translate("+e[10][0]/2+" "+e[10][1]/2+")")&&$(n,"transform",s),1024&d&&r!==(r=e[10][0]/4+" 0")&&$(n,"transform-origin",r),2&d&&a!==(a=e[1]||void 0)&&$(t,"id",a),1&d&&i!==(i="svelte-fa "+e[0]+" f")&&$(t,"class",i),2048&d&&$(t,"style",e[11]),1024&d&&l!==(l="0 0 "+e[10][0]+" "+e[10][1])&&$(t,"viewBox",l),17&d&&E(t,"pulse",e[4]),9&d&&E(t,"spin",e[3])},d(e){e&&f(t),h.d()}}}function ue(e){let t,n,o,s,r,a,i,l,c,u;return{c(){t=y("path"),a=y("path"),$(t,"d",n=e[10][4][0]),$(t,"fill",o=e[6]||e[2]||"currentColor"),$(t,"fill-opacity",s=0!=e[9]?e[7]:e[8]),$(t,"transform",r="translate("+e[10][0]/-2+" "+e[10][1]/-2+")"),$(a,"d",i=e[10][4][1]),$(a,"fill",l=e[5]||e[2]||"currentColor"),$(a,"fill-opacity",c=0!=e[9]?e[8]:e[7]),$(a,"transform",u="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")},m(e,n){p(e,t,n),p(e,a,n)},p(e,d){1024&d&&n!==(n=e[10][4][0])&&$(t,"d",n),68&d&&o!==(o=e[6]||e[2]||"currentColor")&&$(t,"fill",o),896&d&&s!==(s=0!=e[9]?e[7]:e[8])&&$(t,"fill-opacity",s),1024&d&&r!==(r="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")&&$(t,"transform",r),1024&d&&i!==(i=e[10][4][1])&&$(a,"d",i),36&d&&l!==(l=e[5]||e[2]||"currentColor")&&$(a,"fill",l),896&d&&c!==(c=0!=e[9]?e[8]:e[7])&&$(a,"fill-opacity",c),1024&d&&u!==(u="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")&&$(a,"transform",u)},d(e){e&&f(t),e&&f(a)}}}function de(e){let t,n,o,s;return{c(){t=y("path"),$(t,"d",n=e[10][4]),$(t,"fill",o=e[2]||e[5]||"currentColor"),$(t,"transform",s="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")},m(e,n){p(e,t,n)},p(e,r){1024&r&&n!==(n=e[10][4])&&$(t,"d",n),36&r&&o!==(o=e[2]||e[5]||"currentColor")&&$(t,"fill",o),1024&r&&s!==(s="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")&&$(t,"transform",s)},d(e){e&&f(t)}}}function pe(t){let n,o=t[10][4]&&ce(t);return{c(){o&&o.c(),n=v()},m(e,t){o&&o.m(e,t),p(e,n,t)},p(e,[t]){e[10][4]?o?o.p(e,t):(o=ce(e),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:e,o:e,d(e){o&&o.d(e),e&&f(n)}}}function fe(e,t,n){let o,s,r,{class:a=""}=t,{id:i=""}=t,{style:l=""}=t,{icon:c}=t,{size:u=""}=t,{color:d=""}=t,{fw:p=!1}=t,{pull:f=""}=t,{scale:h=1}=t,{translateX:m=0}=t,{translateY:y=0}=t,{rotate:g=""}=t,{flip:b=!1}=t,{spin:v=!1}=t,{pulse:x=!1}=t,{primaryColor:$=""}=t,{secondaryColor:w=""}=t,{primaryOpacity:k=1}=t,{secondaryOpacity:C=.4}=t,{swapOpacity:P=!1}=t;return e.$$set=e=>{"class"in e&&n(0,a=e.class),"id"in e&&n(1,i=e.id),"style"in e&&n(13,l=e.style),"icon"in e&&n(14,c=e.icon),"size"in e&&n(15,u=e.size),"color"in e&&n(2,d=e.color),"fw"in e&&n(16,p=e.fw),"pull"in e&&n(17,f=e.pull),"scale"in e&&n(18,h=e.scale),"translateX"in e&&n(19,m=e.translateX),"translateY"in e&&n(20,y=e.translateY),"rotate"in e&&n(21,g=e.rotate),"flip"in e&&n(22,b=e.flip),"spin"in e&&n(3,v=e.spin),"pulse"in e&&n(4,x=e.pulse),"primaryColor"in e&&n(5,$=e.primaryColor),"secondaryColor"in e&&n(6,w=e.secondaryColor),"primaryOpacity"in e&&n(7,k=e.primaryOpacity),"secondaryOpacity"in e&&n(8,C=e.secondaryOpacity),"swapOpacity"in e&&n(9,P=e.swapOpacity)},e.$$.update=()=>{16384&e.$$.dirty&&n(10,o=c&&c.icon||[0,0,"",[],""]),237568&e.$$.dirty&&n(11,s=function(e,t,n,o){let s,r,a,i,l,c="-.125em";return o&&(l="center",r="1.25em"),n&&(s=n),t&&("lg"==t?(i="1.33333em",a=".75em",c="-.225em"):i="xs"==t?".75em":"sm"==t?".875em":t.replace("x","em")),le([le({float:s,width:r,height:"1em","line-height":a,"font-size":i,"text-align":l,"vertical-align":c,"transform-origin":"center",overflow:"visible"}),e])}(l,u,f,p)),8126464&e.$$.dirty&&n(12,r=function(e,t,n,o,s,r=1,a="",i=""){let l=1,c=1;return s&&("horizontal"==s?l=-1:"vertical"==s?c=-1:l=c=-1),le([`translate(${ie(t)*r}${a},${ie(n)*r}${a})`,`scale(${l*ie(e)},${c*ie(e)})`,o&&`rotate(${o}${i})`]," ")}(h,m,y,g,b,512))},[a,i,d,v,x,$,w,k,C,P,o,s,r,l,c,u,p,f,h,m,y,g,b]}const he=class extends ae{constructor(e){super(),re(this,e,fe,pe,i,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}};function me(e){return new Promise((t=>{setTimeout(t,e)}))}function ye(e,t){try{const n=JSON.parse(localStorage.getItem(e));return null!==n&&typeof n==typeof t&&n.constructor.name===t.constructor.name?"Object"===n.constructor.name?Object.assign(t,n):n:t}catch(n){return log(`Warning: Failed to load ${e} from localStorage: ${n.message}`,n),t}}function ge(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(t){log(`Warning: Failed to save ${e} to localStorage: ${t.message}`,t)}}function be(e){document.querySelector("#uploadFileUtil")?.remove(),document.body.insertAdjacentHTML("beforeEnd",`<input type="file" id="uploadFileUtil" accept="${e}" style="position: absolute; width: 0; height: 0; overflow: hidden;" />`);const t=document.querySelector("#uploadFileUtil");return new Promise(((e,n)=>{let o=!1;t.addEventListener("change",(async()=>{o=!0;try{e(JSON.parse(await t.files[0].text()))}catch(e){n(e)}t.remove()}),{once:!0}),window.addEventListener("focus",(()=>{setTimeout((()=>{o||(e(null),t.remove())}),300)}),{once:!0}),t.click()}))}var ve=n(508);class xe{static providers=[];static proxies=[];displayName;id;defaultConfig;messageRoles;models;runner;constructor(e,t,n,o,s,r){Object.assign(this,{id:e,displayName:t,runner:n,configGetter:o,messageRoles:s,models:r})}static init(){xe.providers=[new xe("","",we,{},[],[]),new xe("openai-text","OpenAI Text (TODO)",ke,{key:"",url:"",model:"",stream:!1},[],["text-davinci-003","text-davinci-002","davinci"]),new xe("openai-chat","OpenAI Chat (TODO)",Ce,{key:"",url:"",model:"",stream:!1},["user","assistant","system"],["gpt-4","gpt-4-32k","gpt-3.5-turbo"]),new xe("anthropic-chat","Anthropic",Pe,{key:"",url:"",model:"",stream:!1},["human","assistant"],["claude-v1","claude-v1.0","claude-v1.2","claude-instant-v1","claude-instant-v1.0"]),new xe("steamship-plugin","SteamShip Plugin",_e,{key:"",workspace:"",model:""},[],["gpt-3","gpt-4"]),new xe("scale-spellbook","Scale Spellbook",Oe,{key:"",url:""},[],[]),new xe("scale-spellbook-fish","Scale Spellbook (Fish proxy)",Ee,{key:"",url:""},[],[]),new xe("chatbotkit","ChatBotKit",Se,{key:"",url:"",model:"",stream:!1},["user","bot","context","instruction","backstory"],["gpt-4","gbt-3.5-turbo","text-davinci-003","text-davinci-002","text-algo-003","text-algo-002","text-algo-001"])],xe.proxies=[new xe("","Direct",Te,{}),new xe("cors-anywhere","CORS Anywhere",Me,{url:""})]}createConfig(){return Object.assign({},{typeId:this.id,name:"Name"},this.defaultConfig)}static createConnection(e,t){if(null==e)return null;const n=xe.getProvider(e.typeId);if(n.runner===we)return null;const o=xe.getProxy(t?.typeId);return new n.runner(e,new o.runner(t))}static getProvider(e){return xe.providers.filter((t=>t.id==e))[0]??xe.providers[0]}static getProxy(e){return xe.proxies.filter((t=>t.id==e))[0]??xe.proxies[0]}static createDefaultProviderConfig(){return xe.providers[0].createConfig()}static createDefaultProxyConfig(){return xe.proxies[0].createConfig()}}class $e{config;proxy;onMessage;onLogMessage;onError;constructor(e,t){if(this.constructor===$e)throw new Ie(this);Object.assign(this,{config:e,proxy:t})}async sendRequest(e){return{error:"Provider not implemented"}}async fetch(e,t){const n=await fetch(e,t),o={};return n.headers.forEach(((e,t)=>o[t]=e)),console.log("Received HTTP response:",n,"headers:",o),n}async handleJsonResponse(e,t){let n;try{n=await t.text()}catch(n){return this.raiseError("Failed to decode message",n,e,t),!1}try{return await this.handleJson(JSON.parse(n),e,t)}catch(o){return this.raiseError(n.length>4096?"Failed to parse message":n,o,e,t),!1}}async handleJson(e,t,n){throw new Re("handleJson")}raiseLogMessage(e){this.onLogMessage?.call(this,e)}raiseMessage(e){return this.onMessage?.call(this,e),!0}raiseError(e,t,n,o){const s=null==o||o.ok?"":` (HTTP code: ${o.status}${` ${o.statusText}`.trim()})`;return this.onError?.call(this,{text:`${e}${n.extraText}: ${t?.message}${s}`,error:t}),!1}}class we extends $e{async sendRequest(e){return{error:"Provider not set"}}}class ke extends $e{}class Ce extends $e{}class Pe extends $e{async sendRequest(e){const t=new ve.Client(this.config.key,{apiUrl:this.proxy.modifyUrl(this.config.url||"https://api.anthropic.com")}),n={prompt:e.messages.filter((e=>e.text?.length>0)).map((e=>{return`${t=e.role,(t||"").match(/user|human/i)?ve.HUMAN_PROMPT:ve.AI_PROMPT} ${e.text}`;var t})).join("")+ve.AI_PROMPT,model:this.config.model,temperature:1,max_tokens_to_sample:2048,stop_sequences:[ve.HUMAN_PROMPT]};let o=null;try{if(this.config.stream){let s="";return await t.completeStream(n,{onOpen:e=>{o=e},onUpdate:t=>{if(null!=t.exception)return this.raiseError("Received error",new Error(t.exception),e,o);this.raiseMessage({text:t.completion.substring(s.length),role:"assistant",mode:"append"}),s=t.completion},signal:e.signal}),this.raiseMessage({text:"",role:"assistant",mode:"done"})}{const s=await t.complete(n,{signal:e.signal});return null!=s.exception?this.raiseError("Received error",new Error(s.exception),e,o):this.raiseMessage({text:s.completion,role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,o)}}}class _e extends $e{async sendRequest(e){const t=e.messages.filter((e=>e.text?.length>0));let[n,o]=await this.callApi(e,"plugin/instance/generate",{appendOutputToFile:!1,text:t.map((e=>e.text)).join("\n"),pluginInstance:this.config.workspace});if(!1===o)return!1;console.log("SteamShip init",o);const s=o?.status?.taskId;if(null==s)return this.raiseError("Failed to generate",new Error("No task id"),e,n);this.raiseLogMessage({text:"Sending message (done: generate)"});let r="";for(;;){if([n,o]=await this.callApi(e,"task/status",{taskId:s}),!1===o)return;if(console.log("SteamShip poll",o.status.state,o),null!=o.data){const e=o.data.blocks[0];return this.raiseMessage({text:e.text,role:e.tags.filter((e=>"role"==e.kind))[0]?.name??"assistant",mode:"complete"})}r!=o.status.state&&(r=o.status.state,this.raiseLogMessage({text:`Sending message (${r})`})),await me(2e3)}}async callApi(e,t,n){const o=this.config.url||"https://api.steamship.com/api/v1/",s=await this.fetch(this.proxy.modifyUrl(new URL(t,o).toString()),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.key}`,"X-Workspace-Handle":this.config.workspace},body:JSON.stringify(n),signal:e.signal});return[s,await this.handleJsonResponse(e,s)]}async handleJson(e,t,n){if("failed"==e?.status?.state){const{statusCode:o,statusMessage:s}=e.status,r=`${null!=o?`${o}: `:""}${s}`;return this.raiseError("Received error message",new Error(r),t,n)}return e}}class Oe extends $e{async sendRequest(e){let t=e.messages.map((e=>e.text)).join("\n"),n=await this.getResponse(e,t);return await this.handleJsonResponse(e,n)}async getResponse(e,t){return await this.fetch(this.proxy.modifyUrl(this.config.url),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+this.config.key},body:JSON.stringify({input:{input:t}}),signal:e.signal})}async handleJson(e,t,n){return null==e.output||null!=e.message?this.raiseError("Received error message",new Error(e.message||"Unknown"),t,n):this.raiseMessage({text:e.output,role:"",mode:"complete"})}}class Ee extends $e{pusher;async getResponse(e,t){return await this.fetch("https://fishtailprotocol.com/projects/betterGPT4/scale-api.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({OAIToken:this.config.key,scaleURL:this.config.url,chatLog:t}),signal:e.signal})}async handleJson(e,t,n){return super.handleJson(e.response,t,n)}}class Se extends $e{static baseApiUrl="https://api.chatbotkit.com/v1/";async sendRequest(e){const t={assistant:"bot",system:"backstory"},n=e=>"backstory"==e||"system"==e;let o,s;const r=e.messages.filter((e=>e.text?.length>0)),a=r.filter((e=>!n(e.role))),i=r.filter((e=>n(e.role))),l=a.slice(0,-1);if([o,s]=await this.callApi(e,"conversation/create",{backstory:i.map((e=>e.text)).join("\n"),model:this.config.model,datasetId:"",skillsetId:"",messages:l.map((e=>({type:t[e.role]||e.role||"user",text:e.text})))}),!1===s)return!1;const c=s.id;let u=null;try{const t=a.slice(-1)[0];if([o,s]=await this.callApi(e,`conversation/${c}/send`,{text:t.text,entities:[]}),!1===s)return!1;if(this.config.stream){try{await this.connectToPusher(e)}catch(t){return this.raiseError("Failed to receive message",t,e,null),!1}const t=function(){try{return crypto.randomUUID()}catch{try{return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}catch{return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}}}();this.pusher.send(JSON.stringify({event:"pusher:subscribe",data:{auto:"",channel:t}})),[o,s]=await this.callApi(e,`conversation/${c}/receive`,{parse:!1,channel:t}),u={text:"",role:"bot",mode:"done"}}else{if([o,s]=await this.callApi(e,`conversation/${c}/receive`,{parse:!1}),!1===s)return!1;u={role:"bot",text:s.text,mode:"complete"}}}finally{try{[o,s]=await this.callApi(e,`conversation/${c}/delete`,{},!1)}finally{null!=u&&this.raiseMessage(u)}}return!0}async connectToPusher(e){if(null!=this.pusher)return;const t="a9198d6754ae6285290b",n="mt1",o=new URLSearchParams({protocol:7,client:"js",version:"8.0.1"});let s=null;var r;this.pusher=new WebSocket(`wss://ws-${n}.pusher.com/app/${t}?${o}`),this.pusher.addEventListener("message",(t=>{if(e.signal.aborted)return void this.pusher.close();const n=JSON.parse(t.data),o="string"==typeof n.data?JSON.parse(n.data):null;switch(console.log("Pusher message",n,"data",o),n.event){case"pusher:connection_established":s?.call();break;case"batchTokensBegin":console.log("Pusher begin tokens",n.channel);break;case"batchTokensAvailable":const e=o.tokens.join("");console.log("Pusher tokens",n.channel,e),this.raiseMessage({text:e,role:"bot",mode:"append"});break;case"batchTokensEnd":console.log("Pusher end tokens",n.channel,o.messageId),this.pusher.close()}})),this.pusher.addEventListener("error",(t=>{this.raiseError("Pusher error",new Error(`${t}`),e,null)})),console.log(this.pusher),await Promise.race([(r=1e4,new Promise(((e,t)=>{setTimeout((()=>t(new Error(`Timeout ${r} ms`))),r)}))),new Promise((e=>{s=e}))])}async callApi(e,t,n,o=!0){const s=this.config.url||Se.baseApiUrl,r=await this.fetch(this.proxy.modifyUrl(new URL(t,s).toString()),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.key}`},body:JSON.stringify(n),signal:e.signal}),a=t.replace(/\/(.*\/)?/," - "),i=await this.handleJsonResponse(e,r);return!1!==i&&o&&this.raiseLogMessage({text:`Sending message (done: ${a})`,data:[i]}),[r,i]}async handleJson(e,t,n){return null!=e.message?this.raiseError("Received error message",new Error(`${e.code}: ${e.message}`),t,n):e}}class Ae{config;constructor(e){if(this.constructor===Ae)throw new Ie(this);Object.assign(this,{config:e})}modifyUrl(e){return e}}class Te extends Ae{}class Me extends Ae{modifyUrl(e){return(this.config.url||"https://cors-anywhere.herokuapp.com/")+e}}class Re extends Error{constructor(e){super(`Method ${e} not impleented`)}}class Ie extends Error{constructor(e){super(`Can not instantiate abstract class ${e.constructor.name}`)}}var De=n(743),Le=n(608),je=n(790),Ue=n(366),Fe=n(261),He=n(450),Ne=n(531),Be=n(577),ze=n(674),qe=n(38),Ve=n(929),Je=n(285);const{window:Ge}=Z;function Xe(e,t,n){const o=e.slice();return o[86]=t[n],o}function We(e,t,n){const o=e.slice();return o[89]=t[n],o}function Ye(e,t,n){const o=e.slice();return o[92]=t[n],o}function Ke(e,t,n){const o=e.slice();return o[95]=t[n],o[96]=t,o[97]=n,o}function Ze(e,t,n){const o=e.slice();return o[98]=t[n],o[99]=t,o[100]=n,o}function Qe(e,t,n){const o=e.slice();return o[98]=t[n],o}function et(e,t,n){const o=e.slice();return o[103]=t[n],o[104]=t,o[105]=n,o}function tt(e,t,n){const o=e.slice();return o[86]=t[n],o}function nt(t){let n,o,s,r=t[86].displayName+"";return{c(){n=m("option"),o=g(r),n.__value=s=t[86].id,n.value=n.__value,$(n,"class","a")},m(e,t){p(e,n,t),d(n,o)},p:e,d(e){e&&f(n)}}}function ot(t){return{c:e,m:e,p:e,d:e}}function st(e){let t,n,o;function s(e,t){return"openai-text"==e[86].id||"openai-chat"==e[86].id||"chatbotkit"==e[86].id||"anthropic-chat"==e[86].id?lt:"steamship-plugin"==e[86].id?it:"scale-spellbook"==e[86].id||"scale-spellbook-fish"==e[86].id?at:rt}let r=s(e),a=r(e),i=e[86].models.length>0&&ct(e),l=("openai-text"==e[86].id||"openai-chat"==e[86].id||"chatbotkit"==e[86].id||"anthropic-chat"==e[86].id)&&ut(e);return{c(){a.c(),t=b(),i&&i.c(),n=b(),l&&l.c(),o=v()},m(e,s){a.m(e,s),p(e,t,s),i&&i.m(e,s),p(e,n,s),l&&l.m(e,s),p(e,o,s)},p(e,c){r===(r=s(e))&&a?a.p(e,c):(a.d(1),a=r(e),a&&(a.c(),a.m(t.parentNode,t))),e[86].models.length>0?i?i.p(e,c):(i=ct(e),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null),"openai-text"==e[86].id||"openai-chat"==e[86].id||"chatbotkit"==e[86].id||"anthropic-chat"==e[86].id?l?l.p(e,c):(l=ut(e),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null)},d(e){a.d(e),e&&f(t),i&&i.d(e),e&&f(n),l&&l.d(e),e&&f(o)}}}function rt(t){let n;return{c(){n=m("b"),n.textContent="Choose endpoint provider",$(n,"class","a")},m(e,t){p(e,n,t)},p:e,d(e){e&&f(n)}}}function at(e){let t,n,o,s,a,i,l,c,u,h,y;function g(){e[39].call(s,e[104],e[105])}function v(){e[40].call(u,e[104],e[105])}return{c(){t=m("label"),n=m("b"),n.textContent="Deployment key",o=b(),s=m("input"),a=b(),i=m("label"),l=m("b"),l.textContent="Deployment URL",c=b(),u=m("input"),$(n,"class","a"),$(s,"type","text"),$(s,"placeholder","Deployment key"),$(s,"class","a"),$(t,"class","over a"),$(l,"class","a"),$(u,"type","text"),$(u,"placeholder","Deployment URL"),$(u,"class","a"),$(i,"class","over a")},m(r,f){p(r,t,f),d(t,n),d(t,o),d(t,s),C(s,e[103].key),p(r,a,f),p(r,i,f),d(i,l),d(i,c),d(i,u),C(u,e[103].url),h||(y=[x(s,"input",g),x(u,"input",v)],h=!0)},p(t,n){e=t,2&n[0]&&s.value!==e[103].key&&C(s,e[103].key),2&n[0]&&u.value!==e[103].url&&C(u,e[103].url)},d(e){e&&f(t),e&&f(a),e&&f(i),h=!1,r(y)}}}function it(e){let t,n,o,s,a,i,l,c,u,h,y;function g(){e[37].call(s,e[104],e[105])}function v(){e[38].call(u,e[104],e[105])}return{c(){t=m("label"),n=m("b"),n.textContent="API key",o=b(),s=m("input"),a=b(),i=m("label"),l=m("b"),l.textContent="Workspace",c=b(),u=m("input"),$(n,"class","a"),$(s,"type","text"),$(s,"placeholder","API key"),$(s,"class","a"),$(t,"class","over a"),$(l,"class","a"),$(u,"type","text"),$(u,"placeholder","Workspace"),$(u,"class","a"),$(i,"class","over a")},m(r,f){p(r,t,f),d(t,n),d(t,o),d(t,s),C(s,e[103].key),p(r,a,f),p(r,i,f),d(i,l),d(i,c),d(i,u),C(u,e[103].workspace),h||(y=[x(s,"input",g),x(u,"input",v)],h=!0)},p(t,n){e=t,2&n[0]&&s.value!==e[103].key&&C(s,e[103].key),2&n[0]&&u.value!==e[103].workspace&&C(u,e[103].workspace)},d(e){e&&f(t),e&&f(a),e&&f(i),h=!1,r(y)}}}function lt(e){let t,n,o,s,a,i,l,c,u,h,y;function g(){e[35].call(s,e[104],e[105])}function v(){e[36].call(u,e[104],e[105])}return{c(){t=m("label"),n=m("b"),n.textContent="API key",o=b(),s=m("input"),a=b(),i=m("label"),l=m("b"),l.textContent="Base URL",c=b(),u=m("input"),$(n,"class","a"),$(s,"type","text"),$(s,"placeholder","API key"),$(s,"class","a"),$(t,"class","over a"),$(l,"class","a"),$(u,"type","text"),$(u,"placeholder","Base URL"),$(u,"class","a"),$(i,"class","over a")},m(r,f){p(r,t,f),d(t,n),d(t,o),d(t,s),C(s,e[103].key),p(r,a,f),p(r,i,f),d(i,l),d(i,c),d(i,u),C(u,e[103].url),h||(y=[x(s,"input",g),x(u,"input",v)],h=!0)},p(t,n){e=t,2&n[0]&&s.value!==e[103].key&&C(s,e[103].key),2&n[0]&&u.value!==e[103].url&&C(u,e[103].url)},d(e){e&&f(t),e&&f(a),e&&f(i),h=!1,r(y)}}}function ct(e){let t,n,o,s,r,a,i;function l(){e[41].call(s,e[104],e[105])}return{c(){t=m("label"),n=m("b"),n.textContent="Model name",o=b(),s=m("input"),$(n,"class","a"),$(s,"type","text"),$(s,"placeholder","Model name"),$(s,"list",r=e[86].id+"-models"),$(s,"class","a"),$(t,"class","over a")},m(r,c){p(r,t,c),d(t,n),d(t,o),d(t,s),C(s,e[103].model),a||(i=x(s,"input",l),a=!0)},p(t,n){e=t,2&n[0]&&r!==(r=e[86].id+"-models")&&$(s,"list",r),2&n[0]&&s.value!==e[103].model&&C(s,e[103].model)},d(e){e&&f(t),a=!1,i()}}}function ut(e){let t,n,o,s,r,a;function i(){e[42].call(n,e[104],e[105])}return{c(){t=m("label"),n=m("input"),o=b(),s=m("b"),s.textContent="Stream",$(n,"type","checkbox"),$(n,"class","a"),$(s,"class","a"),$(t,"class","side a")},m(l,c){p(l,t,c),d(t,n),n.checked=e[103].stream,d(t,o),d(t,s),r||(a=x(n,"change",i),r=!0)},p(t,o){e=t,2&o[0]&&(n.checked=e[103].stream)},d(e){e&&f(t),r=!1,a()}}}function dt(t){return{c:e,m:e,p:e,d:e}}function pt(e){let n,o,s,a,i,l,c,u,y,g,v,k,P,O,E,S,A,T,M,R,I,D,L,j,U,H,N;function B(){e[33].call(y,e[104],e[105])}let z=xe.providers,q=[];for(let t=0;t<z.length;t+=1)q[t]=nt(tt(e,z,t));function V(){e[34].call(O,e[104],e[105])}let J={ctx:e,current:null,token:null,hasCatch:!1,pending:dt,then:st,catch:ot,value:86};Y(S=xe.getProvider(e[103].typeId),J);const G=[{icon:qe.M6},e[4]];let Z={};for(let e=0;e<G.length;e+=1)Z=t(Z,G[e]);function te(){return e[43](e[105])}R=new he({props:Z});const re=[{icon:Je.FG},e[4]];let ae={};for(let e=0;e<re.length;e+=1)ae=t(ae,re[e]);function ie(){return e[44](e[105])}return L=new he({props:ae}),U=w(e[32][1]),{c(){n=m("div"),o=m("label"),s=m("input"),i=b(),l=m("label"),c=m("b"),c.textContent="Display name",u=b(),y=m("input"),g=b(),v=m("label"),k=m("b"),k.textContent="Provider",P=b(),O=m("select");for(let e=0;e<q.length;e+=1)q[e].c();E=b(),J.block.c(),A=b(),T=m("div"),M=m("button"),ne(R.$$.fragment),I=b(),D=m("button"),ne(L.$$.fragment),$(s,"type","radio"),$(s,"name","selectedEndpoint"),s.__value=a=e[105],s.value=s.__value,$(s,"title","Set endpoint as current"),$(s,"class","a"),$(o,"class","side a"),$(c,"class","a"),$(y,"type","text"),$(y,"placeholder","Display name"),$(y,"class","a"),$(l,"class","over a"),$(k,"class","a"),$(O,"placeholder","Provider"),$(O,"class","a"),void 0===e[103].typeId&&F(V),$(v,"class","over a"),$(M,"type","button"),$(M,"title","Share endpoint link"),$(M,"class","a"),$(D,"type","button"),$(D,"title","Delete endpoint"),$(D,"class","a"),$(T,"class","buttons a"),$(n,"class","endpoint a"),U.p(s)},m(t,r){p(t,n,r),d(n,o),d(o,s),s.checked=s.__value===e[0].selectedEndpointIndex,d(n,i),d(n,l),d(l,c),d(l,u),d(l,y),C(y,e[103].name),d(n,g),d(n,v),d(v,k),d(v,P),d(v,O);for(let e=0;e<q.length;e+=1)q[e]&&q[e].m(O,null);_(O,e[103].typeId,!0),d(n,E),J.block.m(n,J.anchor=null),J.mount=()=>n,J.anchor=A,d(n,A),d(n,T),d(T,M),oe(R,M,null),d(T,I),d(T,D),oe(L,D,null),j=!0,H||(N=[x(s,"change",e[31]),x(y,"input",B),x(O,"change",V),x(M,"click",te),x(D,"click",ie)],H=!0)},p(t,n){if(e=t,3&n[0]&&(s.checked=s.__value===e[0].selectedEndpointIndex),2&n[0]&&y.value!==e[103].name&&C(y,e[103].name),0&n){let t;for(z=xe.providers,t=0;t<z.length;t+=1){const o=tt(e,z,t);q[t]?q[t].p(o,n):(q[t]=nt(o),q[t].c(),q[t].m(O,null))}for(;t<q.length;t+=1)q[t].d(1);q.length=z.length}2&n[0]&&_(O,e[103].typeId),J.ctx=e,2&n[0]&&S!==(S=xe.getProvider(e[103].typeId))&&Y(S,J)||K(J,e,n);const o=16&n[0]?Q(G,[0&n&&{icon:qe.M6},16&n[0]&&ee(e[4])]):{};R.$set(o);const r=16&n[0]?Q(re,[0&n&&{icon:Je.FG},16&n[0]&&ee(e[4])]):{};L.$set(r)},i(e){j||(X(R.$$.fragment,e),X(L.$$.fragment,e),j=!0)},o(e){W(R.$$.fragment,e),W(L.$$.fragment,e),j=!1},d(e){e&&f(n),h(q,e),J.block.d(),J.token=null,J=null,se(R),se(L),U.r(),H=!1,r(N)}}}function ft(t){let n,o,s,r=t[98].displayName+"";return{c(){n=m("option"),o=g(r),n.__value=s=t[98].id,n.value=n.__value,$(n,"class","a")},m(e,t){p(e,n,t),d(n,o)},p:e,d(e){e&&f(n)}}}function ht(t){return{c:e,m:e,p:e,d:e}}function mt(e){let t;function n(e,t){return"cors-anywhere"==e[86].id?gt:""!=e[86].id?yt:void 0}let o=n(e),s=o&&o(e);return{c(){s&&s.c(),t=v()},m(e,n){s&&s.m(e,n),p(e,t,n)},p(e,r){o===(o=n(e))&&s?s.p(e,r):(s&&s.d(1),s=o&&o(e),s&&(s.c(),s.m(t.parentNode,t)))},d(e){s&&s.d(e),e&&f(t)}}}function yt(t){let n;return{c(){n=m("b"),n.textContent="Choose proxy provider",$(n,"class","a")},m(e,t){p(e,n,t)},p:e,d(e){e&&f(n)}}}function gt(e){let t,n,o,s,r,a;function i(){e[48].call(s,e[99],e[100])}return{c(){t=m("label"),n=m("b"),n.textContent="Proxy URL",o=b(),s=m("input"),$(n,"class","a"),$(s,"type","text"),$(s,"placeholder","Proxy URL"),$(s,"class","a"),$(t,"class","over a")},m(l,c){p(l,t,c),d(t,n),d(t,o),d(t,s),C(s,e[98].url),r||(a=x(s,"input",i),r=!0)},p(t,n){e=t,4&n[0]&&s.value!==e[98].url&&C(s,e[98].url)},d(e){e&&f(t),r=!1,a()}}}function bt(t){return{c:e,m:e,p:e,d:e}}function vt(e){let n,o,s,a,i,l,c,u,y,g,v,k,P,O,E,S,A,T,M,R,I,D,L;function j(){e[46].call(u,e[99],e[100])}let U=xe.proxies,H=[];for(let t=0;t<U.length;t+=1)H[t]=ft(Qe(e,U,t));function N(){e[47].call(P,e[99],e[100])}let B={ctx:e,current:null,token:null,hasCatch:!1,pending:bt,then:mt,catch:ht,value:86};Y(E=xe.getProxy(e[98].typeId),B);const z=[{icon:Je.FG},e[4]];let q={};for(let e=0;e<z.length;e+=1)q=t(q,z[e]);function V(){return e[49](e[100])}return M=new he({props:q}),I=w(e[32][0]),{c(){n=m("div"),o=m("input"),a=b(),i=m("label"),l=m("b"),l.textContent="Display name",c=b(),u=m("input"),y=b(),g=m("label"),v=m("b"),v.textContent="Provider",k=b(),P=m("select");for(let e=0;e<H.length;e+=1)H[e].c();O=b(),B.block.c(),S=b(),A=m("div"),T=m("button"),ne(M.$$.fragment),$(o,"type","radio"),$(o,"name","selectedProxy"),o.__value=s=e[100],o.value=o.__value,$(o,"title","Set proxy as current"),$(o,"class","a"),$(l,"class","a"),$(u,"type","text"),$(u,"placeholder","Display name"),$(u,"class","a"),$(i,"class","over a"),$(v,"class","a"),$(P,"placeholder","Provider"),$(P,"class","a"),void 0===e[98].typeId&&F(N),$(g,"class","over a"),$(T,"type","button"),$(T,"title","Delete proxy"),$(T,"class","a"),$(A,"class","buttons a"),$(n,"class","endpoint a"),I.p(o)},m(t,s){p(t,n,s),d(n,o),o.checked=o.__value===e[0].selectedProxyIndex,d(n,a),d(n,i),d(i,l),d(i,c),d(i,u),C(u,e[98].name),d(n,y),d(n,g),d(g,v),d(g,k),d(g,P);for(let e=0;e<H.length;e+=1)H[e]&&H[e].m(P,null);_(P,e[98].typeId,!0),d(n,O),B.block.m(n,B.anchor=null),B.mount=()=>n,B.anchor=S,d(n,S),d(n,A),d(A,T),oe(M,T,null),R=!0,D||(L=[x(o,"change",e[45]),x(u,"input",j),x(P,"change",N),x(T,"click",V)],D=!0)},p(t,n){if(e=t,5&n[0]&&(o.checked=o.__value===e[0].selectedProxyIndex),4&n[0]&&u.value!==e[98].name&&C(u,e[98].name),0&n){let t;for(U=xe.proxies,t=0;t<U.length;t+=1){const o=Qe(e,U,t);H[t]?H[t].p(o,n):(H[t]=ft(o),H[t].c(),H[t].m(P,null))}for(;t<H.length;t+=1)H[t].d(1);H.length=U.length}4&n[0]&&_(P,e[98].typeId),B.ctx=e,4&n[0]&&E!==(E=xe.getProxy(e[98].typeId))&&Y(E,B)||K(B,e,n);const s=16&n[0]?Q(z,[0&n&&{icon:Je.FG},16&n[0]&&ee(e[4])]):{};M.$set(s)},i(e){R||(X(M.$$.fragment,e),R=!0)},o(e){W(M.$$.fragment,e),R=!1},d(e){e&&f(n),h(H,e),B.block.d(),B.token=null,B=null,se(M),I.r(),D=!1,r(L)}}}function xt(e){let n,o,s,a,i,l,u,h,y,g,v,w,k,P,_,O,E,S,A,T,M,R;function I(){e[59].call(o,e[96],e[97])}function D(){e[60].call(a,e[96],e[97])}const L=[{icon:Le.FP},e[4]];let j={};for(let e=0;e<L.length;e+=1)j=t(j,L[e]);function U(){return e[61](e[97])}g=new he({props:j});const F=[{icon:De.r5},e[4]];let H={};for(let e=0;e<F.length;e+=1)H=t(H,F[e]);function N(){return e[62](e[97])}P=new he({props:H});const B=[{icon:Je.FG},e[4]];let z={};for(let e=0;e<B.length;e+=1)z=t(z,B[e]);function q(){return e[63](e[97])}return S=new he({props:z}),{c(){n=m("div"),o=m("input"),s=b(),a=m("textarea"),u=b(),h=m("div"),y=m("button"),ne(g.$$.fragment),w=b(),k=m("button"),ne(P.$$.fragment),O=b(),E=m("button"),ne(S.$$.fragment),A=b(),$(o,"type","text"),$(o,"list","messageRole"),$(o,"placeholder","Role"),$(o,"class","a"),$(a,"placeholder",i="Message #"+e[95].id+" text"),$(a,"autocomplete","false"),$(a,"class","a"),y.disabled=v=e[97]<=0,$(y,"title","Move message up"),$(y,"class","a"),$(k,"type","button"),k.disabled=_=e[97]>=e[3].length-1,$(k,"title","Move message down"),$(k,"class","a"),$(E,"type","button"),$(E,"title","Delete message"),$(E,"class","a"),$(h,"class","buttons a"),$(n,"class","message a")},m(t,r){p(t,n,r),d(n,o),C(o,e[95].role),d(n,s),d(n,a),C(a,e[95].text),d(n,u),d(n,h),d(h,y),oe(g,y,null),d(h,w),d(h,k),oe(P,k,null),d(h,O),d(h,E),oe(S,E,null),d(n,A),T=!0,M||(R=[x(o,"input",I),x(a,"input",D),c(l=At.call(null,a)),x(y,"click",U),x(k,"click",N),x(E,"click",q)],M=!0)},p(t,n){e=t,8&n[0]&&o.value!==e[95].role&&C(o,e[95].role),(!T||8&n[0]&&i!==(i="Message #"+e[95].id+" text"))&&$(a,"placeholder",i),8&n[0]&&C(a,e[95].text);const s=16&n[0]?Q(L,[0&n&&{icon:Le.FP},16&n[0]&&ee(e[4])]):{};g.$set(s);const r=16&n[0]?Q(F,[0&n&&{icon:De.r5},16&n[0]&&ee(e[4])]):{};P.$set(r),(!T||8&n[0]&&_!==(_=e[97]>=e[3].length-1))&&(k.disabled=_);const l=16&n[0]?Q(B,[0&n&&{icon:Je.FG},16&n[0]&&ee(e[4])]):{};S.$set(l)},i(e){T||(X(g.$$.fragment,e),X(P.$$.fragment,e),X(S.$$.fragment,e),T=!0)},o(e){W(g.$$.fragment,e),W(P.$$.fragment,e),W(S.$$.fragment,e),T=!1},d(e){e&&f(n),se(g),se(P),se(S),M=!1,r(R)}}}function $t(e){let t,n,o,s=e[92]+"";return{c(){t=m("option"),n=g(s),t.__value=o=e[92],t.value=t.__value,$(t,"class","a")},m(e,o){p(e,t,o),d(t,n)},p(e,r){512&r[0]&&s!==(s=e[92]+"")&&k(n,s),512&r[0]&&o!==(o=e[92])&&(t.__value=o,t.value=t.__value)},d(e){e&&f(t)}}}function wt(t){let n,o,s,r=t[89]+"";return{c(){n=m("option"),o=g(r),n.__value=s=t[89],n.value=n.__value,$(n,"class","a")},m(e,t){p(e,n,t),d(n,o)},p:e,d(e){e&&f(n)}}}function kt(e){let t,n,o=e[86].models,s=[];for(let t=0;t<o.length;t+=1)s[t]=wt(We(e,o,t));return{c(){t=m("datalist");for(let e=0;e<s.length;e+=1)s[e].c();$(t,"id",n=e[86].id+"-models"),$(t,"class","a")},m(e,n){p(e,t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null)},p(e,n){if(0&n){let r;for(o=e[86].models,r=0;r<o.length;r+=1){const a=We(e,o,r);s[r]?s[r].p(a,n):(s[r]=wt(a),s[r].c(),s[r].m(t,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},d(e){e&&f(t),h(s,e)}}}function Ct(e){let n,o,s,a,i,l,u,y,v,w,O,E,S,A,T,M,R,I,D,L,j,U,H,N,B,z,q,V,Y,K,Z,te,re,ae,ie,le,ce,ue,de,pe,fe,me,ye,ge,be,ve,$e,we,ke,Ce,Pe,_e,Oe,Ee,Se,Ae,Te,Me,Re,Ie,De,Le,qe,Je,We,Qe,tt,nt,ot,st,rt,at,it,lt,ct,ut,dt,ft,ht,mt,yt,gt,bt,wt,Ct,Pt,_t,Ot,Et,Mt,Rt,It,Dt,Lt,jt,Ut,Ft,Ht,Nt,Bt,zt,qt,Vt,Jt,Gt,Xt,Wt,Yt,Kt,Zt,Qt,en,tn,nn,on,sn,rn,an,ln,cn,un,dn,pn,fn,hn,mn,yn,gn,bn,vn,xn,$n,wn,kn,Cn,Pn,_n,On,En,Sn,An,Tn,Mn,Rn,In,Dn,Ln,jn,Un,Fn,Hn,Nn,Bn,zn,qn,Vn,Jn,Gn,Xn;const Wn=[{icon:Be.RL},e[4]];let Yn={};for(let e=0;e<Wn.length;e+=1)Yn=t(Yn,Wn[e]);v=new he({props:Yn});let Kn=e[1],Zn=[];for(let t=0;t<Kn.length;t+=1)Zn[t]=pt(et(e,Kn,t));const Qn=e=>W(Zn[e],1,1,(()=>{Zn[e]=null})),eo=[{icon:Be.RL},e[4]];let to={};for(let e=0;e<eo.length;e+=1)to=t(to,eo[e]);T=new he({props:to});let no=e[2],oo=[];for(let t=0;t<no.length;t+=1)oo[t]=vt(Ze(e,no,t));const so=e=>W(oo[e],1,1,(()=>{oo[e]=null})),ro=[{icon:He.cC},e[10]];let ao={};for(let e=0;e<ro.length;e+=1)ao=t(ao,ro[e]);ke=new he({props:ao});const io=[{icon:He.cC},e[10]];let lo={};for(let e=0;e<io.length;e+=1)lo=t(lo,io[e]);Oe=new he({props:lo});const co=[{icon:Fe.Ed},e[10]];let uo={};for(let e=0;e<co.length;e+=1)uo=t(uo,co[e]);Te=new he({props:uo});const po=[{icon:He.cC},e[10]];let fo={};for(let e=0;e<po.length;e+=1)fo=t(fo,po[e]);Je=new he({props:fo});const ho=[{icon:He.cC},e[10]];let mo={};for(let e=0;e<ho.length;e+=1)mo=t(mo,ho[e]);nt=new he({props:mo});const yo=[{icon:Fe.Ed},e[10]];let go={};for(let e=0;e<yo.length;e+=1)go=t(go,yo[e]);at=new he({props:go});let bo=e[3],vo=[];for(let t=0;t<bo.length;t+=1)vo[t]=xt(Ke(e,bo,t));const xo=e=>W(vo[e],1,1,(()=>{vo[e]=null})),$o=[{icon:Ne.XC},e[4]];let wo={};for(let e=0;e<$o.length;e+=1)wo=t(wo,$o[e]);gn=new he({props:wo});const ko=[{icon:ze.XE},e[4]];let Co={};for(let e=0;e<ko.length;e+=1)Co=t(Co,ko[e]);xn=new he({props:Co});const Po=[{icon:Ve.ct},e[4]];let _o={};for(let e=0;e<Po.length;e+=1)_o=t(_o,Po[e]);Cn=new he({props:_o});const Oo=[{icon:je.gP},e[4]];let Eo={};for(let e=0;e<Oo.length;e+=1)Eo=t(Eo,Oo[e]);En=new he({props:Eo});const So=[{icon:Be.RL},e[4]];let Ao={};for(let e=0;e<So.length;e+=1)Ao=t(Ao,So[e]);Mn=new he({props:Ao});const To=[{icon:Ue.kZ},e[4],{flip:"vertical"}];let Mo={};for(let e=0;e<To.length;e+=1)Mo=t(Mo,To[e]);Dn=new he({props:Mo});let Ro=xe.getProvider(e[9]?.typeId).messageRoles,Io=[];for(let t=0;t<Ro.length;t+=1)Io[t]=$t(Ye(e,Ro,t));let Do=xe.providers.filter(Tt),Lo=[];for(let t=0;t<Do.length;t+=1)Lo[t]=kt(Xe(e,Do,t));return{c(){n=m("div"),o=m("details"),s=m("summary"),s.textContent="Options",a=b(),i=m("div"),l=m("h3"),u=g("API Endpoints "),y=m("button"),ne(v.$$.fragment),w=b();for(let e=0;e<Zn.length;e+=1)Zn[e].c();O=b(),E=m("h3"),S=g("Proxies "),A=m("button"),ne(T.$$.fragment),M=b();for(let e=0;e<oo.length;e+=1)oo[e].c();R=b(),I=m("h3"),I.textContent="Behavior",D=b(),L=m("div"),j=m("div"),U=m("label"),U.textContent="UI Density",H=b(),N=m("select"),B=m("option"),B.textContent="Compact",q=m("option"),q.textContent="Comfortable",Y=m("option"),Y.textContent="Accessible",Z=b(),te=m("div"),re=m("label"),re.textContent="Multi-message count",ae=b(),ie=m("input"),le=b(),ce=m("div"),ue=m("label"),ue.textContent="Retry message count",de=b(),pe=m("input"),fe=b(),me=m("h3"),me.textContent="Backups",ye=b(),ge=m("div"),be=m("div"),ve=m("header"),ve.textContent="Endpoints",$e=b(),we=m("button"),ne(ke.$$.fragment),Ce=g("Load"),Pe=b(),_e=m("button"),ne(Oe.$$.fragment),Ee=g("Append"),Se=b(),Ae=m("button"),ne(Te.$$.fragment),Me=g("Save"),Re=b(),Ie=m("div"),De=m("header"),De.textContent="Messages",Le=b(),qe=m("button"),ne(Je.$$.fragment),We=g("Load"),Qe=b(),tt=m("button"),ne(nt.$$.fragment),ot=g("Append"),st=b(),rt=m("button"),ne(at.$$.fragment),it=g("Save"),lt=b(),ct=m("details"),ut=m("summary"),ut.textContent="Instructions",dt=b(),ft=m("h3"),ft.textContent="Scale API keys",ht=b(),mt=m("p"),mt.textContent="You can use one of the public keys or provide your own. Having your own keys gives more flexibility and better privacy. ",yt=m("ol"),gt=m("li"),gt.innerHTML='Register on <a href="https://spellbook.scale.com/" class="a">Scale Spellbook</a>. ',bt=m("li"),bt.textContent='Create an "app". ',wt=m("li"),Ct=g('Add a "prompt" with '),Pt=m("code"),Pt.textContent="model=GPT-4",_t=g(", "),Ot=m("code"),Ot.textContent="max_tokens=512",Et=g(", "),Mt=m("code"),Mt.textContent="temperature=1",Rt=g(", "),It=m("code"),It.textContent="user_template={{input}}",Dt=g(". "),Lt=m("ul"),jt=m("li"),jt.textContent="Max token limit drastically (non-linearly) affects how fast the website responds. You can try lowering it, especially if you plan to use it for chat, but forget about going above 1024 tokens. ",Ut=m("li"),Ut.textContent="Temperature affects how wild the generations are, where 0.0 generates consistent responses and 2.0 is completely nuts. Default value in OpenAI interface is 0.7. Recommended values are 0.41.0. ",Ft=m("li"),Ht=g("Adjust the template if you plan to use the app for chat or other purposes. GPT-4 model will see the text around "),Nt=m("code"),Nt.textContent="{{input}}",Bt=g(", but the chat app will not."),zt=b(),qt=m("li"),qt.textContent='Add a "deployment" with this "prompt". ',Vt=m("li"),Vt.textContent="Add a new Scale API endpoint in the chat's options and copy API key and URL from Scale website.",Jt=b(),Gt=m("h3"),Gt.textContent="Proxy",Xt=b(),Wt=m("p"),Wt.textContent="The method of bypassing CORS restrictions for the chat script. One is enough. ",Yt=m("ul"),Yt.innerHTML='<li class="a"><b class="a">Direct</b>: <ul class="a"><li class="a"><b class="a">User script</b> <i class="a">(desktop/mobile)</i>: Install <a href="https://athari.github.io/ScaleChat/userscripts/bypasscors.user.js" class="a">Bypass CORS</a> userscript. Install <a href="https://www.tampermonkey.net/" class="a">TamperMonkey</a> extension or any other user script manager first, in case you don&#39;t an option to install the script when you click the link. This method enables bypassing CORS only for specific user script and domain, however running locally is impossible and running on another server requires editing the user script. </li><li class="a"><b class="a">Extension</b> <i class="a">(desktop)</i>: Install <a href="https://microsoftedge.microsoft.com/addons/detail/cors-unblock/hkjklmhkbkdhlgnnfbbcihcajofmjgbh" class="a">CORS Unblock</a> extension. Click on the extension&#39;s button to enable it. This method allows to choose what websites bypass CORS and when. It allows running the script locally or on any server. </li><li class="a"><b class="a">Command Line</b> <i class="a">(desktop)</i>: Close all Chrome windows, then run it with <b class="a"><code class="a">chrome --no-web-security</code></b> command line. This method applies to all websites until you restart Chrome.</li></ul>  </li><li class="a"><b class="a">CORS demo</b> <i class="a">(desktop/mobile)</i>: Go to <a href="https://cors-anywhere.herokuapp.com/corsdemo" class="a">CORS Anywhere Demo</a> page and click on the button to enable it. You may be asked to solve CAPTCHA. Note that CORS Demo can timeout way earlier than actual API. This method allows all websites using that specific website to bypass CORS. </li><li class="a"><b class="a">Web proxy</b> <i class="a">(desktop/mobile)</i>: Use <a href="https://fishtailprotocol.com/projects/betterGPT4/" class="a">Web proxy by Feril</a>. No configuration required. This method works exclusively with Scale API.</li>',Kt=b(),Zt=m("h3"),Zt.textContent="Privacy",Qt=b(),en=m("p"),en.textContent="Privacy does not exist. ",tn=m("ul"),tn.innerHTML='<li class="a">All your prompts and responses are visible to the owner of the Scale API key. </li><li class="a">All your prompts, responses and keys are visible to the company that owns Scale API. </li><li class="a">All your prompts, responses and keys are visible to the owner of CORS and web proxies.</li>',nn=b(),on=m("p"),on.textContent="Recommendations for maximum privacy: ",sn=m("ul"),sn.innerHTML='<li class="a">Do not use public Scale API keys. <lI class="a">Do not use proxies owned by people you don&#39;t trust. <li class="a">Do not send any information which could be used to identify you. </li><li class="a">Do register on Scale with fake data, including fake email. </li><li class="a">Do live in countries where FBI can&#39;t reach you and put in jail for having bad thoughts.</li></lI></li>',rn=b(),an=m("div");for(let e=0;e<vo.length;e+=1)vo[e].c();ln=b(),cn=m("div"),un=m("input"),dn=b(),pn=m("textarea"),hn=b(),mn=m("div"),yn=m("button"),ne(gn.$$.fragment),bn=b(),vn=m("button"),ne(xn.$$.fragment),wn=b(),kn=m("button"),ne(Cn.$$.fragment),_n=b(),On=m("button"),ne(En.$$.fragment),An=b(),Tn=m("button"),ne(Mn.$$.fragment),Rn=b(),In=m("button"),ne(Dn.$$.fragment),Ln=b(),jn=m("div"),Un=m("p"),Fn=g(e[8]),Hn=b(),Nn=m("p"),Bn=g(e[7]),zn=b(),qn=m("datalist");for(let e=0;e<Io.length;e+=1)Io[e].c();Vn=b();for(let e=0;e<Lo.length;e+=1)Lo[e].c();$(s,"class","a"),$(y,"title","Add endpoint"),$(y,"class","a"),$(l,"class","a"),$(A,"title","Add proxy"),$(A,"class","a"),$(E,"class","a"),$(I,"class","a"),$(U,"for","density"),$(U,"class","a"),B.__value=z="compact",B.value=B.__value,$(B,"class","a"),q.__value=V="mobile",q.value=q.__value,$(q,"class","a"),Y.__value=K="access",Y.value=Y.__value,$(Y,"class","a"),$(N,"id","density"),$(N,"class","a"),void 0===e[0].density&&F((()=>e[50].call(N))),$(j,"class","option a"),$(re,"for","multiMessageCount"),$(re,"class","a"),$(ie,"type","text"),$(ie,"id","multiMessageCount"),$(ie,"class","a"),$(te,"class","option a"),$(ue,"for","retryMessageCount"),$(ue,"class","a"),$(pe,"type","text"),$(pe,"id","retryMessageCount"),$(pe,"class","a"),$(ce,"class","option a"),$(L,"class","options a"),$(me,"class","a"),$(ve,"class","a"),$(we,"type","button"),$(we,"class","a"),$(_e,"type","button"),$(_e,"class","a"),$(Ae,"type","button"),$(Ae,"class","a"),$(be,"class","option-long a"),$(De,"class","a"),$(qe,"type","button"),$(qe,"class","a"),$(tt,"type","button"),$(tt,"class","a"),$(rt,"type","button"),$(rt,"class","a"),$(Ie,"class","option-long a"),$(ge,"class","options a"),$(i,"class","endpoints a"),$(ut,"class","a"),$(ft,"class","a"),$(mt,"class","a"),$(gt,"class","a"),$(bt,"class","a"),$(Pt,"class","a"),$(Ot,"class","a"),$(Mt,"class","a"),$(It,"class","a"),$(jt,"class","a"),$(Ut,"class","a"),$(Nt,"class","a"),$(Ft,"class","a"),$(Lt,"class","a"),$(wt,"class","a"),$(qt,"class","a"),$(Vt,"class","a"),$(yt,"class","a"),$(Gt,"class","a"),$(Wt,"class","a"),$(Yt,"class","a"),$(Zt,"class","a"),$(en,"class","a"),$(tn,"class","a"),$(on,"class","a"),$(sn,"class","a"),$(ct,"class","a"),o.open=!0,$(o,"class","a"),$(an,"class","messages a"),$(un,"type","text"),un.disabled=e[6],$(un,"list","messageRole"),$(un,"placeholder","New message role"),$(un,"class","a"),pn.disabled=e[6],$(pn,"placeholder","New message text"),$(pn,"autocomplete","false"),$(pn,"class","a"),$(yn,"type","button"),yn.disabled=e[6],$(yn,"title","Send message"),$(yn,"class","a"),$(vn,"type","button"),vn.disabled=e[6],$(vn,"title",$n="Send message and receive "+e[0].multiMessageCount+" messages"),$(vn,"class","a"),$(kn,"type","button"),kn.disabled=e[6],$(kn,"title",Pn="Try sending message "+e[0].retryMessageCount+" times"),$(kn,"class","a"),$(On,"type","button"),On.disabled=Sn=!e[6],$(On,"title","Cancel sending"),$(On,"class","a"),$(Tn,"type","button"),Tn.disabled=e[6],$(Tn,"title","Add message without sending"),$(Tn,"class","a"),$(In,"type","button"),$(In,"title","Copy all messages to clipboard"),$(In,"class","a"),$(mn,"class","buttons a"),$(cn,"class","message new-message a"),$(Un,"class","message a"),$(Nn,"class","time a"),P(Nn,"display",e[6]?"block":"none"),$(jn,"class","status a"),$(qn,"id","messageRole"),$(qn,"class","a"),$(n,"class","app a")},m(t,r){p(t,n,r),d(n,o),d(o,s),d(o,a),d(o,i),d(i,l),d(l,u),d(l,y),oe(v,y,null),d(i,w);for(let e=0;e<Zn.length;e+=1)Zn[e]&&Zn[e].m(i,null);d(i,O),d(i,E),d(E,S),d(E,A),oe(T,A,null),d(i,M);for(let e=0;e<oo.length;e+=1)oo[e]&&oo[e].m(i,null);d(i,R),d(i,I),d(i,D),d(i,L),d(L,j),d(j,U),d(j,H),d(j,N),d(N,B),d(N,q),d(N,Y),_(N,e[0].density,!0),d(L,Z),d(L,te),d(te,re),d(te,ae),d(te,ie),C(ie,e[0].multiMessageCount),d(L,le),d(L,ce),d(ce,ue),d(ce,de),d(ce,pe),C(pe,e[0].retryMessageCount),d(i,fe),d(i,me),d(i,ye),d(i,ge),d(ge,be),d(be,ve),d(be,$e),d(be,we),oe(ke,we,null),d(we,Ce),d(be,Pe),d(be,_e),oe(Oe,_e,null),d(_e,Ee),d(be,Se),d(be,Ae),oe(Te,Ae,null),d(Ae,Me),d(ge,Re),d(ge,Ie),d(Ie,De),d(Ie,Le),d(Ie,qe),oe(Je,qe,null),d(qe,We),d(Ie,Qe),d(Ie,tt),oe(nt,tt,null),d(tt,ot),d(Ie,st),d(Ie,rt),oe(at,rt,null),d(rt,it),d(o,lt),d(o,ct),d(ct,ut),d(ct,dt),d(ct,ft),d(ct,ht),d(ct,mt),d(ct,yt),d(yt,gt),d(yt,bt),d(yt,wt),d(wt,Ct),d(wt,Pt),d(wt,_t),d(wt,Ot),d(wt,Et),d(wt,Mt),d(wt,Rt),d(wt,It),d(wt,Dt),d(wt,Lt),d(Lt,jt),d(Lt,Ut),d(Lt,Ft),d(Ft,Ht),d(Ft,Nt),d(Ft,Bt),d(wt,zt),d(yt,qt),d(yt,Vt),d(ct,Jt),d(ct,Gt),d(ct,Xt),d(ct,Wt),d(ct,Yt),d(ct,Kt),d(ct,Zt),d(ct,Qt),d(ct,en),d(ct,tn),d(ct,nn),d(ct,on),d(ct,sn),d(n,rn),d(n,an);for(let e=0;e<vo.length;e+=1)vo[e]&&vo[e].m(an,null);d(n,ln),d(n,cn),d(cn,un),C(un,e[5].role),d(cn,dn),d(cn,pn),C(pn,e[5].text),d(cn,hn),d(cn,mn),d(mn,yn),oe(gn,yn,null),d(mn,bn),d(mn,vn),oe(xn,vn,null),d(mn,wn),d(mn,kn),oe(Cn,kn,null),d(mn,_n),d(mn,On),oe(En,On,null),d(mn,An),d(mn,Tn),oe(Mn,Tn,null),d(mn,Rn),d(mn,In),oe(Dn,In,null),d(n,Ln),d(n,jn),d(jn,Un),d(Un,Fn),d(jn,Hn),d(jn,Nn),d(Nn,Bn),d(n,zn),d(n,qn);for(let e=0;e<Io.length;e+=1)Io[e]&&Io[e].m(qn,null);d(n,Vn);for(let e=0;e<Lo.length;e+=1)Lo[e]&&Lo[e].m(n,null);Jn=!0,Gn||(Xn=[x(Ge,"resize",St),x(y,"click",e[23]),x(A,"click",e[26]),x(N,"change",e[50]),x(ie,"input",e[51]),x(pe,"input",e[52]),x(we,"click",e[53]),x(_e,"click",e[54]),x(Ae,"click",e[55]),x(qe,"click",e[56]),x(tt,"click",e[57]),x(rt,"click",e[58]),x(un,"input",e[64]),x(pn,"input",e[65]),c(fn=At.call(null,pn)),x(yn,"click",e[66]),x(vn,"click",e[67]),x(kn,"click",e[68]),x(On,"click",e[18]),x(Tn,"click",e[69]),x(In,"click",e[22])],Gn=!0)},p(e,t){const o=16&t[0]?Q(Wn,[0&t&&{icon:Be.RL},16&t[0]&&ee(e[4])]):{};if(v.$set(o),50331667&t[0]){let n;for(Kn=e[1],n=0;n<Kn.length;n+=1){const o=et(e,Kn,n);Zn[n]?(Zn[n].p(o,t),X(Zn[n],1)):(Zn[n]=pt(o),Zn[n].c(),X(Zn[n],1),Zn[n].m(i,O))}for(J(),n=Kn.length;n<Zn.length;n+=1)Qn(n);G()}const s=16&t[0]?Q(eo,[0&t&&{icon:Be.RL},16&t[0]&&ee(e[4])]):{};if(T.$set(s),134217749&t[0]){let n;for(no=e[2],n=0;n<no.length;n+=1){const o=Ze(e,no,n);oo[n]?(oo[n].p(o,t),X(oo[n],1)):(oo[n]=vt(o),oo[n].c(),X(oo[n],1),oo[n].m(i,R))}for(J(),n=no.length;n<oo.length;n+=1)so(n);G()}1&t[0]&&_(N,e[0].density),1&t[0]&&ie.value!==e[0].multiMessageCount&&C(ie,e[0].multiMessageCount),1&t[0]&&pe.value!==e[0].retryMessageCount&&C(pe,e[0].retryMessageCount);const r=1024&t[0]?Q(ro,[0&t&&{icon:He.cC},1024&t[0]&&ee(e[10])]):{};ke.$set(r);const a=1024&t[0]?Q(io,[0&t&&{icon:He.cC},1024&t[0]&&ee(e[10])]):{};Oe.$set(a);const l=1024&t[0]?Q(co,[0&t&&{icon:Fe.Ed},1024&t[0]&&ee(e[10])]):{};Te.$set(l);const c=1024&t[0]?Q(po,[0&t&&{icon:He.cC},1024&t[0]&&ee(e[10])]):{};Je.$set(c);const u=1024&t[0]?Q(ho,[0&t&&{icon:He.cC},1024&t[0]&&ee(e[10])]):{};nt.$set(u);const d=1024&t[0]?Q(yo,[0&t&&{icon:Fe.Ed},1024&t[0]&&ee(e[10])]):{};if(at.$set(d),3145752&t[0]){let n;for(bo=e[3],n=0;n<bo.length;n+=1){const o=Ke(e,bo,n);vo[n]?(vo[n].p(o,t),X(vo[n],1)):(vo[n]=xt(o),vo[n].c(),X(vo[n],1),vo[n].m(an,null))}for(J(),n=bo.length;n<vo.length;n+=1)xo(n);G()}(!Jn||64&t[0])&&(un.disabled=e[6]),32&t[0]&&un.value!==e[5].role&&C(un,e[5].role),(!Jn||64&t[0])&&(pn.disabled=e[6]),32&t[0]&&C(pn,e[5].text);const p=16&t[0]?Q($o,[0&t&&{icon:Ne.XC},16&t[0]&&ee(e[4])]):{};gn.$set(p),(!Jn||64&t[0])&&(yn.disabled=e[6]);const f=16&t[0]?Q(ko,[0&t&&{icon:ze.XE},16&t[0]&&ee(e[4])]):{};xn.$set(f),(!Jn||64&t[0])&&(vn.disabled=e[6]),(!Jn||1&t[0]&&$n!==($n="Send message and receive "+e[0].multiMessageCount+" messages"))&&$(vn,"title",$n);const h=16&t[0]?Q(Po,[0&t&&{icon:Ve.ct},16&t[0]&&ee(e[4])]):{};Cn.$set(h),(!Jn||64&t[0])&&(kn.disabled=e[6]),(!Jn||1&t[0]&&Pn!==(Pn="Try sending message "+e[0].retryMessageCount+" times"))&&$(kn,"title",Pn);const m=16&t[0]?Q(Oo,[0&t&&{icon:je.gP},16&t[0]&&ee(e[4])]):{};En.$set(m),(!Jn||64&t[0]&&Sn!==(Sn=!e[6]))&&(On.disabled=Sn);const y=16&t[0]?Q(So,[0&t&&{icon:Be.RL},16&t[0]&&ee(e[4])]):{};Mn.$set(y),(!Jn||64&t[0])&&(Tn.disabled=e[6]);const g=16&t[0]?Q(To,[0&t&&{icon:Ue.kZ},16&t[0]&&ee(e[4]),To[2]]):{};if(Dn.$set(g),(!Jn||256&t[0])&&k(Fn,e[8]),(!Jn||128&t[0])&&k(Bn,e[7]),64&t[0]&&P(Nn,"display",e[6]?"block":"none"),512&t[0]){let n;for(Ro=xe.getProvider(e[9]?.typeId).messageRoles,n=0;n<Ro.length;n+=1){const o=Ye(e,Ro,n);Io[n]?Io[n].p(o,t):(Io[n]=$t(o),Io[n].c(),Io[n].m(qn,null))}for(;n<Io.length;n+=1)Io[n].d(1);Io.length=Ro.length}if(0&t){let o;for(Do=xe.providers.filter(Tt),o=0;o<Do.length;o+=1){const s=Xe(e,Do,o);Lo[o]?Lo[o].p(s,t):(Lo[o]=kt(s),Lo[o].c(),Lo[o].m(n,null))}for(;o<Lo.length;o+=1)Lo[o].d(1);Lo.length=Do.length}},i(e){if(!Jn){X(v.$$.fragment,e);for(let e=0;e<Kn.length;e+=1)X(Zn[e]);X(T.$$.fragment,e);for(let e=0;e<no.length;e+=1)X(oo[e]);X(ke.$$.fragment,e),X(Oe.$$.fragment,e),X(Te.$$.fragment,e),X(Je.$$.fragment,e),X(nt.$$.fragment,e),X(at.$$.fragment,e);for(let e=0;e<bo.length;e+=1)X(vo[e]);X(gn.$$.fragment,e),X(xn.$$.fragment,e),X(Cn.$$.fragment,e),X(En.$$.fragment,e),X(Mn.$$.fragment,e),X(Dn.$$.fragment,e),Jn=!0}},o(e){W(v.$$.fragment,e),Zn=Zn.filter(Boolean);for(let e=0;e<Zn.length;e+=1)W(Zn[e]);W(T.$$.fragment,e),oo=oo.filter(Boolean);for(let e=0;e<oo.length;e+=1)W(oo[e]);W(ke.$$.fragment,e),W(Oe.$$.fragment,e),W(Te.$$.fragment,e),W(Je.$$.fragment,e),W(nt.$$.fragment,e),W(at.$$.fragment,e),vo=vo.filter(Boolean);for(let e=0;e<vo.length;e+=1)W(vo[e]);W(gn.$$.fragment,e),W(xn.$$.fragment,e),W(Cn.$$.fragment,e),W(En.$$.fragment,e),W(Mn.$$.fragment,e),W(Dn.$$.fragment,e),Jn=!1},d(e){e&&f(n),se(v),h(Zn,e),se(T),h(oo,e),se(ke),se(Oe),se(Te),se(Je),se(nt),se(at),h(vo,e),se(gn),se(xn),se(Cn),se(En),se(Mn),se(Dn),h(Io,e),h(Lo,e),Gn=!1,r(Xn)}}}const Pt=20;function _t(e){Et({target:e.target.closest(".message").querySelector("textarea")})}function Ot({target:e}){const t=window.pageYOffset;e.style.height="0",e.style.overflow="hidden",e.style.height=`${Math.max(e.scrollHeight,Pt)+2}px`,e.style.overflow="",window.scrollTo(window.pageXOffset,t)}function Et({target:e}){Ot({target:e}),setTimeout((()=>{Ot({target:e})}),50)}function St(){for(const e of document.querySelectorAll("textarea"))Ot({target:e})}function At(e){return Et({target:e}),e.addEventListener("input",Ot),{destroy:()=>e.removeEventListener("input",Ot)}}const Tt=e=>e.models.length>0;function Mt(e,t,n){xe.init();let o={selectedEndpointIndex:0,selectedProxyIndex:0,multiMessageCount:10,retryMessageCount:5,density:"compact"},s=[xe.createDefaultProviderConfig()],r=[xe.createDefaultProxyConfig()],a=[{id:1,role:"user",text:"Hello GPT-4!"}],i={id:0,role:"user",text:""},l=!1,c=null,u="",d=0,p="Welcome!",f=null,h=!1,m=null,y=null,g=null,b={scale:1.3},v=Object.assign({},b);const x={compact:1.3,mobile:1.7,access:2.1},$=new Intl.NumberFormat("en-gb",{style:"unit",unit:"second",unitDisplay:"short",maximumFractionDigits:0}),w=new Intl.NumberFormat("en-gb",{style:"unit",unit:"millisecond",unitDisplay:"short",maximumFractionDigits:2});var k;function C(e,...t){console.log(e,...t),n(8,p=e)}function P(){E("Endpoints",s)}function _(){E("Messages",a)}function E(e,t){!function(e,t,n){const o=new Blob([n],{type:e}),s=window.document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}("application/json",`NotAIChat ${e} ${(new Date).toISOString().substring(0,19).replace("T"," ").replaceAll(":","-")}.json`,JSON.stringify(t,null," "))}async function S(e){const t=await be(".json, application/json");t instanceof Array&&"string"==typeof t[0].typeId&&n(1,s=e?[...s,...t]:t)}async function A(e){const t=await be(".json, application/json");t instanceof Array&&"string"==typeof t[0].text&&n(3,a=e?[...a,...t]:t)}function M(){const e=Math.max(...a.map((e=>e.id)));return Number.isFinite(e)?e+1:1}async function R(e,t,o){C("Sending message"),j({target:e.target}),n(6,l=!0);const s=xe.createConnection(m,y);if(null==s)return void C("No endpoint selected");f=new AbortController;const r=a.slice(-1)[0];let i,u=""==r?.text?r:null;const p={get signal(){return f.signal},get extraText(){return`${i} in ${w.format(performance.now()-c)}`},get messages(){return a}};Object.assign(s,{onMessage(e){"done"!=e.mode&&(null==u?(u={id:M(),text:e.text,role:e.role},n(3,a=[...a,u])):(u.text+=e.text,n(3,a=[...a]),_t({target:[...document.querySelectorAll(".messages textarea")].slice(-1)[0]}))),"complete"==e.mode||"done"==e.mode?C(`Received message${p.extraText}`,e):e.mode,C(`Receiving message${p.extraText}`,e)},onLogMessage(e){e.data?C(e.text,...e.data):C(e.text)},onError(e){C(e.text,e.error)}});for(let e=0;e<t;e++){i=t>1?` (${e+1}/${t})`:"",n(28,[c,d]=[performance.now(),0],d);try{await s.sendRequest(p)}catch(e){if(e instanceof DOMException&&"AbortError"==e.name)return void C(`User cancelled message${p.extraText}`,e);C(`Unexpected error${p.extraText}: ${e.message} (Console and Network tabs in DevTools may contain extra details)`,e);continue}if(f.signal.aborted||o&&null!=u)break}n(6,l=!1)}async function I(e){return await R(e,1,!1)}async function D(e){return await R(e,+o.retryMessageCount,!0)}async function L(e){return await R(e,+o.multiMessageCount,!1)}function j(e){""!=i.text&&(n(3,a=[...a,{id:M(),text:i.text,role:i.role}]),n(5,i.text="",i),_t(e))}function U(e){n(3,a=a.filter(((t,n)=>n!==e)))}function F(e,t){void 0!==a[e]&&void 0!==a[t]&&(n(3,[a[e],a[t]]=[a[t],a[e]],a),n(3,a=[...a]))}async function H(e){const t=s[e],n=new URLSearchParams({name:t.name,provider:t.provider,key:t.key,url:t.url}),o=`${location.origin}${location.pathname}?${n}`;try{await navigator.clipboard.writeText(o),C(`Endpoint share link copied to clipboard: ${o}`)}catch(e){C(`Failed to copy endpoint share link to clipboard: ${e.message}`,e)}}function N(e){n(1,s=s.filter(((t,n)=>n!==e))),void 0===s[o.selectedEndpointIndex]&&n(0,o.selectedEndpointIndex=null,o)}function B(e){n(2,r=r.filter(((t,n)=>n!==e))),void 0===r[o.selectedProxyIndex]&&n(0,o.selectedProxyIndex=null,o)}k=()=>{n(3,a=ye("messages",a)),n(1,s=ye("endpoints",s)),n(2,r=ye("proxies",r)),n(0,o=ye("options",o));try{const e=function(e){const t={name:e.get("name")??"Shared endpoint",provider:e.get("provider"),key:e.get("key"),url:e.get("url")},o=s.findIndex((e=>e.key==t.key));if(-1!=o)return o;if(null==t.key)return null;const r=xe.createDefaultProviderConfig().key;return n(1,s=[...s.filter((e=>e.key!=r)),t]),s.length-1}(new URLSearchParams(location.search));null!==e&&n(0,o.selectedEndpointIndex=e,o),"about:"==location.protocol&&(document.querySelector("head style").innerHTML="")}catch(e){console.log(e)}n(29,h=!0),n(30,g=document.documentElement),setInterval((()=>{l&&n(28,d++,d)}),1e3)},T().$$.on_mount.push(k);return e.$$.update=()=>{var t;536870927&e.$$.dirty[0]&&h&&(ge("messages",a),ge("endpoints",s),ge("proxies",r),ge("options",o)),1073741825&e.$$.dirty[0]&&null!==g&&(t=o,n(30,g.className=`d-${t.density}`,g)),1&e.$$.dirty[0]&&null!==o.density&&St(),1&e.$$.dirty[0]&&n(4,b={scale:x[o.density]}),16&e.$$.dirty[0]&&n(10,v=Object.assign({},b,{style:"margin: 0 calc(var(--gap) * 1.5) 0 calc(var(--gap) * 0.5)"})),268435456&e.$$.dirty[0]&&n(7,u=$.format((performance.now()-c)/1e3)),3&e.$$.dirty[0]&&n(9,m=s[o.selectedEndpointIndex]),3&e.$$.dirty[0]&&(y=s[o.selectedProxyIndex])},[o,s,r,a,b,i,l,u,p,m,v,P,_,S,A,I,D,L,function(){null!=f&&(n(6,l=!1),f.abort(),C("Receiving message cancelled"))},j,U,F,async function(){try{await navigator.clipboard.writeText(a.map((e=>e.text)).join("\n")),C("Messages copied to clipboard")}catch(e){C(`Failed to copy messages to clipboard: ${e.message}`,e)}},function(){n(1,s=[...s,xe.createDefaultProviderConfig()])},H,N,function(){n(2,r=[...r,xe.createDefaultProxyConfig()])},B,d,h,g,function(){o.selectedEndpointIndex=this.__value,n(0,o)},[[],[]],function(e,t){e[t].name=this.value,n(1,s)},function(e,t){e[t].typeId=O(this),n(1,s)},function(e,t){e[t].key=this.value,n(1,s)},function(e,t){e[t].url=this.value,n(1,s)},function(e,t){e[t].key=this.value,n(1,s)},function(e,t){e[t].workspace=this.value,n(1,s)},function(e,t){e[t].key=this.value,n(1,s)},function(e,t){e[t].url=this.value,n(1,s)},function(e,t){e[t].model=this.value,n(1,s)},function(e,t){e[t].stream=this.checked,n(1,s)},e=>H(e),e=>N(e),function(){o.selectedProxyIndex=this.__value,n(0,o)},function(e,t){e[t].name=this.value,n(2,r)},function(e,t){e[t].typeId=O(this),n(2,r)},function(e,t){e[t].url=this.value,n(2,r)},e=>B(e),function(){o.density=O(this),n(0,o)},function(){o.multiMessageCount=this.value,n(0,o)},function(){o.retryMessageCount=this.value,n(0,o)},()=>S(!1),()=>S(!0),()=>P(),()=>A(!1),()=>A(!0),()=>_(),function(e,t){e[t].role=this.value,n(3,a)},function(e,t){e[t].text=this.value,n(3,a)},e=>F(e,e-1),e=>F(e,e+1),e=>U(e),function(){i.role=this.value,n(5,i)},function(){i.text=this.value,n(5,i)},e=>I(e),e=>L(e),e=>D(e),e=>j(e)]}new class extends ae{constructor(e){super(),re(this,e,Mt,Ct,i,{},null,[-1,-1,-1,-1])}}({target:document.querySelector("#root")})})()})();</script></body></html>