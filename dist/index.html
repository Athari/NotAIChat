<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NotAIChat</title><style>:root{--button-width:38px;--gap:8px;color-scheme:dark;overflow-wrap:break-word;font:15px/1.2 Segoe UI, sans-serif}:root .a.a,:root .a.a::before,:root .a.a::after{box-sizing:border-box}.app.a.a{border:solid 1px #666;background:#111;padding:8px;border-radius:8px}details.a.a{border:solid 1px #666;background:#222;padding:8px;margin:0 0 8px 0;border-radius:8px}details.a>details.a{margin:8px 0 0 0}details.a>summary.a{cursor:pointer}details[open].a>summary.a{padding:0 0 8px 0;font-weight:700}h3.a.a{font:inherit;font-weight:500;font-size:1.2em;margin:2px 0}header.a.a{font:inherit;font-weight:400;margin:0}.messages.a.a,.endpoints.a.a,.options.a.a{display:flex;flex-flow:column;gap:8px}.options.a.a{flex-flow:row wrap;gap:8px 24px}.message.a.a,.endpoint.a.a,.option.a.a,.buttons.a.a{display:flex;flex-flow:row;align-items:stretch;gap:8px}.message.a.a{align-items:flex-start}.message.a input[type=text][list].a{flex:0 0 120px}.endpoint.a.a{flex-flow:row wrap}.option.a.a{width:400px}.option.a label.a{flex:1}.option-long.a.a{display:flex;flex-flow:row wrap;gap:8px;align-items:center}.option-long.a button.a{width:auto;padding:0 12px}.a:is(.endpoint) .buttons.a{padding:calc(1lh + 4px) 0 0 0}.new-message.a.a{margin:12px 0 0 0}.new-message.a .buttons.a{flex:0 0 calc((var(--button-width) + var(--gap) + 0px) * 3 - var(--gap));flex-flow:row wrap}label.over.a.a{display:flex;flex-flow:column;flex:1 250px}label.over.a b.a{margin:0 0 4px 0;font-weight:inherit}label.side.a.a{display:flex;flex-flow:row;align-items:center;flex:0;gap:8px;padding:calc(1lh + 4px) 0 0 0}label.side.a b.a{font-weight:inherit}label.side.a input.a:is([type=checkbox], [type=radio]){width:20px;min-height:20px;padding:0;margin:0}textarea.a.a,input[type=text].a.a,select.a.a{flex:1;border-style:solid;border-width:1px;border-radius:4px;padding:2px 6px;font:inherit;resize:none;overflow:hidden}input[type=radio].a.a{align-self:stretch}textarea.a.a:hover{overflow-y:overlay}.status.a.a{display:flex;flex-flow:row;opacity:0.6}.status.a .message.a{flex:1}.status.a .time.a{white-space:nowrap}button.a.a{height:26px;width:var(--button-width);font-size:1em}p.a.a,ul.a.a{margin:4px 0}@media(max-width: 740px){:root.d-compact .buttons.a.a{flex-flow:column}:root.d-compact .endpoint.a.a{flex-flow:row wrap}:root.d-compact .endpoint.a input[type=text].a{flex:200px 1}}@media(max-width: 480px){:root.d-compact .option.a.a{width:100%}}:root:is(.d-mobile, .d-access){--button-width:48px;line-height:1.4}:root:is(.d-mobile, .d-access) button.a.a{height:32px}:root:is(.d-mobile, .d-access) textarea.a.a,:root:is(.d-mobile, .d-access) input[type=text].a.a,:root:is(.d-mobile, .d-access) select.a.a{padding:4px 8px}:root:is(.d-mobile, .d-access) p.a.a,:root:is(.d-mobile, .d-access) ul.a.a{margin:10px 0}:root:is(.d-mobile, .d-access) li.a.a{margin:6px 0}@media(max-width: 840px){:root:is(.d-mobile, .d-access) .buttons.a.a{flex-flow:column}:root:is(.d-mobile, .d-access) .endpoint.a.a{flex-flow:row wrap}:root:is(.d-mobile, .d-access) .endpoint.a input[type=text].a{flex:260px 1}:root:is(.d-mobile, .d-access) .new-message.a .buttons.a{flex:0 0 var(--button-width)}}@media(max-width: 500px){:root:is(.d-mobile, .d-access) .option.a.a{width:100%}}:root.d-access{--button-width:52px;font-size:17px;line-height:1.6}:root.d-access button.a.a{height:38px}</style></head><body><div id="root"></div><script>(()=>{"use strict";var e={362:(e,t)=>{var n;n={value:true};var s="far";var r="copy";var i=512;var o=512;var a=[];var l="f0c5";var c="M224 0c-35.3 0-64 28.7-64 64V288c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H224zM64 160c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H288c35.3 0 64-28.7 64-64V384H304v64c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V224c0-8.8 7.2-16 16-16h64V160H64z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.kZ=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},338:(e,t)=>{var n;n={value:true};var s="far";var r="floppy-disk";var i=448;var o=512;var a=[128190,128426,"save"];var l="f0c7";var c="M48 96V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V170.5c0-4.2-1.7-8.3-4.7-11.3l33.9-33.9c12 12 18.7 28.3 18.7 45.3V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H309.5c17 0 33.3 6.7 45.3 18.7l74.5 74.5-33.9 33.9L320.8 84.7c-.3-.3-.5-.5-.8-.8V184c0 13.3-10.7 24-24 24H104c-13.3 0-24-10.7-24-24V80H64c-8.8 0-16 7.2-16 16zm80-16v80H272V80H128zm32 240a64 64 0 1 1 128 0 64 64 0 1 1 -128 0z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.Ed=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},199:(e,t)=>{var n;n={value:true};var s="far";var r="folder-open";var i=576;var o=512;var a=[128194,128449,61717];var l="f07c";var c="M384 480h48c11.4 0 21.9-6 27.6-15.9l112-192c5.8-9.9 5.8-22.1 .1-32.1S555.5 224 544 224H144c-11.4 0-21.9 6-27.6 15.9L48 357.1V96c0-8.8 7.2-16 16-16H181.5c4.2 0 8.3 1.7 11.3 4.7l26.5 26.5c21 21 49.5 32.8 79.2 32.8H416c8.8 0 16 7.2 16 16v32h48V160c0-35.3-28.7-64-64-64H298.5c-17 0-33.3-6.7-45.3-18.7L226.7 50.7c-12-12-28.3-18.7-45.3-18.7H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H87.7 384z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.cC=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},494:(e,t)=>{var n;n={value:true};var s="far";var r="rocket-launch";var i=512;var o=512;var a=[128640];var l="e027";var c="M197.9 253.9c12.9 6.4 24.7 14.8 35 25.2s18.8 22.2 25.2 35c105.8-30 156.7-79.5 181.5-126c25-46.8 27.3-97.6 22-137.7c-40.1-5.3-90.9-3-137.7 22c-46.5 24.8-96 75.8-126 181.5zM384 312.1v82.2c0 25.4-13.4 49-35.3 61.9l-88.5 52.5c-7.4 4.4-16.6 4.5-24.1 .2s-12.1-12.2-12.1-20.9l0-114.7c0-22.6-9-44.3-25-60.3s-37.7-25-60.3-25H24c-8.6 0-16.6-4.6-20.9-12.1s-4.2-16.7 .2-24.1l52.5-88.5c13-21.9 36.5-35.3 61.9-35.3h82.2C281.7-3.8 408.8-8.5 483.9 5.3c11.6 2.1 20.7 11.2 22.8 22.8c13.8 75.1 9.1 202.2-122.7 284zM28.3 511.9c-16 .4-28.6-12.2-28.2-28.2C1 446 7.7 379.7 42 345.5c34.4-34.4 90.1-34.4 124.5 0s34.4 90.1 0 124.5C132.3 504.3 66 511 28.3 511.9zm50.2-64.5c12.8-.7 31.2-3.7 41.3-13.7c11.4-11.4 11.4-30 0-41.4s-30-11.4-41.4 0c-10.1 10.1-13 28.5-13.7 41.3c-.5 8 5.9 14.3 13.9 13.9zM328 144a40 40 0 1 1 80 0 40 40 0 1 1 -80 0z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.XE=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},55:(e,t)=>{var n;n={value:true};var s="far";var r="share-nodes";var i=448;var o=512;var a=["share-alt"];var l="f1e0";var c="M448 128C448 181 405 224 352 224C323.1 224 297.2 211.2 279.6 191L189.9 235.9C191.3 242.4 191.1 249.1 191.1 255.1C191.1 262.9 191.3 269.6 189.9 276.1L279.6 320.1C297.2 300.8 323.1 287.1 352 287.1C405 287.1 448 330.1 448 384C448 437 405 480 352 480C298.1 480 256 437 256 384C256 377.1 256.7 370.4 258.1 363.9L168.4 319C150.8 339.2 124.9 352 96 352C42.98 352 0 309 0 255.1C0 202.1 42.98 159.1 96 159.1C124.9 159.1 150.8 172.8 168.4 192.1L258.1 148.1C256.7 141.6 256 134.9 256 128C256 74.98 298.1 32 352 32C405 32 448 74.98 448 128H448zM95.1 304C122.5 304 143.1 282.5 143.1 256C143.1 229.5 122.5 208 95.1 208C69.49 208 47.1 229.5 47.1 256C47.1 282.5 69.49 304 95.1 304zM352 80C325.5 80 304 101.5 304 128C304 154.5 325.5 176 352 176C378.5 176 400 154.5 400 128C400 101.5 378.5 80 352 80zM352 432C378.5 432 400 410.5 400 384C400 357.5 378.5 336 352 336C325.5 336 304 357.5 304 384C304 410.5 325.5 432 352 432z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.M6=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},221:(e,t)=>{var n;n={value:true};var s="far";var r="turtle";var i=576;var o=512;var a=[128034];var l="f726";var c="M336 240V208c0-70.7-57.3-128-128-128S80 137.3 80 208v32H336zm48-32v41.2c0 21.4-17.4 38.8-38.8 38.8H70.8C49.4 288 32 270.6 32 249.2V208c0-97.2 78.8-176 176-176s176 78.8 176 176zm96 80c-8.3 0-16.3-1.6-23.6-4.5C440.3 328 400.4 361 352 367v1 72c0 22.1-17.9 40-40 40H264c-22.1 0-40-17.9-40-40V368H192v72c0 22.1-17.9 40-40 40H104c-22.1 0-40-17.9-40-40V368H24c-13.3 0-24-10.7-24-24s10.7-24 24-24H64h48 32 48 32 48 32 32c44.2 0 80-35.8 80-80V224 192 176c0-35.3 28.7-64 64-64c53 0 96 43 96 96v16c0 35.3-28.7 64-64 64H480zM272 368v64h32V368H272zm-160 0v64h32V368H112zM496 224a16 16 0 1 0 0-32 16 16 0 1 0 0 32z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.ct=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},282:(e,t)=>{var n;n={value:true};var s="fas";var r="arrow-down";var i=384;var o=512;var a=[8595];var l="f063";var c="M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.r5=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},634:(e,t)=>{var n;n={value:true};var s="fas";var r="arrow-up";var i=384;var o=512;var a=[8593];var l="f062";var c="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2V448c0 17.7 14.3 32 32 32s32-14.3 32-32V141.2L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.FP=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},232:(e,t)=>{var n;n={value:true};var s="fas";var r="ban";var i=512;var o=512;var a=[128683,"cancel"];var l="f05e";var c="M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.gP=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},742:(e,t)=>{var n;n={value:true};var s="fas";var r="paper-plane";var i=512;var o=512;var a=[61913];var l="f1d8";var c="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480V396.4c0-4 1.5-7.8 4.2-10.7L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.XC=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},505:(e,t)=>{var n;n={value:true};var s="fas";var r="plus-large";var i=512;var o=512;var a=[];var l="e59e";var c="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 192H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H224V480c0 17.7 14.3 32 32 32s32-14.3 32-32V288l192 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-192 0 0-192z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.RL=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a},948:(e,t)=>{var n;n={value:true};var s="fas";var r="xmark-large";var i=448;var o=512;var a=[];var l="e59b";var c="M393.4 41.4c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3L269.3 256 438.6 425.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 301.3 54.6 470.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L178.7 256 9.4 86.6C-3.1 74.1-3.1 53.9 9.4 41.4s32.8-12.5 45.3 0L224 210.7 393.4 41.4z";t.DF={prefix:s,iconName:r,icon:[i,o,a,l,c]};t.FG=t.DF;n=s;n=r;n=i;n=o;n=a;n=l;n=c;n=a}};var t={};function n(s){var r=t[s];if(r!==undefined){return r.exports}var i=t[s]={exports:{}};e[s](i,i.exports,n);return i.exports}(()=>{n.d=(e,t)=>{for(var s in t){if(n.o(t,s)&&!n.o(e,s)){Object.defineProperty(e,s,{enumerable:true,get:t[s]})}}}})();(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})();(()=>{n.r=e=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})}})();var s={};(()=>{var e={};n.r(e);n.d(e,{APIConnectionError:()=>mr,APIConnectionTimeoutError:()=>gr,APIError:()=>hr,APIUserAbortError:()=>pr,AnthropicError:()=>dr,AuthenticationError:()=>wr,BadRequestError:()=>yr,ConflictError:()=>xr,InternalServerError:()=>kr,NotFoundError:()=>vr,PermissionDeniedError:()=>br,RateLimitError:()=>$r,UnprocessableEntityError:()=>_r});var t={};n.r(t);n.d(t,{APIConnectionError:()=>Jo,APIConnectionTimeoutError:()=>Ko,APIError:()=>zo,APIUserAbortError:()=>Vo,AuthenticationError:()=>Qo,BadRequestError:()=>Go,ConflictError:()=>ea,InternalServerError:()=>sa,NotFoundError:()=>Zo,OpenAIError:()=>Xo,PermissionDeniedError:()=>Yo,RateLimitError:()=>na,UnprocessableEntityError:()=>ta});function s(){}const r=e=>e;function i(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return!!e&&(typeof e==="object"||typeof e==="function")&&typeof e.then==="function"}function a(e,t,n,s,r){e.__svelte_meta={loc:{file:t,line:n,column:s,char:r}}}function l(e){return e()}function c(){return Object.create(null)}function u(e){e.forEach(l)}function f(e){return typeof e==="function"}function d(e,t){return e!=e?t==t:e!==t||(e&&typeof e==="object"||typeof e==="function")}let h;function p(e,t){if(!h){h=document.createElement("a")}h.href=t;return e===h.href}function m(e,t){return e!=e?t==t:e!==t}function g(e){return Object.keys(e).length===0}function y(e,t){if(e!=null&&typeof e.subscribe!=="function"){throw new Error(`'${t}' is not a store with a 'subscribe' method`)}}function w(e,...t){if(e==null){return s}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function b(e){let t;w(e,(e=>t=e))();return t}function v(e,t,n){e.$$.on_destroy.push(w(t,n))}function x(e,t,n,s){if(e){const r=_(e,t,n,s);return e[0](r)}}function _(e,t,n,s){return e[1]&&s?i(n.ctx.slice(),e[1](s(t))):n.ctx}function $(e,t,n,s){if(e[2]&&s){const r=e[2](s(n));if(t.dirty===undefined){return r}if(typeof r==="object"){const e=[];const n=Math.max(t.dirty.length,r.length);for(let s=0;s<n;s+=1){e[s]=t.dirty[s]|r[s]}return e}return t.dirty|r}return t.dirty}function k(e,t,n,s,r,i){if(r){const o=_(t,n,s,i);e.p(o,r)}}function E(e,t,n,s,r,i,o){const a=$(t,s,r,i);k(e,t,n,s,a,o)}function C(e){if(e.ctx.length>32){const t=[];const n=e.ctx.length/32;for(let e=0;e<n;e++){t[e]=-1}return t}return-1}function S(e){const t={};for(const n in e)if(n[0]!=="$")t[n]=e[n];return t}function P(e,t){const n={};t=new Set(t);for(const s in e)if(!t.has(s)&&s[0]!=="$")n[s]=e[s];return n}function A(e){const t={};for(const n in e){t[n]=true}return t}function R(e){let t=false;return function(...n){if(t)return;t=true;e.call(this,...n)}}function F(e){return e==null?"":e}function I(e,t,n){e.set(n);return t}const M=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function O(e){return e&&f(e.destroy)?e.destroy:s}function T(e){const t=typeof e==="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}const L=null&&["",true,1,"true","contenteditable"];const N=typeof window!=="undefined";let j=null&&(N?()=>window.performance.now():()=>Date.now());let D=null&&(N?e=>requestAnimationFrame(e):s);function q(e){j=e}function U(e){D=e}const B=new Set;function H(e){B.forEach((t=>{if(!t.c(e)){B.delete(t);t.f()}}));if(B.size!==0)D(H)}function W(){B.clear()}function X(e){let t;if(B.size===0)D(H);return{promise:new Promise((n=>{B.add(t={c:e,f:n})})),abort(){B.delete(t)}}}const z=typeof window!=="undefined"?window:typeof globalThis!=="undefined"?globalThis:global;class V{constructor(e){this.options=e;this._listeners="WeakMap"in z?new WeakMap:undefined}observe(e,t){this._listeners.set(e,t);this._getObserver().observe(e,this.options);return()=>{this._listeners.delete(e);this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!==null&&e!==void 0?e:this._observer=new ResizeObserver((e=>{var t;for(const n of e){V.entries.set(n.target,n);(t=this._listeners.get(n.target))===null||t===void 0?void 0:t(n)}}))}}V.entries="WeakMap"in z?new WeakMap:undefined;let J=false;function K(){J=true}function G(){J=false}function Q(e,t,n,s){while(e<t){const r=e+(t-e>>1);if(n(r)<=s){e=r+1}else{t=r}}return e}function Y(e){if(e.hydrate_init)return;e.hydrate_init=true;let t=e.childNodes;if(e.nodeName==="HEAD"){const e=[];for(let n=0;n<t.length;n++){const s=t[n];if(s.claim_order!==undefined){e.push(s)}}t=e}const n=new Int32Array(t.length+1);const s=new Int32Array(t.length);n[0]=-1;let r=0;for(let e=0;e<t.length;e++){const i=t[e].claim_order;const o=(r>0&&t[n[r]].claim_order<=i?r+1:Q(1,r,(e=>t[n[e]].claim_order),i))-1;s[e]=n[o]+1;const a=o+1;n[a]=e;r=Math.max(a,r)}const i=[];const o=[];let a=t.length-1;for(let e=n[r]+1;e!=0;e=s[e-1]){i.push(t[e-1]);for(;a>=e;a--){o.push(t[a])}a--}for(;a>=0;a--){o.push(t[a])}i.reverse();o.sort(((e,t)=>e.claim_order-t.claim_order));for(let t=0,n=0;t<o.length;t++){while(n<i.length&&o[t].claim_order>=i[n].claim_order){n++}const s=n<i.length?i[n]:null;e.insertBefore(o[t],s)}}function Z(e,t){e.appendChild(t)}function ee(e,t,n){const s=te(e);if(!s.getElementById(t)){const e=ce("style");e.id=t;e.textContent=n;se(s,e)}}function te(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;if(t&&t.host){return t}return e.ownerDocument}function ne(e){const t=ce("style");se(te(e),t);return t.sheet}function se(e,t){Z(e.head||e,t);return t.sheet}function re(e,t){if(J){Y(e);if(e.actual_end_child===undefined||e.actual_end_child!==null&&e.actual_end_child.parentNode!==e){e.actual_end_child=e.firstChild}while(e.actual_end_child!==null&&e.actual_end_child.claim_order===undefined){e.actual_end_child=e.actual_end_child.nextSibling}if(t!==e.actual_end_child){if(t.claim_order!==undefined||t.parentNode!==e){e.insertBefore(t,e.actual_end_child)}}else{e.actual_end_child=t.nextSibling}}else if(t.parentNode!==e||t.nextSibling!==null){e.appendChild(t)}}function ie(e,t,n){e.insertBefore(t,n||null)}function oe(e,t,n){if(J&&!n){re(e,t)}else if(t.parentNode!==e||t.nextSibling!=n){e.insertBefore(t,n||null)}}function ae(e){if(e.parentNode){e.parentNode.removeChild(e)}}function le(e,t){for(let n=0;n<e.length;n+=1){if(e[n])e[n].d(t)}}function ce(e){return document.createElement(e)}function ue(e,t){return document.createElement(e,{is:t})}function fe(e,t){const n={};for(const s in e){if(M(e,s)&&t.indexOf(s)===-1){n[s]=e[s]}}return n}function de(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function he(e){return document.createTextNode(e)}function pe(){return he(" ")}function me(){return he("")}function ge(e){return document.createComment(e)}function ye(e,t,n,s){e.addEventListener(t,n,s);return()=>e.removeEventListener(t,n,s)}function we(e){return function(t){t.preventDefault();return e.call(this,t)}}function be(e){return function(t){t.stopPropagation();return e.call(this,t)}}function ve(e){return function(t){t.stopImmediatePropagation();return e.call(this,t)}}function xe(e){return function(t){if(t.target===this)e.call(this,t)}}function _e(e){return function(t){if(t.isTrusted)e.call(this,t)}}function $e(e,t,n){if(n==null)e.removeAttribute(t);else if(e.getAttribute(t)!==n)e.setAttribute(t,n)}const ke=null&&["width","height"];function Ee(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const s in t){if(t[s]==null){e.removeAttribute(s)}else if(s==="style"){e.style.cssText=t[s]}else if(s==="__value"){e.value=e[s]=t[s]}else if(n[s]&&n[s].set&&ke.indexOf(s)===-1){e[s]=t[s]}else{$e(e,s,t[s])}}}function Ce(e,t){for(const n in t){$e(e,n,t[n])}}function Se(e,t){Object.keys(t).forEach((n=>{Pe(e,n,t[n])}))}function Pe(e,t,n){if(t in e){e[t]=typeof e[t]==="boolean"&&n===""?true:n}else{$e(e,t,n)}}function Ae(e){return/-/.test(e)?Se:Ee}function Re(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function Fe(e,t,n){const s=new Set;for(let t=0;t<e.length;t+=1){if(e[t].checked)s.add(e[t].__value)}if(!n){s.delete(t)}return Array.from(s)}function Ie(e){let t;return{p(...n){t=n;t.forEach((t=>e.push(t)))},r(){t.forEach((t=>e.splice(e.indexOf(t),1)))}}}function Me(e,t){let n=r(e);let s;function r(e){for(let n=0;n<t.length;n++){e=e[t[n]]=e[t[n]]||[]}return e}function i(){s.forEach((e=>n.push(e)))}function o(){s.forEach((e=>n.splice(n.indexOf(e),1)))}return{u(s){t=s;const a=r(e);if(a!==n){o();n=a;i()}},p(...e){s=e;i()},r:o}}function Oe(e){return e===""?null:+e}function Te(e){const t=[];for(let n=0;n<e.length;n+=1){t.push({start:e.start(n),end:e.end(n)})}return t}function Le(e){return Array.from(e.childNodes)}function Ne(e){if(e.claim_info===undefined){e.claim_info={last_index:0,total_claimed:0}}}function je(e,t,n,s,r=false){Ne(e);const i=(()=>{for(let s=e.claim_info.last_index;s<e.length;s++){const i=e[s];if(t(i)){const t=n(i);if(t===undefined){e.splice(s,1)}else{e[s]=t}if(!r){e.claim_info.last_index=s}return i}}for(let s=e.claim_info.last_index-1;s>=0;s--){const i=e[s];if(t(i)){const t=n(i);if(t===undefined){e.splice(s,1)}else{e[s]=t}if(!r){e.claim_info.last_index=s}else if(t===undefined){e.claim_info.last_index--}return i}}return s()})();i.claim_order=e.claim_info.total_claimed;e.claim_info.total_claimed+=1;return i}function De(e,t,n,s){return je(e,(e=>e.nodeName===t),(e=>{const t=[];for(let s=0;s<e.attributes.length;s++){const r=e.attributes[s];if(!n[r.name]){t.push(r.name)}}t.forEach((t=>e.removeAttribute(t)));return undefined}),(()=>s(t)))}function qe(e,t,n){return De(e,t,n,ce)}function Ue(e,t,n){return De(e,t,n,de)}function Be(e,t){return je(e,(e=>e.nodeType===3),(e=>{const n=""+t;if(e.data.startsWith(n)){if(e.data.length!==n.length){return e.splitText(n.length)}}else{e.data=n}}),(()=>he(t)),true)}function He(e){return Be(e," ")}function We(e,t){return je(e,(e=>e.nodeType===8),(e=>{e.data=""+t;return undefined}),(()=>ge(t)),true)}function Xe(e,t,n){for(let s=n;s<e.length;s+=1){const n=e[s];if(n.nodeType===8&&n.textContent.trim()===t){return s}}return e.length}function ze(e,t){const n=Xe(e,"HTML_TAG_START",0);const s=Xe(e,"HTML_TAG_END",n);if(n===s){return new pt(undefined,t)}Ne(e);const r=e.splice(n,s-n+1);ae(r[0]);ae(r[r.length-1]);const i=r.slice(1,r.length-1);for(const t of i){t.claim_order=e.claim_info.total_claimed;e.claim_info.total_claimed+=1}return new pt(i,t)}function Ve(e,t){t=""+t;if(e.data===t)return;e.data=t}function Je(e,t){t=""+t;if(e.wholeText===t)return;e.data=t}function Ke(e,t,n){if(~L.indexOf(n)){Je(e,t)}else{Ve(e,t)}}function Ge(e,t){e.value=t==null?"":t}function Qe(e,t){try{e.type=t}catch(e){}}function Ye(e,t,n,s){if(n==null){e.style.removeProperty(t)}else{e.style.setProperty(t,n,s?"important":"")}}function Ze(e,t,n){for(let n=0;n<e.options.length;n+=1){const s=e.options[n];if(s.__value===t){s.selected=true;return}}if(!n||t!==undefined){e.selectedIndex=-1}}function et(e,t){for(let n=0;n<e.options.length;n+=1){const s=e.options[n];s.selected=~t.indexOf(s.__value)}}function tt(e){const t=e.querySelector(":checked");return t&&t.__value}function nt(e){return[].map.call(e.querySelectorAll(":checked"),(e=>e.__value))}let st;function rt(){if(st===undefined){st=false;try{if(typeof window!=="undefined"&&window.parent){void window.parent.document}}catch(e){st=true}}return st}function it(e,t){const n=getComputedStyle(e);if(n.position==="static"){e.style.position="relative"}const s=ce("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; "+"overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;");s.setAttribute("aria-hidden","true");s.tabIndex=-1;const r=rt();let i;if(r){s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>";i=ye(window,"message",(e=>{if(e.source===s.contentWindow)t()}))}else{s.src="about:blank";s.onload=()=>{i=ye(s.contentWindow,"resize",t);t()}}Z(e,s);return()=>{if(r){i()}else if(i&&s.contentWindow){i()}ae(s)}}const ot=new V({box:"content-box"});const at=new V({box:"border-box"});const lt=new V({box:"device-pixel-content-box"});function ct(e,t,n){e.classList[n?"add":"remove"](t)}function ut(e,t,{bubbles:n=false,cancelable:s=false}={}){const r=document.createEvent("CustomEvent");r.initCustomEvent(e,n,s,t);return r}function ft(e,t=document.body){return Array.from(t.querySelectorAll(e))}function dt(e,t){const n=[];let s=0;for(const r of t.childNodes){if(r.nodeType===8){const t=r.textContent.trim();if(t===`HEAD_${e}_END`){s-=1;n.push(r)}else if(t===`HEAD_${e}_START`){s+=1;n.push(r)}}else if(s>0){n.push(r)}}return n}class ht{constructor(e=false){this.is_svg=false;this.is_svg=e;this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){if(!this.e){if(this.is_svg)this.e=de(t.nodeName);else this.e=ce(t.nodeType===11?"TEMPLATE":t.nodeName);this.t=t.tagName!=="TEMPLATE"?t:t.content;this.c(e)}this.i(n)}h(e){this.e.innerHTML=e;this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1){ie(this.t,this.n[t],e)}}p(e){this.d();this.h(e);this.i(this.a)}d(){this.n.forEach(ae)}}class pt extends(null&&ht){constructor(e,t=false){super(t);this.e=this.n=null;this.l=e}c(e){if(this.l){this.n=this.l}else{super.c(e)}}i(e){for(let t=0;t<this.n.length;t+=1){oe(this.t,this.n[t],e)}}}function mt(e){const t={};for(const n of e){t[n.name]=n.value}return t}function gt(e){const t={};e.childNodes.forEach((e=>{t[e.slot||"default"]=true}));return t}function yt(e,t){return new e(t)}const wt=new Map;let bt=0;function vt(e){let t=5381;let n=e.length;while(n--)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function xt(e,t){const n={stylesheet:ne(t),rules:{}};wt.set(e,n);return n}function _t(e,t,n,s,r,i,o,a=0){const l=16.666/s;let c="{\n";for(let e=0;e<=1;e+=l){const s=t+(n-t)*i(e);c+=e*100+`%{${o(s,1-s)}}\n`}const u=c+`100% {${o(n,1-n)}}\n}`;const f=`__svelte_${vt(u)}_${a}`;const d=te(e);const{stylesheet:h,rules:p}=wt.get(d)||xt(d,e);if(!p[f]){p[f]=true;h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length)}const m=e.style.animation||"";e.style.animation=`${m?`${m}, `:""}${f} ${s}ms linear ${r}ms 1 both`;bt+=1;return f}function $t(e,t){const n=(e.style.animation||"").split(", ");const s=n.filter(t?e=>e.indexOf(t)<0:e=>e.indexOf("__svelte")===-1);const r=n.length-s.length;if(r){e.style.animation=s.join(", ");bt-=r;if(!bt)kt()}}function kt(){D((()=>{if(bt)return;wt.forEach((e=>{const{ownerNode:t}=e.stylesheet;if(t)ae(t)}));wt.clear()}))}function Et(e,t,n,i){if(!t)return s;const o=e.getBoundingClientRect();if(t.left===o.left&&t.right===o.right&&t.top===o.top&&t.bottom===o.bottom)return s;const{delay:a=0,duration:l=300,easing:c=r,start:u=j()+a,end:f=u+l,tick:d=s,css:h}=n(e,{from:t,to:o},i);let p=true;let m=false;let g;function y(){if(h){g=_t(e,0,1,l,a,c,h)}if(!a){m=true}}function w(){if(h)$t(e,g);p=false}X((e=>{if(!m&&e>=u){m=true}if(m&&e>=f){d(1,0);w()}if(!p){return false}if(m){const t=e-u;const n=0+1*c(t/l);d(n,1-n)}return true}));y();d(0,1);return w}function Ct(e){const t=getComputedStyle(e);if(t.position!=="absolute"&&t.position!=="fixed"){const{width:n,height:s}=t;const r=e.getBoundingClientRect();e.style.position="absolute";e.style.width=n;e.style.height=s;St(e,r)}}function St(e,t){const n=e.getBoundingClientRect();if(t.left!==n.left||t.top!==n.top){const s=getComputedStyle(e);const r=s.transform==="none"?"":s.transform;e.style.transform=`${r} translate(${t.left-n.left}px, ${t.top-n.top}px)`}}let Pt;function At(e){Pt=e}function Rt(){if(!Pt)throw new Error("Function called outside component initialization");return Pt}function Ft(e){Rt().$$.before_update.push(e)}function It(e){Rt().$$.on_mount.push(e)}function Mt(e){Rt().$$.after_update.push(e)}function Ot(e){Rt().$$.on_destroy.push(e)}function Tt(){const e=Rt();return(t,n,{cancelable:s=false}={})=>{const r=e.$$.callbacks[t];if(r){const i=ut(t,n,{cancelable:s});r.slice().forEach((t=>{t.call(e,i)}));return!i.defaultPrevented}return true}}function Lt(e,t){Rt().$$.context.set(e,t);return t}function Nt(e){return Rt().$$.context.get(e)}function jt(){return Rt().$$.context}function Dt(e){return Rt().$$.context.has(e)}function qt(e,t){const n=e.$$.callbacks[t.type];if(n){n.slice().forEach((e=>e.call(this,t)))}}const Ut=[];const Bt={enabled:false};const Ht=[];let Wt=[];const Xt=[];const zt=Promise.resolve();let Vt=false;function Jt(){if(!Vt){Vt=true;zt.then(en)}}function Kt(){Jt();return zt}function Gt(e){Wt.push(e)}function Qt(e){Xt.push(e)}const Yt=new Set;let Zt=0;function en(){if(Zt!==0){return}const e=Pt;do{try{while(Zt<Ut.length){const e=Ut[Zt];Zt++;At(e);tn(e.$$)}}catch(e){Ut.length=0;Zt=0;throw e}At(null);Ut.length=0;Zt=0;while(Ht.length)Ht.pop()();for(let e=0;e<Wt.length;e+=1){const t=Wt[e];if(!Yt.has(t)){Yt.add(t);t()}}Wt.length=0}while(Ut.length);while(Xt.length){Xt.pop()()}Vt=false;Yt.clear();At(e)}function tn(e){if(e.fragment!==null){e.update();u(e.before_update);const t=e.dirty;e.dirty=[-1];e.fragment&&e.fragment.p(e.ctx,t);e.after_update.forEach(Gt)}}function nn(e){const t=[];const n=[];Wt.forEach((s=>e.indexOf(s)===-1?t.push(s):n.push(s)));n.forEach((e=>e()));Wt=t}let sn;function rn(){if(!sn){sn=Promise.resolve();sn.then((()=>{sn=null}))}return sn}function on(e,t,n){e.dispatchEvent(ut(`${t?"intro":"outro"}${n}`))}const an=new Set;let ln;function cn(){ln={r:0,c:[],p:ln}}function un(){if(!ln.r){u(ln.c)}ln=ln.p}function fn(e,t){if(e&&e.i){an.delete(e);e.i(t)}}function dn(e,t,n,s){if(e&&e.o){if(an.has(e))return;an.add(e);ln.c.push((()=>{an.delete(e);if(s){if(n)e.d(1);s()}}));e.o(t)}else if(s){s()}}const hn={duration:0};function pn(e,t,n){const i={direction:"in"};let o=t(e,n,i);let a=false;let l;let c;let u=0;function d(){if(l)$t(e,l)}function h(){const{delay:t=0,duration:n=300,easing:i=r,tick:f=s,css:h}=o||hn;if(h)l=_t(e,0,1,n,t,i,h,u++);f(0,1);const p=j()+t;const m=p+n;if(c)c.abort();a=true;Gt((()=>on(e,true,"start")));c=X((t=>{if(a){if(t>=m){f(1,0);on(e,true,"end");d();return a=false}if(t>=p){const e=i((t-p)/n);f(e,1-e)}}return a}))}let p=false;return{start(){if(p)return;p=true;$t(e);if(f(o)){o=o(i);rn().then(h)}else{h()}},invalidate(){p=false},end(){if(a){d();a=false}}}}function mn(e,t,n){const i={direction:"out"};let o=t(e,n,i);let a=true;let l;const c=ln;c.r+=1;function d(){const{delay:t=0,duration:n=300,easing:i=r,tick:f=s,css:d}=o||hn;if(d)l=_t(e,1,0,n,t,i,d);const h=j()+t;const p=h+n;Gt((()=>on(e,false,"start")));X((t=>{if(a){if(t>=p){f(0,1);on(e,false,"end");if(!--c.r){u(c.c)}return false}if(t>=h){const e=i((t-h)/n);f(1-e,e)}}return a}))}if(f(o)){rn().then((()=>{o=o(i);d()}))}else{d()}return{end(t){if(t&&o.tick){o.tick(1,0)}if(a){if(l)$t(e,l);a=false}}}}function gn(e,t,n,i){const o={direction:"both"};let a=t(e,n,o);let l=i?0:1;let c=null;let d=null;let h=null;function p(){if(h)$t(e,h)}function m(e,t){const n=e.b-l;t*=Math.abs(n);return{a:l,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(t){const{delay:n=0,duration:i=300,easing:o=r,tick:f=s,css:g}=a||hn;const y={start:j()+n,b:t};if(!t){y.group=ln;ln.r+=1}if(c||d){d=y}else{if(g){p();h=_t(e,l,t,i,n,o,g)}if(t)f(0,1);c=m(y,i);Gt((()=>on(e,t,"start")));X((t=>{if(d&&t>d.start){c=m(d,i);d=null;on(e,c.b,"start");if(g){p();h=_t(e,l,c.b,c.duration,0,o,a.css)}}if(c){if(t>=c.end){f(l=c.b,1-l);on(e,c.b,"end");if(!d){if(c.b){p()}else{if(!--c.group.r)u(c.group.c)}}c=null}else if(t>=c.start){const e=t-c.start;l=c.a+c.d*o(e/c.duration);f(l,1-l)}}return!!(c||d)}))}}return{run(e){if(f(a)){rn().then((()=>{a=a(o);g(e)}))}else{g(e)}},end(){p();c=d=null}}}function yn(e,t){const n=t.token={};function s(e,s,r,i){if(t.token!==n)return;t.resolved=i;let o=t.ctx;if(r!==undefined){o=o.slice();o[r]=i}const a=e&&(t.current=e)(o);let l=false;if(t.block){if(t.blocks){t.blocks.forEach(((e,n)=>{if(n!==s&&e){cn();dn(e,1,1,(()=>{if(t.blocks[n]===e){t.blocks[n]=null}}));un()}}))}else{t.block.d(1)}a.c();fn(a,1);a.m(t.mount(),t.anchor);l=true}t.block=a;if(t.blocks)t.blocks[s]=a;if(l){en()}}if(o(e)){const n=Rt();e.then((e=>{At(n);s(t.then,1,t.value,e);At(null)}),(e=>{At(n);s(t.catch,2,t.error,e);At(null);if(!t.hasCatch){throw e}}));if(t.current!==t.pending){s(t.pending,0);return true}}else{if(t.current!==t.then){s(t.then,1,t.value,e);return true}t.resolved=e}}function wn(e,t,n){const s=t.slice();const{resolved:r}=e;if(e.current===e.then){s[e.value]=r}if(e.current===e.catch){s[e.error]=r}e.block.p(s,n)}function bn(e,t){e.d(1);t.delete(e.key)}function vn(e,t){dn(e,1,1,(()=>{t.delete(e.key)}))}function xn(e,t){e.f();bn(e,t)}function _n(e,t){e.f();vn(e,t)}function $n(e,t,n,s,r,i,o,a,l,c,f,d){let h=e.length;let p=i.length;let m=h;const g={};while(m--)g[e[m].key]=m;const y=[];const w=new Map;const b=new Map;const v=[];m=p;while(m--){const e=d(r,i,m);const a=n(e);let l=o.get(a);if(!l){l=c(a,e);l.c()}else if(s){v.push((()=>l.p(e,t)))}w.set(a,y[m]=l);if(a in g)b.set(a,Math.abs(m-g[a]))}const x=new Set;const _=new Set;function $(e){fn(e,1);e.m(a,f);o.set(e.key,e);f=e.first;p--}while(h&&p){const t=y[p-1];const n=e[h-1];const s=t.key;const r=n.key;if(t===n){f=t.first;h--;p--}else if(!w.has(r)){l(n,o);h--}else if(!o.has(s)||x.has(s)){$(t)}else if(_.has(r)){h--}else if(b.get(s)>b.get(r)){_.add(s);$(t)}else{x.add(r);h--}}while(h--){const t=e[h];if(!w.has(t.key))l(t,o)}while(p)$(y[p-1]);u(v);return y}function kn(e,t,n,s){const r=new Set;for(let i=0;i<t.length;i++){const o=s(n(e,t,i));if(r.has(o)){throw new Error("Cannot have duplicate keys in a keyed each")}r.add(o)}}function En(e,t){const n={};const s={};const r={$$scope:1};let i=e.length;while(i--){const o=e[i];const a=t[i];if(a){for(const e in o){if(!(e in a))s[e]=1}for(const e in a){if(!r[e]){n[e]=a[e];r[e]=1}}e[i]=a}else{for(const e in o){r[e]=1}}}for(const e in s){if(!(e in n))n[e]=undefined}return n}function Cn(e){return typeof e==="object"&&e!==null?e:{}}const Sn=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"];const Pn=new Set([...Sn]);const An=/^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;function Rn(e){return An.test(e)||e.toLowerCase()==="!doctype"}const Fn=/[\s'">/=\u{FDD0}-\u{FDEF}\u{FFFE}\u{FFFF}\u{1FFFE}\u{1FFFF}\u{2FFFE}\u{2FFFF}\u{3FFFE}\u{3FFFF}\u{4FFFE}\u{4FFFF}\u{5FFFE}\u{5FFFF}\u{6FFFE}\u{6FFFF}\u{7FFFE}\u{7FFFF}\u{8FFFE}\u{8FFFF}\u{9FFFE}\u{9FFFF}\u{AFFFE}\u{AFFFF}\u{BFFFE}\u{BFFFF}\u{CFFFE}\u{CFFFF}\u{DFFFE}\u{DFFFF}\u{EFFFE}\u{EFFFF}\u{FFFFE}\u{FFFFF}\u{10FFFE}\u{10FFFF}]/u;function In(e,t){const n=Object.assign({},...e);if(t){const e=t.classes;const s=t.styles;if(e){if(n.class==null){n.class=e}else{n.class+=" "+e}}if(s){if(n.style==null){n.style=Vn(s)}else{n.style=Vn(Mn(n.style,s))}}}let s="";Object.keys(n).forEach((e=>{if(Fn.test(e))return;const t=n[e];if(t===true)s+=" "+e;else if(Pn.has(e.toLowerCase())){if(t)s+=" "+e}else if(t!=null){s+=` ${e}="${t}"`}}));return s}function Mn(e,t){const n={};for(const t of e.split(";")){const e=t.indexOf(":");const s=t.slice(0,e).trim();const r=t.slice(e+1).trim();if(!s)continue;n[s]=r}for(const e in t){const s=t[e];if(s){n[e]=s}else{delete n[e]}}return n}const On=/[&"]/g;const Tn=/[&<]/g;function Ln(e,t=false){const n=String(e);const s=t?On:Tn;s.lastIndex=0;let r="";let i=0;while(s.test(n)){const e=s.lastIndex-1;const t=n[e];r+=n.substring(i,e)+(t==="&"?"&amp;":t==='"'?"&quot;":"&lt;");i=e+1}return r+n.substring(i)}function Nn(e){const t=typeof e==="string"||e&&typeof e==="object";return t?Ln(e,true):e}function jn(e){const t={};for(const n in e){t[n]=Nn(e[n])}return t}function Dn(e,t){let n="";for(let s=0;s<e.length;s+=1){n+=t(e[s],s)}return n}const qn={$$render:()=>""};function Un(e,t){if(!e||!e.$$render){if(t==="svelte:component")t+=" this={...}";throw new Error(`<${t}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${t}>.`)}return e}function Bn(e,t,n,s){console.log(`{@debug} ${e?e+" ":""}(${t}:${n})`);console.log(s);return""}let Hn;function Wn(e){function t(t,n,s,r,i){const o=Pt;const a={on_destroy:Hn,context:new Map(i||(o?o.$$.context:[])),on_mount:[],before_update:[],after_update:[],callbacks:c()};At({$$:a});const l=e(t,n,s,r);At(o);return l}return{render:(e={},{$$slots:n={},context:s=new Map}={})=>{Hn=[];const r={title:"",head:"",css:new Set};const i=t(r,e,{},n,s);u(Hn);return{html:i,css:{code:Array.from(r.css).map((e=>e.code)).join("\n"),map:null},head:r.title+r.head}},$$render:t}}function Xn(e,t,n){if(t==null||n&&!t)return"";const s=n&&t===true?"":`="${Ln(t,true)}"`;return` ${e}${s}`}function zn(e){return e?` class="${e}"`:""}function Vn(e){return Object.keys(e).filter((t=>e[t])).map((t=>`${t}: ${Nn(e[t])};`)).join(" ")}function Jn(e){const t=Vn(e);return t?` style="${t}"`:""}function Kn(e,t,n){const s=e.$$.props[t];if(s!==undefined){e.$$.bound[s]=n;n(e.$$.ctx[s])}}function Gn(e){e&&e.c()}function Qn(e,t){e&&e.l(t)}function Yn(e,t,n,s){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n);if(!s){Gt((()=>{const t=e.$$.on_mount.map(l).filter(f);if(e.$$.on_destroy){e.$$.on_destroy.push(...t)}else{u(t)}e.$$.on_mount=[]}))}i.forEach(Gt)}function Zn(e,t){const n=e.$$;if(n.fragment!==null){nn(n.after_update);u(n.on_destroy);n.fragment&&n.fragment.d(t);n.on_destroy=n.fragment=null;n.ctx=[]}}function es(e,t){if(e.$$.dirty[0]===-1){Ut.push(e);Jt();e.$$.dirty.fill(0)}e.$$.dirty[t/31|0]|=1<<t%31}function ts(e,t,n,r,i,o,a,l=[-1]){const f=Pt;At(e);const d=e.$$={fragment:null,ctx:[],props:o,update:s,not_equal:i,bound:c(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:c(),dirty:l,skip_bound:false,root:t.target||f.$$.root};a&&a(d.root);let h=false;d.ctx=n?n(e,t.props||{},((t,n,...s)=>{const r=s.length?s[0]:n;if(d.ctx&&i(d.ctx[t],d.ctx[t]=r)){if(!d.skip_bound&&d.bound[t])d.bound[t](r);if(h)es(e,t)}return n})):[];d.update();h=true;u(d.before_update);d.fragment=r?r(d.ctx):false;if(t.target){if(t.hydrate){K();const e=Le(t.target);d.fragment&&d.fragment.l(e);e.forEach(ae)}else{d.fragment&&d.fragment.c()}if(t.intro)fn(e.$$.fragment);Yn(e,t.target,t.anchor,t.customElement);G();en()}At(f)}let ns;if(typeof HTMLElement==="function"){ns=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(l).filter(f);for(const e in this.$$.slotted){this.appendChild(this.$$.slotted[e])}}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){u(this.$$.on_disconnect)}$destroy(){Zn(this,1);this.$destroy=s}$on(e,t){if(!f(t)){return s}const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);n.push(t);return()=>{const e=n.indexOf(t);if(e!==-1)n.splice(e,1)}}$set(e){if(this.$$set&&!g(e)){this.$$.skip_bound=true;this.$$set(e);this.$$.skip_bound=false}}}}class ss{$destroy(){Zn(this,1);this.$destroy=s}$on(e,t){if(!f(t)){return s}const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);n.push(t);return()=>{const e=n.indexOf(t);if(e!==-1)n.splice(e,1)}}$set(e){if(this.$$set&&!g(e)){this.$$.skip_bound=true;this.$$set(e);this.$$.skip_bound=false}}}function rs(e,t){document.dispatchEvent(ut(e,Object.assign({version:"3.59.2"},t),{bubbles:true}))}function is(e,t){rs("SvelteDOMInsert",{target:e,node:t});Z(e,t)}function os(e,t){rs("SvelteDOMInsert",{target:e,node:t});re(e,t)}function as(e,t,n){rs("SvelteDOMInsert",{target:e,node:t,anchor:n});ie(e,t,n)}function ls(e,t,n){rs("SvelteDOMInsert",{target:e,node:t,anchor:n});oe(e,t,n)}function cs(e){rs("SvelteDOMRemove",{node:e});ae(e)}function us(e,t){while(e.nextSibling&&e.nextSibling!==t){cs(e.nextSibling)}}function fs(e){while(e.previousSibling){cs(e.previousSibling)}}function ds(e){while(e.nextSibling){cs(e.nextSibling)}}function hs(e,t,n,s,r,i,o){const a=s===true?["capture"]:s?Array.from(Object.keys(s)):[];if(r)a.push("preventDefault");if(i)a.push("stopPropagation");if(o)a.push("stopImmediatePropagation");rs("SvelteDOMAddEventListener",{node:e,event:t,handler:n,modifiers:a});const l=ye(e,t,n,s);return()=>{rs("SvelteDOMRemoveEventListener",{node:e,event:t,handler:n,modifiers:a});l()}}function ps(e,t,n){$e(e,t,n);if(n==null)rs("SvelteDOMRemoveAttribute",{node:e,attribute:t});else rs("SvelteDOMSetAttribute",{node:e,attribute:t,value:n})}function ms(e,t,n){e[t]=n;rs("SvelteDOMSetProperty",{node:e,property:t,value:n})}function gs(e,t,n){e.dataset[t]=n;rs("SvelteDOMSetDataset",{node:e,property:t,value:n})}function ys(e,t){t=""+t;if(e.data===t)return;rs("SvelteDOMSetData",{node:e,data:t});e.data=t}function ws(e,t){t=""+t;if(e.wholeText===t)return;rs("SvelteDOMSetData",{node:e,data:t});e.data=t}function bs(e,t,n){if(~L.indexOf(n)){ws(e,t)}else{ys(e,t)}}function vs(e){if(typeof e!=="string"&&!(e&&typeof e==="object"&&"length"in e)){let t="{#each} only iterates over array-like objects.";if(typeof Symbol==="function"&&e&&Symbol.iterator in e){t+=" You can use a spread to convert this iterable into an array."}throw new Error(t)}}function xs(e,t,n){for(const s of Object.keys(t)){if(!~n.indexOf(s)){console.warn(`<${e}> received an unexpected slot "${s}".`)}}}function _s(e){const t=typeof e==="string";if(e&&!t){throw new Error('<svelte:element> expects "this" attribute to be a string.')}}function $s(e){if(e&&Rn(e)){console.warn(`<svelte:element this="${e}"> is self-closing and cannot have content.`)}}function ks(e,t){const n="this={...} of <svelte:component> should specify a Svelte component.";try{const s=new e(t);if(!s.$$||!s.$set||!s.$on||!s.$destroy){throw new Error(n)}return s}catch(e){const{message:t}=e;if(typeof t==="string"&&t.indexOf("is not a constructor")!==-1){throw new Error(n)}else{throw e}}}class Es extends(null&&ss){constructor(e){if(!e||!e.target&&!e.$$inline){throw new Error("'target' is a required option")}super()}$destroy(){super.$destroy();this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}class Cs extends(null&&Es){constructor(e){super(e)}}function Ss(e){const t=Date.now();return()=>{if(Date.now()-t>e){throw new Error("Infinite loop detected")}}}const Ps=parseFloat;function As(e,t=";"){let n;if(Array.isArray(e)){n=e.filter((e=>e))}else{n=[];for(const t in e){if(e[t]){n.push(`${t}:${e[t]}`)}}}return n.join(t)}function Rs(e,t,n,s){let r;let i;const o="1em";let a;let l;let c;let u="-.125em";const f="visible";if(s){c="center";i="1.25em"}if(n){r=n}if(t){if(t=="lg"){l="1.33333em";a=".75em";u="-.225em"}else if(t=="xs"){l=".75em"}else if(t=="sm"){l=".875em"}else{l=t.replace("x","em")}}return As([As({float:r,width:i,height:o,"line-height":a,"font-size":l,"text-align":c,"vertical-align":u,"transform-origin":"center",overflow:f}),e])}function Fs(e,t,n,s,r,i=1,o="",a=""){let l=1;let c=1;if(r){if(r=="horizontal"){l=-1}else if(r=="vertical"){c=-1}else{l=c=-1}}return As([`translate(${Ps(t)*i}${o},${Ps(n)*i}${o})`,`scale(${l*Ps(e)},${c*Ps(e)})`,s&&`rotate(${s}${a})`]," ")}function Is(e){let t;let n;let s;let r;let i;let o;let a;let l;function c(e,t){if(typeof e[10][4]=="string")return Os;return Ms}let u=c(e,-1);let f=u(e);return{c(){t=de("svg");n=de("g");s=de("g");f.c();$e(s,"transform",e[12]);$e(n,"transform",r="translate("+e[10][0]/2+" "+e[10][1]/2+")");$e(n,"transform-origin",i=""+(e[10][0]/4+" 0"));$e(t,"id",o=e[1]||undefined);$e(t,"class",a="svelte-fa "+e[0]+" f");$e(t,"style",e[11]);$e(t,"viewBox",l="0 0 "+e[10][0]+" "+e[10][1]);$e(t,"aria-hidden","true");$e(t,"role","img");$e(t,"xmlns","http://www.w3.org/2000/svg");ct(t,"pulse",e[4]);ct(t,"spin",e[3])},m(e,r){ie(e,t,r);Z(t,n);Z(n,s);f.m(s,null)},p(e,d){if(u===(u=c(e,d))&&f){f.p(e,d)}else{f.d(1);f=u(e);if(f){f.c();f.m(s,null)}}if(d&4096){$e(s,"transform",e[12])}if(d&1024&&r!==(r="translate("+e[10][0]/2+" "+e[10][1]/2+")")){$e(n,"transform",r)}if(d&1024&&i!==(i=""+(e[10][0]/4+" 0"))){$e(n,"transform-origin",i)}if(d&2&&o!==(o=e[1]||undefined)){$e(t,"id",o)}if(d&1&&a!==(a="svelte-fa "+e[0]+" f")){$e(t,"class",a)}if(d&2048){$e(t,"style",e[11])}if(d&1024&&l!==(l="0 0 "+e[10][0]+" "+e[10][1])){$e(t,"viewBox",l)}if(d&17){ct(t,"pulse",e[4])}if(d&9){ct(t,"spin",e[3])}},d(e){if(e)ae(t);f.d()}}}function Ms(e){let t;let n;let s;let r;let i;let o;let a;let l;let c;let u;return{c(){t=de("path");o=de("path");$e(t,"d",n=e[10][4][0]);$e(t,"fill",s=e[6]||e[2]||"currentColor");$e(t,"fill-opacity",r=e[9]!=false?e[7]:e[8]);$e(t,"transform",i="translate("+e[10][0]/-2+" "+e[10][1]/-2+")");$e(o,"d",a=e[10][4][1]);$e(o,"fill",l=e[5]||e[2]||"currentColor");$e(o,"fill-opacity",c=e[9]!=false?e[8]:e[7]);$e(o,"transform",u="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")},m(e,n){ie(e,t,n);ie(e,o,n)},p(e,f){if(f&1024&&n!==(n=e[10][4][0])){$e(t,"d",n)}if(f&68&&s!==(s=e[6]||e[2]||"currentColor")){$e(t,"fill",s)}if(f&896&&r!==(r=e[9]!=false?e[7]:e[8])){$e(t,"fill-opacity",r)}if(f&1024&&i!==(i="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")){$e(t,"transform",i)}if(f&1024&&a!==(a=e[10][4][1])){$e(o,"d",a)}if(f&36&&l!==(l=e[5]||e[2]||"currentColor")){$e(o,"fill",l)}if(f&896&&c!==(c=e[9]!=false?e[8]:e[7])){$e(o,"fill-opacity",c)}if(f&1024&&u!==(u="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")){$e(o,"transform",u)}},d(e){if(e)ae(t);if(e)ae(o)}}}function Os(e){let t;let n;let s;let r;return{c(){t=de("path");$e(t,"d",n=e[10][4]);$e(t,"fill",s=e[2]||e[5]||"currentColor");$e(t,"transform",r="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")},m(e,n){ie(e,t,n)},p(e,i){if(i&1024&&n!==(n=e[10][4])){$e(t,"d",n)}if(i&36&&s!==(s=e[2]||e[5]||"currentColor")){$e(t,"fill",s)}if(i&1024&&r!==(r="translate("+e[10][0]/-2+" "+e[10][1]/-2+")")){$e(t,"transform",r)}},d(e){if(e)ae(t)}}}function Ts(e){let t;let n=e[10][4]&&Is(e);return{c(){if(n)n.c();t=me()},m(e,s){if(n)n.m(e,s);ie(e,t,s)},p(e,[s]){if(e[10][4]){if(n){n.p(e,s)}else{n=Is(e);n.c();n.m(t.parentNode,t)}}else if(n){n.d(1);n=null}},i:s,o:s,d(e){if(n)n.d(e);if(e)ae(t)}}}function Ls(e,t,n){let{class:s=""}=t;let{id:r=""}=t;let{style:i=""}=t;let{icon:o}=t;let{size:a=""}=t;let{color:l=""}=t;let{fw:c=false}=t;let{pull:u=""}=t;let{scale:f=1}=t;let{translateX:d=0}=t;let{translateY:h=0}=t;let{rotate:p=""}=t;let{flip:m=false}=t;let{spin:g=false}=t;let{pulse:y=false}=t;let{primaryColor:w=""}=t;let{secondaryColor:b=""}=t;let{primaryOpacity:v=1}=t;let{secondaryOpacity:x=.4}=t;let{swapOpacity:_=false}=t;let $;let k;let E;e.$$set=e=>{if("class"in e)n(0,s=e.class);if("id"in e)n(1,r=e.id);if("style"in e)n(13,i=e.style);if("icon"in e)n(14,o=e.icon);if("size"in e)n(15,a=e.size);if("color"in e)n(2,l=e.color);if("fw"in e)n(16,c=e.fw);if("pull"in e)n(17,u=e.pull);if("scale"in e)n(18,f=e.scale);if("translateX"in e)n(19,d=e.translateX);if("translateY"in e)n(20,h=e.translateY);if("rotate"in e)n(21,p=e.rotate);if("flip"in e)n(22,m=e.flip);if("spin"in e)n(3,g=e.spin);if("pulse"in e)n(4,y=e.pulse);if("primaryColor"in e)n(5,w=e.primaryColor);if("secondaryColor"in e)n(6,b=e.secondaryColor);if("primaryOpacity"in e)n(7,v=e.primaryOpacity);if("secondaryOpacity"in e)n(8,x=e.secondaryOpacity);if("swapOpacity"in e)n(9,_=e.swapOpacity)};e.$$.update=()=>{if(e.$$.dirty&16384){e:n(10,$=o&&o.icon||[0,0,"",[],""])}if(e.$$.dirty&237568){e:n(11,k=Rs(i,a,u,c))}if(e.$$.dirty&8126464){e:n(12,E=Fs(f,d,h,p,m,512))}};return[s,r,l,g,y,w,b,v,x,_,$,k,E,i,o,a,c,u,f,d,h,p,m]}class Ns extends ss{constructor(e){super();ts(this,e,Ls,Ts,d,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}}const js=Ns;function Ds(e){return new Promise((t=>{setTimeout(t,e)}))}function qs(e){return new Promise(((t,n)=>{setTimeout((()=>n(new Error(`Timeout ${e} ms`))),e)}))}function Us(e){const t=parseFloat(e);return!Number.isNaN(t)&&Number.isFinite(t)?t:null}function Bs(e){const t=parseInt(e,10);return!Number.isNaN(t)&&Number.isFinite(t)?t:null}function Hs(){try{return crypto.randomUUID()}catch{try{return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}catch{return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)}))}}}function Ws(e,t){try{const n=JSON.parse(localStorage.getItem(e));return n!==null&&typeof n===typeof t&&n.constructor.name===t.constructor.name?n.constructor.name==="Object"?Object.assign(t,n):n:t}catch(n){log(`Warning: Failed to load ${e} from localStorage: ${n.message}`,n);return t}}function Xs(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(t){log(`Warning: Failed to save ${e} to localStorage: ${t.message}`,t)}}function zs(e,t,n){const s=new Blob([n],{type:e});const r=window.document.createElement("a");r.href=window.URL.createObjectURL(s);r.download=t;document.body.appendChild(r);r.click();document.body.removeChild(r)}function Vs(e){const t="position: absolute; width: 0; height: 0; overflow: hidden;";document.querySelector("#uploadFileUtil")?.remove();document.body.insertAdjacentHTML("beforeEnd",`<input type="file" id="uploadFileUtil" accept="${e}" style="${t}" />`);const n=document.querySelector("#uploadFileUtil");return new Promise(((e,t)=>{let s=false;n.addEventListener("change",(async()=>{s=true;try{e(JSON.parse(await n.files[0].text()))}catch(e){t(e)}n.remove()}),{once:true});window.addEventListener("focus",(()=>{setTimeout((()=>{if(s)return;e(null);n.remove()}),300)}),{once:true});n.click()}))}const Js="0.18.0";let Ks=false;let Gs=undefined;let Qs=undefined;let Ys=null&&undefined;let Zs=null&&undefined;let er=null&&undefined;let tr=null&&undefined;let nr=null&&undefined;let sr=undefined;let rr=undefined;let ir=null&&undefined;let or=undefined;let ar=undefined;let lr=null&&undefined;function cr(e,t={auto:false}){if(Ks){throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${e.kind}'\` before importing anything else from @anthropic-ai/sdk`)}if(Gs){throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${e.kind}'\` after \`import '@anthropic-ai/sdk/shims/${Gs}'\``)}Ks=t.auto;Gs=e.kind;Qs=e.fetch;Ys=e.Request;Zs=e.Response;er=e.Headers;tr=e.FormData;nr=e.Blob;sr=e.File;rr=e.ReadableStream;ir=e.getMultipartRequestOptions;or=e.getDefaultAgent;ar=e.fileFromPath;lr=e.isFsReadStream}class ur{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function fr({manuallyImported:e}={}){const t=e?`You may need to use polyfills`:`Add one of these imports before your first \`import … from '@anthropic-ai/sdk'\`:\n- \`import '@anthropic-ai/sdk/shims/node'\` (if you're running on Node)\n- \`import '@anthropic-ai/sdk/shims/web'\` (otherwise)\n`;let n,s,r,i;try{n=fetch;s=Request;r=Response;i=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:s,Response:r,Headers:i,FormData:typeof FormData!=="undefined"?FormData:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob!=="undefined"?Blob:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File!=="undefined"?File:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream!=="undefined"?ReadableStream:class e{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new ur(e)}),getDefaultAgent:e=>undefined,fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:e=>false}}if(!Gs)cr(fr(),{auto:true});class dr extends Error{}class hr extends dr{constructor(e,t,n,s){super(`${hr.makeMessage(e,t,n)}`);this.status=e;this.headers=s;this.error=t}static makeMessage(e,t,n){const s=t?.message?typeof t.message==="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;if(e&&s){return`${e} ${s}`}if(e){return`${e} status code (no body)`}if(s){return s}return"(no status code or body)"}static generate(e,t,n,s){if(!e){return new mr({cause:mi(t)})}const r=t;if(e===400){return new yr(e,r,n,s)}if(e===401){return new wr(e,r,n,s)}if(e===403){return new br(e,r,n,s)}if(e===404){return new vr(e,r,n,s)}if(e===409){return new xr(e,r,n,s)}if(e===422){return new _r(e,r,n,s)}if(e===429){return new $r(e,r,n,s)}if(e>=500){return new kr(e,r,n,s)}return new hr(e,r,n,s)}}class pr extends hr{constructor({message:e}={}){super(undefined,undefined,e||"Request was aborted.",undefined);this.status=undefined}}class mr extends hr{constructor({message:e,cause:t}){super(undefined,undefined,e||"Connection error.",undefined);this.status=undefined;if(t)this.cause=t}}class gr extends mr{constructor({message:e}={}){super({message:e??"Request timed out."})}}class yr extends hr{constructor(){super(...arguments);this.status=400}}class wr extends hr{constructor(){super(...arguments);this.status=401}}class br extends hr{constructor(){super(...arguments);this.status=403}}class vr extends hr{constructor(){super(...arguments);this.status=404}}class xr extends hr{constructor(){super(...arguments);this.status=409}}class _r extends hr{constructor(){super(...arguments);this.status=422}}class $r extends hr{constructor(){super(...arguments);this.status=429}}class kr extends hr{}class Er{constructor(e,t){this.iterator=e;this.controller=t}static fromSSEResponse(e,t){let n=false;const s=new Cr;async function*r(){if(!e.body){t.abort();throw new dr(`Attempted to iterate over a response with no body`)}const n=new Sr;const r=Rr(e.body);for await(const e of r){for(const t of n.decode(e)){const e=s.decode(t);if(e)yield e}}for(const e of n.flush()){const t=s.decode(e);if(t)yield t}}async function*i(){if(n){throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.")}n=true;let s=false;try{for await(const t of r()){if(t.event==="completion"){try{yield JSON.parse(t.data)}catch(e){console.error(`Could not parse message into JSON:`,t.data);console.error(`From chunk:`,t.raw);throw e}}if(t.event==="message_start"||t.event==="message_delta"||t.event==="message_stop"||t.event==="content_block_start"||t.event==="content_block_delta"||t.event==="content_block_stop"){try{yield JSON.parse(t.data)}catch(e){console.error(`Could not parse message into JSON:`,t.data);console.error(`From chunk:`,t.raw);throw e}}if(t.event==="ping"){continue}if(t.event==="error"){const n=t.data;const s=ui(n);const r=s?undefined:n;throw hr.generate(undefined,s,r,ti(e.headers))}}s=true}catch(e){if(e instanceof Error&&e.name==="AbortError")return;throw e}finally{if(!s)t.abort()}}return new Er(i,t)}static fromReadableStream(e,t){let n=false;async function*s(){const t=new Sr;const n=Rr(e);for await(const e of n){for(const n of t.decode(e)){yield n}}for(const e of t.flush()){yield e}}async function*r(){if(n){throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.")}n=true;let e=false;try{for await(const t of s()){if(e)continue;if(t)yield JSON.parse(t)}e=true}catch(e){if(e instanceof Error&&e.name==="AbortError")return;throw e}finally{if(!e)t.abort()}}return new Er(r,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[];const t=[];const n=this.iterator();const s=s=>({next:()=>{if(s.length===0){const s=n.next();e.push(s);t.push(s)}return s.shift()}});return[new Er((()=>s(e)),this.controller),new Er((()=>s(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new rr({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:s,done:r}=await t.next();if(r)return e.close();const i=n.encode(JSON.stringify(s)+"\n");e.enqueue(i)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}class Cr{constructor(){this.event=null;this.data=[];this.chunks=[]}decode(e){if(e.endsWith("\r")){e=e.substring(0,e.length-1)}if(!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};this.event=null;this.data=[];this.chunks=[];return e}this.chunks.push(e);if(e.startsWith(":")){return null}let[t,n,s]=Ar(e,":");if(s.startsWith(" ")){s=s.substring(1)}if(t==="event"){this.event=s}else if(t==="data"){this.data.push(s)}return null}}class Sr{constructor(){this.buffer=[];this.trailingCR=false}decode(e){let t=this.decodeText(e);if(this.trailingCR){t="\r"+t;this.trailingCR=false}if(t.endsWith("\r")){this.trailingCR=true;t=t.slice(0,-1)}if(!t){return[]}const n=Sr.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(Sr.NEWLINE_REGEXP);if(n){s.pop()}if(s.length===1&&!n){this.buffer.push(s[0]);return[]}if(this.buffer.length>0){s=[this.buffer.join("")+s[0],...s.slice(1)];this.buffer=[]}if(!n){this.buffer=[s.pop()||""]}return s}decodeText(e){if(e==null)return"";if(typeof e==="string")return e;if(typeof Buffer!=="undefined"){if(e instanceof Buffer){return e.toString()}if(e instanceof Uint8Array){return Buffer.from(e).toString()}throw new dr(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!=="undefined"){if(e instanceof Uint8Array||e instanceof ArrayBuffer){this.textDecoder??(this.textDecoder=new TextDecoder("utf8"));return this.textDecoder.decode(e)}throw new dr(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new dr(`Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.`)}flush(){if(!this.buffer.length&&!this.trailingCR){return[]}const e=[this.buffer.join("")];this.buffer=[];this.trailingCR=false;return e}}Sr.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]);Sr.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function Pr(e){const t=new Sr;const n=[];for(const s of e){n.push(...t.decode(s))}return n}function Ar(e,t){const n=e.indexOf(t);if(n!==-1){return[e.substring(0,n),t,e.substring(n+t.length)]}return[e,"",""]}function Rr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();if(e?.done)t.releaseLock();return e}catch(e){t.releaseLock();throw e}},async return(){const e=t.cancel();t.releaseLock();await e;return{done:true,value:undefined}},[Symbol.asyncIterator](){return this}}}const Fr=e=>e!=null&&typeof e==="object"&&typeof e.url==="string"&&typeof e.blob==="function";const Ir=e=>e!=null&&typeof e==="object"&&typeof e.name==="string"&&typeof e.lastModified==="number"&&Mr(e);const Mr=e=>e!=null&&typeof e==="object"&&typeof e.size==="number"&&typeof e.type==="string"&&typeof e.text==="function"&&typeof e.slice==="function"&&typeof e.arrayBuffer==="function";const Or=e=>Ir(e)||Fr(e)||isFsReadStream(e);async function Tr(e,t,n={}){e=await e;if(Fr(e)){const s=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");return new sr([s],t,n)}const s=await Lr(e);t||(t=jr(e)??"unknown_file");if(!n.type){const e=s[0]?.type;if(typeof e==="string"){n={...n,type:e}}}return new sr(s,t,n)}async function Lr(e){let t=[];if(typeof e==="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer){t.push(e)}else if(Mr(e)){t.push(await e.arrayBuffer())}else if(qr(e)){for await(const n of e){t.push(n)}}else{throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${Nr(e)}`)}return t}function Nr(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}function jr(e){return Dr(e.name)||Dr(e.filename)||Dr(e.path)?.split(/[\\/]/).pop()}const Dr=e=>{if(typeof e==="string")return e;if(typeof Buffer!=="undefined"&&e instanceof Buffer)return String(e);return undefined};const qr=e=>e!=null&&typeof e==="object"&&typeof e[Symbol.asyncIterator]==="function";const Ur=e=>e&&typeof e==="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody";const Br=async e=>{if(!Xr(e.body))return e;const t=await Wr(e.body);return getMultipartRequestOptions(t,e)};const Hr=async e=>{const t=await Wr(e.body);return getMultipartRequestOptions(t,e)};const Wr=async e=>{const t=new FormData;await Promise.all(Object.entries(e||{}).map((([e,n])=>zr(t,e,n))));return t};const Xr=e=>{if(Or(e))return true;if(Array.isArray(e))return e.some(Xr);if(e&&typeof e==="object"){for(const t in e){if(Xr(e[t]))return true}}return false};const zr=async(e,t,n)=>{if(n===undefined)return;if(n==null){throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`)}if(typeof n==="string"||typeof n==="number"||typeof n==="boolean"){e.append(t,String(n))}else if(Or(n)){const s=await Tr(n);e.append(t,s)}else if(Array.isArray(n)){await Promise.all(n.map((n=>zr(e,t+"[]",n))))}else if(typeof n==="object"){await Promise.all(Object.entries(n).map((([n,s])=>zr(e,`${t}[${n}]`,s))))}else{throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Vr=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n};var Jr=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)};var Kr;async function Gr(e){const{response:t}=e;if(e.options.stream){Si("response",t.status,t.url,t.headers,t.body);if(e.options.__streamClass){return e.options.__streamClass.fromSSEResponse(t,e.controller)}return Er.fromSSEResponse(t,e.controller)}if(t.status===204){return null}if(e.options.__binaryResponse){return t}const n=t.headers.get("content-type");const s=n?.includes("application/json")||n?.includes("application/vnd.api+json");if(s){const e=await t.json();Si("response",t.status,t.url,t.headers,e);return e}const r=await t.text();Si("response",t.status,t.url,t.headers,r);return r}class Qr extends Promise{constructor(e,t=Gr){super((e=>{e(null)}));this.responsePromise=e;this.parseResponse=t}_thenUnwrap(e){return new Qr(this.responsePromise,(async t=>e(await this.parseResponse(t))))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){if(!this.parsedPromise){this.parsedPromise=this.responsePromise.then(this.parseResponse)}return this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Yr{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:s,fetch:r}){this.baseURL=e;this.maxRetries=pi("maxRetries",t);this.timeout=pi("timeout",n);this.httpAgent=s;this.fetch=r??Qs}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ci(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Pi()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((n=>({method:e,path:t,...n}))))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e==="string"){if(typeof Buffer!=="undefined"){return Buffer.byteLength(e,"utf8").toString()}if(typeof TextEncoder!=="undefined"){const t=new TextEncoder;const n=t.encode(e);return n.length.toString()}}return null}buildRequest(e){const{method:t,path:n,query:s,headers:r={}}=e;const i=Ur(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null;const o=this.calculateContentLength(i);const a=this.buildURL(n,s);if("timeout"in e)pi("timeout",e.timeout);const l=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??or(a);const u=l+1e3;if(typeof c?.options?.timeout==="number"&&u>(c.options.timeout??0)){c.options.timeout=u}if(this.idempotencyHeader&&t!=="get"){if(!e.idempotencyKey)e.idempotencyKey=this.defaultIdempotencyKey();r[this.idempotencyHeader]=e.idempotencyKey}const f=this.buildHeaders({options:e,headers:r,contentLength:o});const d={method:t,...i&&{body:i},headers:f,...c&&{agent:c},signal:e.signal??null};return{req:d,url:a,timeout:l}}buildHeaders({options:e,headers:t,contentLength:n}){const s={};if(n){s["content-length"]=n}const r=this.defaultHeaders(e);Ci(s,r);Ci(s,t);if(Ur(e.body)&&Gs!=="node"){delete s["content-type"]}this.validateHeaders(s,t);return s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return!e?{}:Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}}makeStatusError(e,t,n,s){return hr.generate(e,t,n,s)}request(e,t=null){return new Qr(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e;if(t==null){t=n.maxRetries??this.maxRetries}await this.prepareOptions(n);const{req:s,url:r,timeout:i}=this.buildRequest(n);await this.prepareRequest(s,{url:r,options:n});Si("request",r,n,s.headers);if(n.signal?.aborted){throw new pr}const o=new AbortController;const a=await this.fetchWithTimeout(r,s,i,o).catch(mi);if(a instanceof Error){if(n.signal?.aborted){throw new pr}if(t){return this.retryRequest(n,t)}if(a.name==="AbortError"){throw new gr}throw new mr({cause:a})}const l=ti(a.headers);if(!a.ok){if(t&&this.shouldRetry(a)){const e=`retrying, ${t} attempts remaining`;Si(`response (error; ${e})`,a.status,r,l);return this.retryRequest(n,t,l)}const e=await a.text().catch((e=>mi(e).message));const s=ui(e);const i=s?undefined:e;const o=t?`(error; no more retries left)`:`(error; not retryable)`;Si(`response (error; ${o})`,a.status,r,l,i);const c=this.makeStatusError(a.status,s,i,l);throw c}return{response:a,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new ei(this,n,e)}buildURL(e,t){const n=di(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e));const s=this.defaultQuery();if(!ki(s)){t={...s,...t}}if(typeof t==="object"&&t&&!Array.isArray(t)){n.search=this.stringifyQuery(t)}return n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>typeof t!=="undefined")).map((([e,t])=>{if(typeof t==="string"||typeof t==="number"||typeof t==="boolean"){return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`}if(t===null){return`${encodeURIComponent(e)}=`}throw new dr(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,s){const{signal:r,...i}=t||{};if(r)r.addEventListener("abort",(()=>s.abort()));const o=setTimeout((()=>s.abort()),n);return this.getRequestClient().fetch.call(undefined,e,{signal:s.signal,...i}).finally((()=>{clearTimeout(o)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");if(t==="true")return true;if(t==="false")return false;if(e.status===408)return true;if(e.status===409)return true;if(e.status===429)return true;if(e.status>=500)return true;return false}async retryRequest(e,t,n){let s;const r=n?.["retry-after-ms"];if(r){const e=parseFloat(r);if(!Number.isNaN(e)){s=e}}const i=n?.["retry-after"];if(i&&!s){const e=parseFloat(i);if(!Number.isNaN(e)){s=e*1e3}else{s=Date.parse(i)-Date.now()}}if(!(s&&0<=s&&s<60*1e3)){const n=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,n)}await hi(s);return this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=.5;const s=8;const r=t-e;const i=Math.min(n*Math.pow(2,r),s);const o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Js}`}}class Zr{constructor(e,t,n,s){Kr.set(this,void 0);Vr(this,Kr,e,"f");this.options=s;this.response=t;this.body=n}hasNextPage(){const e=this.getPaginatedItems();if(!e.length)return false;return this.nextPageInfo()!=null}async getNextPage(){const e=this.nextPageInfo();if(!e){throw new dr("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.")}const t={...this.options};if("params"in e&&typeof t.query==="object"){t.query={...t.query,...e.params}}else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,s]of n){e.url.searchParams.set(t,s)}t.query=undefined;t.path=e.url.toString()}return await Jr(this,Kr,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;yield e;while(e.hasNextPage()){e=await e.getNextPage();yield e}}async*[(Kr=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages()){for(const t of e.getPaginatedItems()){yield t}}}}class ei extends Qr{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await Gr(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e){yield t}}}const ti=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}});const ni={method:true,path:true,query:true,body:true,headers:true,maxRetries:true,stream:true,timeout:true,httpAgent:true,signal:true,idempotencyKey:true,__binaryResponse:true,__streamClass:true};const si=e=>typeof e==="object"&&e!==null&&!ki(e)&&Object.keys(e).every((e=>Ei(ni,e)));const ri=()=>{if(typeof Deno!=="undefined"&&Deno.build!=null){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Js,"X-Stainless-OS":ai(Deno.build.os),"X-Stainless-Arch":oi(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version}}if(typeof EdgeRuntime!=="undefined"){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version}}if(Object.prototype.toString.call(typeof process!=="undefined"?process:0)==="[object process]"){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Js,"X-Stainless-OS":ai(process.platform),"X-Stainless-Arch":oi(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version}}const e=ii();if(e){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}}return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Js,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ii(){if(typeof navigator==="undefined"||!navigator){return null}const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0;const s=e[2]||0;const r=e[3]||0;return{browser:t,version:`${n}.${s}.${r}`}}}return null}const oi=e=>{if(e==="x32")return"x32";if(e==="x86_64"||e==="x64")return"x64";if(e==="arm")return"arm";if(e==="aarch64"||e==="arm64")return"arm64";if(e)return`other:${e}`;return"unknown"};const ai=e=>{e=e.toLowerCase();if(e.includes("ios"))return"iOS";if(e==="android")return"Android";if(e==="darwin")return"MacOS";if(e==="win32")return"Windows";if(e==="freebsd")return"FreeBSD";if(e==="openbsd")return"OpenBSD";if(e==="linux")return"Linux";if(e)return`Other:${e}`;return"Unknown"};let li;const ci=()=>li??(li=ri());const ui=e=>{try{return JSON.parse(e)}catch(e){return undefined}};const fi=new RegExp("^(?:[a-z]+:)?//","i");const di=e=>fi.test(e);const hi=e=>new Promise((t=>setTimeout(t,e)));const pi=(e,t)=>{if(typeof t!=="number"||!Number.isInteger(t)){throw new dr(`${e} must be an integer`)}if(t<0){throw new dr(`${e} must be a positive integer`)}return t};const mi=e=>{if(e instanceof Error)return e;return new Error(e)};const gi=e=>{if(e==null)throw new AnthropicError(`Expected a value to be given but received ${e} instead.`);return e};const yi=e=>{if(typeof process!=="undefined"){return"MISSING_ENV_VAR"?.[e]?.trim()??undefined}if(typeof Deno!=="undefined"){return Deno.env?.get?.(e)?.trim()}return undefined};const wi=e=>{if(typeof e==="number")return Math.round(e);if(typeof e==="string")return parseInt(e,10);throw new AnthropicError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};const bi=e=>{if(typeof e==="number")return e;if(typeof e==="string")return parseFloat(e);throw new AnthropicError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};const vi=e=>{if(typeof e==="boolean")return e;if(typeof e==="string")return e==="true";return Boolean(e)};const xi=e=>{if(e===undefined){return undefined}return wi(e)};const _i=e=>{if(e===undefined){return undefined}return bi(e)};const $i=e=>{if(e===undefined){return undefined}return vi(e)};function ki(e){if(!e)return true;for(const t in e)return false;return true}function Ei(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ci(e,t){for(const n in t){if(!Ei(t,n))continue;const s=n.toLowerCase();if(!s)continue;const r=t[n];if(r===null){delete e[s]}else if(r!==undefined){e[s]=r}}}function Si(e,...t){if(typeof process!=="undefined"&&"MISSING_ENV_VAR"["DEBUG"]==="true"){console.log(`Anthropic:DEBUG:${e}`,...t)}}const Pi=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.random()*16|0;const n=e==="x"?t:t&3|8;return n.toString(16)}));const Ai=()=>typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof navigator!=="undefined";const Ri=e=>typeof e?.get==="function";const Fi=(e,t)=>{const n=t.toLowerCase();if(Ri(e)){const s=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const r of[t,n,t.toUpperCase(),s]){const t=e.get(r);if(t){return t}}}for(const[s,r]of Object.entries(e)){if(s.toLowerCase()===n){if(Array.isArray(r)){if(r.length<=1)return r[0];console.warn(`Received ${r.length} entries for the ${t} header, using the first entry.`);return r[0]}return r}}throw new Error(`Could not find ${t} header`)};const Ii=e=>{if(!e)return"";if(typeof Buffer!=="undefined"){return Buffer.from(e).toString("base64")}if(typeof btoa!=="undefined"){return btoa(e)}throw new AnthropicError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")};function Mi(e){return e!=null&&typeof e==="object"&&!Array.isArray(e)}class Oi{constructor(e){this._client=e}}class Ti extends Oi{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:6e5,...t,stream:e.stream??false})}}(function(e){})(Ti||(Ti={}));var Li=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n};var Ni=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)};var ji,Di,qi,Ui,Bi,Hi,Wi,Xi,zi,Vi,Ji,Ki,Gi,Qi,Yi,Zi,eo,to,no,so;class ro{constructor(){ji.add(this);this.messages=[];this.receivedMessages=[];Di.set(this,void 0);this.controller=new AbortController;qi.set(this,void 0);Ui.set(this,(()=>{}));Bi.set(this,(()=>{}));Hi.set(this,void 0);Wi.set(this,(()=>{}));Xi.set(this,(()=>{}));zi.set(this,{});Vi.set(this,false);Ji.set(this,false);Ki.set(this,false);Gi.set(this,false);Zi.set(this,(e=>{Li(this,Ji,true,"f");if(e instanceof Error&&e.name==="AbortError"){e=new pr}if(e instanceof pr){Li(this,Ki,true,"f");return this._emit("abort",e)}if(e instanceof dr){return this._emit("error",e)}if(e instanceof Error){const t=new dr(e.message);t.cause=e;return this._emit("error",t)}return this._emit("error",new dr(String(e)))}));Li(this,qi,new Promise(((e,t)=>{Li(this,Ui,e,"f");Li(this,Bi,t,"f")})),"f");Li(this,Hi,new Promise(((e,t)=>{Li(this,Wi,e,"f");Li(this,Xi,t,"f")})),"f");Ni(this,qi,"f").catch((()=>{}));Ni(this,Hi,"f").catch((()=>{}))}static fromReadableStream(e){const t=new ro;t._run((()=>t._fromReadableStream(e)));return t}static createMessage(e,t,n){const s=new ro;for(const e of t.messages){s._addMessageParam(e)}s._run((()=>s._createMessage(e,{...t,stream:true},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})));return s}_run(e){e().then((()=>{this._emitFinal();this._emit("end")}),Ni(this,Zi,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=true){this.receivedMessages.push(e);if(t){this._emit("message",e)}}async _createMessage(e,t,n){const s=n?.signal;if(s){if(s.aborted)this.controller.abort();s.addEventListener("abort",(()=>this.controller.abort()))}Ni(this,ji,"m",eo).call(this);const r=await e.create({...t,stream:true},{...n,signal:this.controller.signal});this._connected();for await(const e of r){Ni(this,ji,"m",to).call(this,e)}if(r.controller.signal?.aborted){throw new pr}Ni(this,ji,"m",no).call(this)}_connected(){if(this.ended)return;Ni(this,Ui,"f").call(this);this._emit("connect")}get ended(){return Ni(this,Vi,"f")}get errored(){return Ni(this,Ji,"f")}get aborted(){return Ni(this,Ki,"f")}abort(){this.controller.abort()}on(e,t){const n=Ni(this,zi,"f")[e]||(Ni(this,zi,"f")[e]=[]);n.push({listener:t});return this}off(e,t){const n=Ni(this,zi,"f")[e];if(!n)return this;const s=n.findIndex((e=>e.listener===t));if(s>=0)n.splice(s,1);return this}once(e,t){const n=Ni(this,zi,"f")[e]||(Ni(this,zi,"f")[e]=[]);n.push({listener:t,once:true});return this}emitted(e){return new Promise(((t,n)=>{Li(this,Gi,true,"f");if(e!=="error")this.once("error",n);this.once(e,t)}))}async done(){Li(this,Gi,true,"f");await Ni(this,Hi,"f")}get currentMessage(){return Ni(this,Di,"f")}async finalMessage(){await this.done();return Ni(this,ji,"m",Qi).call(this)}async finalText(){await this.done();return Ni(this,ji,"m",Yi).call(this)}_emit(e,...t){if(Ni(this,Vi,"f"))return;if(e==="end"){Li(this,Vi,true,"f");Ni(this,Wi,"f").call(this)}const n=Ni(this,zi,"f")[e];if(n){Ni(this,zi,"f")[e]=n.filter((e=>!e.once));n.forEach((({listener:e})=>e(...t)))}if(e==="abort"){const e=t[0];if(!Ni(this,Gi,"f")&&!n?.length){Promise.reject(e)}Ni(this,Bi,"f").call(this,e);Ni(this,Xi,"f").call(this,e);this._emit("end");return}if(e==="error"){const e=t[0];if(!Ni(this,Gi,"f")&&!n?.length){Promise.reject(e)}Ni(this,Bi,"f").call(this,e);Ni(this,Xi,"f").call(this,e);this._emit("end")}}_emitFinal(){const e=this.receivedMessages.at(-1);if(e){this._emit("finalMessage",Ni(this,ji,"m",Qi).call(this))}}async _fromReadableStream(e,t){const n=t?.signal;if(n){if(n.aborted)this.controller.abort();n.addEventListener("abort",(()=>this.controller.abort()))}Ni(this,ji,"m",eo).call(this);this._connected();const s=Er.fromReadableStream(e,this.controller);for await(const e of s){Ni(this,ji,"m",to).call(this,e)}if(s.controller.signal?.aborted){throw new pr}Ni(this,ji,"m",no).call(this)}[(Di=new WeakMap,qi=new WeakMap,Ui=new WeakMap,Bi=new WeakMap,Hi=new WeakMap,Wi=new WeakMap,Xi=new WeakMap,zi=new WeakMap,Vi=new WeakMap,Ji=new WeakMap,Ki=new WeakMap,Gi=new WeakMap,Zi=new WeakMap,ji=new WeakSet,Qi=function e(){if(this.receivedMessages.length===0){throw new dr("stream ended without producing a Message with role=assistant")}return this.receivedMessages.at(-1)},Yi=function e(){if(this.receivedMessages.length===0){throw new dr("stream ended without producing a Message with role=assistant")}const t=this.receivedMessages.at(-1).content.filter((e=>e.type==="text")).map((e=>e.text));if(t.length===0){throw new dr("stream ended without producing a content block with type=text")}return t.join(" ")},eo=function e(){if(this.ended)return;Li(this,Di,undefined,"f")},to=function e(t){if(this.ended)return;const n=Ni(this,ji,"m",so).call(this,t);this._emit("streamEvent",t,n);switch(t.type){case"content_block_delta":{if(t.delta.type==="text_delta"){this._emit("text",t.delta.text,n.content.at(-1).text||"")}break}case"message_stop":{this._addMessageParam(n);this._addMessage(n,true);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{Li(this,Di,n,"f");break}case"content_block_start":case"message_delta":break}},no=function e(){if(this.ended){throw new dr(`stream has ended, this shouldn't happen`)}const t=Ni(this,Di,"f");if(!t){throw new dr(`request ended without sending any chunks`)}Li(this,Di,undefined,"f");return t},so=function e(t){let n=Ni(this,Di,"f");if(t.type==="message_start"){if(n){throw new dr(`Unexpected event order, got ${t.type} before receiving "message_stop"`)}return t.message}if(!n){throw new dr(`Unexpected event order, got ${t.type} before "message_start"`)}switch(t.type){case"message_stop":return n;case"message_delta":n.stop_reason=t.delta.stop_reason;n.stop_sequence=t.delta.stop_sequence;return n;case"content_block_start":n.content.push(t.content_block);return n;case"content_block_delta":{const e=n.content.at(t.index);if(e?.type==="text"&&t.delta.type==="text_delta"){e.text+=t.delta.text}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const e=[];const t=[];let n=false;this.on("streamEvent",(n=>{const s=t.shift();if(s){s.resolve(n)}else{e.push(n)}}));this.on("end",(()=>{n=true;for(const e of t){e.resolve(undefined)}t.length=0}));this.on("abort",(e=>{n=true;for(const n of t){n.reject(e)}t.length=0}));this.on("error",(e=>{n=true;for(const n of t){n.reject(e)}t.length=0}));return{next:async()=>{if(!e.length){if(n){return{value:undefined,done:true}}return new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:false}:{value:undefined,done:true}))}const s=e.shift();return{value:s,done:false}},return:async()=>{this.abort();return{value:undefined,done:true}}}}toReadableStream(){const e=new Er(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}}class io extends Oi{create(e,t){return this._client.post("/v1/messages",{body:e,timeout:6e5,...t,stream:e.stream??false})}stream(e,t){return ro.createMessage(this,e,t)}}(function(e){})(io||(io={}));var oo;class ao extends Yr{constructor({baseURL:e=yi("ANTHROPIC_BASE_URL"),apiKey:t=yi("ANTHROPIC_API_KEY")??null,authToken:n=yi("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){const r={apiKey:t,authToken:n,...s,baseURL:e||`https://api.anthropic.com`};super({baseURL:r.baseURL,timeout:r.timeout??6e5,httpAgent:r.httpAgent,maxRetries:r.maxRetries,fetch:r.fetch});this.completions=new Ti(this);this.messages=new io(this);this._options=r;this.apiKey=t;this.authToken=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(this.apiKey&&e["x-api-key"]){return}if(t["x-api-key"]===null){return}if(this.authToken&&e["authorization"]){return}if(t["authorization"]===null){return}throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e);const n=this.bearerAuth(e);if(t!=null&&!ki(t)){return t}if(n!=null&&!ki(n)){return n}return{}}apiKeyAuth(e){if(this.apiKey==null){return{}}return{"X-Api-Key":this.apiKey}}bearerAuth(e){if(this.authToken==null){return{}}return{Authorization:`Bearer ${this.authToken}`}}}oo=ao;ao.Anthropic=oo;ao.HUMAN_PROMPT="\n\nHuman:";ao.AI_PROMPT="\n\nAssistant:";ao.AnthropicError=dr;ao.APIError=hr;ao.APIConnectionError=mr;ao.APIConnectionTimeoutError=gr;ao.APIUserAbortError=pr;ao.NotFoundError=vr;ao.ConflictError=xr;ao.RateLimitError=$r;ao.BadRequestError=yr;ao.AuthenticationError=wr;ao.InternalServerError=kr;ao.PermissionDeniedError=br;ao.UnprocessableEntityError=_r;const{HUMAN_PROMPT:lo,AI_PROMPT:co}=ao;const{AnthropicError:uo,APIError:fo,APIConnectionError:ho,APIConnectionTimeoutError:po,APIUserAbortError:mo,NotFoundError:go,ConflictError:yo,RateLimitError:wo,BadRequestError:bo,AuthenticationError:vo,InternalServerError:xo,PermissionDeniedError:_o,UnprocessableEntityError:$o}=e;var ko=Tr;var Eo=ar;(function(e){e.toFile=Tr;e.fileFromPath=ar;e.Completions=Ti;e.Messages=io})(ao||(ao={}));const Co=null&&ao;const So="4.20.1";let Po=false;let Ao=undefined;let Ro=undefined;let Fo=null&&undefined;let Io=null&&undefined;let Mo=null&&undefined;let Oo=undefined;let To=null&&undefined;let Lo=undefined;let No=undefined;let jo=undefined;let Do=undefined;let qo=undefined;let Uo=undefined;function Bo(e,t={auto:false}){if(Po){throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`)}if(Ao){throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Ao}'\``)}Po=t.auto;Ao=e.kind;Ro=e.fetch;Fo=e.Request;Io=e.Response;Mo=e.Headers;Oo=e.FormData;To=e.Blob;Lo=e.File;No=e.ReadableStream;jo=e.getMultipartRequestOptions;Do=e.getDefaultAgent;qo=e.fileFromPath;Uo=e.isFsReadStream}class Ho{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Wo({manuallyImported:e}={}){const t=e?`You may need to use polyfills`:`Add one of these imports before your first \`import … from 'openai'\`:\n- \`import 'openai/shims/node'\` (if you're running on Node)\n- \`import 'openai/shims/web'\` (otherwise)\n`;let n,s,r,i;try{n=fetch;s=Request;r=Response;i=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:s,Response:r,Headers:i,FormData:typeof FormData!=="undefined"?FormData:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob!=="undefined"?Blob:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File!=="undefined"?File:class e{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream!=="undefined"?ReadableStream:class e{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new Ho(e)}),getDefaultAgent:e=>undefined,fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>false}}if(!Ao)Bo(Wo(),{auto:true});class Xo extends Error{}class zo extends Xo{constructor(e,t,n,s){super(`${zo.makeMessage(e,t,n)}`);this.status=e;this.headers=s;const r=t;this.error=r;this.code=r?.["code"];this.param=r?.["param"];this.type=r?.["type"]}static makeMessage(e,t,n){const s=t?.message?typeof t.message==="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;if(e&&s){return`${e} ${s}`}if(e){return`${e} status code (no body)`}if(s){return s}return"(no status code or body)"}static generate(e,t,n,s){if(!e){return new Jo({cause:Va(t)})}const r=t?.["error"];if(e===400){return new Go(e,r,n,s)}if(e===401){return new Qo(e,r,n,s)}if(e===403){return new Yo(e,r,n,s)}if(e===404){return new Zo(e,r,n,s)}if(e===409){return new ea(e,r,n,s)}if(e===422){return new ta(e,r,n,s)}if(e===429){return new na(e,r,n,s)}if(e>=500){return new sa(e,r,n,s)}return new zo(e,r,n,s)}}class Vo extends zo{constructor({message:e}={}){super(undefined,undefined,e||"Request was aborted.",undefined);this.status=undefined}}class Jo extends zo{constructor({message:e,cause:t}){super(undefined,undefined,e||"Connection error.",undefined);this.status=undefined;if(t)this.cause=t}}class Ko extends Jo{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Go extends zo{constructor(){super(...arguments);this.status=400}}class Qo extends zo{constructor(){super(...arguments);this.status=401}}class Yo extends zo{constructor(){super(...arguments);this.status=403}}class Zo extends zo{constructor(){super(...arguments);this.status=404}}class ea extends zo{constructor(){super(...arguments);this.status=409}}class ta extends zo{constructor(){super(...arguments);this.status=422}}class na extends zo{constructor(){super(...arguments);this.status=429}}class sa extends zo{}class ra{constructor(e,t){this.iterator=e;this.controller=t}static fromSSEResponse(e,t){let n=false;const s=new ia;async function*r(){if(!e.body){t.abort();throw new Xo(`Attempted to iterate over a response with no body`)}const n=new oa;const r=la(e.body);for await(const e of r){for(const t of n.decode(e)){const e=s.decode(t);if(e)yield e}}for(const e of n.flush()){const t=s.decode(e);if(t)yield t}}async function*i(){if(n){throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.")}n=true;let e=false;try{for await(const t of r()){if(e)continue;if(t.data.startsWith("[DONE]")){e=true;continue}if(t.event===null){let e;try{e=JSON.parse(t.data)}catch(e){console.error(`Could not parse message into JSON:`,t.data);console.error(`From chunk:`,t.raw);throw e}if(e&&e.error){throw new zo(undefined,e.error,undefined,undefined)}yield e}}e=true}catch(e){if(e instanceof Error&&e.name==="AbortError")return;throw e}finally{if(!e)t.abort()}}return new ra(i,t)}static fromReadableStream(e,t){let n=false;async function*s(){const t=new oa;const n=la(e);for await(const e of n){for(const n of t.decode(e)){yield n}}for(const e of t.flush()){yield e}}async function*r(){if(n){throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.")}n=true;let e=false;try{for await(const t of s()){if(e)continue;if(t)yield JSON.parse(t)}e=true}catch(e){if(e instanceof Error&&e.name==="AbortError")return;throw e}finally{if(!e)t.abort()}}return new ra(r,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[];const t=[];const n=this.iterator();const s=s=>({next:()=>{if(s.length===0){const s=n.next();e.push(s);t.push(s)}return s.shift()}});return[new ra((()=>s(e)),this.controller),new ra((()=>s(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new No({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:s,done:r}=await t.next();if(r)return e.close();const i=n.encode(JSON.stringify(s)+"\n");e.enqueue(i)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}class ia{constructor(){this.event=null;this.data=[];this.chunks=[]}decode(e){if(e.endsWith("\r")){e=e.substring(0,e.length-1)}if(!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};this.event=null;this.data=[];this.chunks=[];return e}this.chunks.push(e);if(e.startsWith(":")){return null}let[t,n,s]=aa(e,":");if(s.startsWith(" ")){s=s.substring(1)}if(t==="event"){this.event=s}else if(t==="data"){this.data.push(s)}return null}}class oa{constructor(){this.buffer=[];this.trailingCR=false}decode(e){let t=this.decodeText(e);if(this.trailingCR){t="\r"+t;this.trailingCR=false}if(t.endsWith("\r")){this.trailingCR=true;t=t.slice(0,-1)}if(!t){return[]}const n=oa.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(oa.NEWLINE_REGEXP);if(s.length===1&&!n){this.buffer.push(s[0]);return[]}if(this.buffer.length>0){s=[this.buffer.join("")+s[0],...s.slice(1)];this.buffer=[]}if(!n){this.buffer=[s.pop()||""]}return s}decodeText(e){if(e==null)return"";if(typeof e==="string")return e;if(typeof Buffer!=="undefined"){if(e instanceof Buffer){return e.toString()}if(e instanceof Uint8Array){return Buffer.from(e).toString()}throw new Xo(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!=="undefined"){if(e instanceof Uint8Array||e instanceof ArrayBuffer){this.textDecoder??(this.textDecoder=new TextDecoder("utf8"));return this.textDecoder.decode(e)}throw new Xo(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Xo(`Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.`)}flush(){if(!this.buffer.length&&!this.trailingCR){return[]}const e=[this.buffer.join("")];this.buffer=[];this.trailingCR=false;return e}}oa.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]);oa.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;function aa(e,t){const n=e.indexOf(t);if(n!==-1){return[e.substring(0,n),t,e.substring(n+t.length)]}return[e,"",""]}function la(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();if(e?.done)t.releaseLock();return e}catch(e){t.releaseLock();throw e}},async return(){const e=t.cancel();t.releaseLock();await e;return{done:true,value:undefined}},[Symbol.asyncIterator](){return this}}}const ca=e=>e!=null&&typeof e==="object"&&typeof e.url==="string"&&typeof e.blob==="function";const ua=e=>e!=null&&typeof e==="object"&&typeof e.name==="string"&&typeof e.lastModified==="number"&&fa(e);const fa=e=>e!=null&&typeof e==="object"&&typeof e.size==="number"&&typeof e.type==="string"&&typeof e.text==="function"&&typeof e.slice==="function"&&typeof e.arrayBuffer==="function";const da=e=>ua(e)||ca(e)||Uo(e);async function ha(e,t,n={}){e=await e;if(ca(e)){const s=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");return new Lo([s],t,n)}const s=await pa(e);t||(t=ga(e)??"unknown_file");if(!n.type){const e=s[0]?.type;if(typeof e==="string"){n={...n,type:e}}}return new Lo(s,t,n)}async function pa(e){let t=[];if(typeof e==="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer){t.push(e)}else if(fa(e)){t.push(await e.arrayBuffer())}else if(wa(e)){for await(const n of e){t.push(n)}}else{throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${ma(e)}`)}return t}function ma(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}function ga(e){return ya(e.name)||ya(e.filename)||ya(e.path)?.split(/[\\/]/).pop()}const ya=e=>{if(typeof e==="string")return e;if(typeof Buffer!=="undefined"&&e instanceof Buffer)return String(e);return undefined};const wa=e=>e!=null&&typeof e==="object"&&typeof e[Symbol.asyncIterator]==="function";const ba=e=>e&&typeof e==="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody";const va=async e=>{if(!$a(e.body))return e;const t=await _a(e.body);return getMultipartRequestOptions(t,e)};const xa=async e=>{const t=await _a(e.body);return jo(t,e)};const _a=async e=>{const t=new Oo;await Promise.all(Object.entries(e||{}).map((([e,n])=>ka(t,e,n))));return t};const $a=e=>{if(da(e))return true;if(Array.isArray(e))return e.some($a);if(e&&typeof e==="object"){for(const t in e){if($a(e[t]))return true}}return false};const ka=async(e,t,n)=>{if(n===undefined)return;if(n==null){throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`)}if(typeof n==="string"||typeof n==="number"||typeof n==="boolean"){e.append(t,String(n))}else if(da(n)){const s=await ha(n);e.append(t,s)}else if(Array.isArray(n)){await Promise.all(n.map((n=>ka(e,t+"[]",n))))}else if(typeof n==="object"){await Promise.all(Object.entries(n).map((([n,s])=>ka(e,`${t}[${n}]`,s))))}else{throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Ea=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n};var Ca=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)};var Sa;async function Pa(e){const{response:t}=e;if(e.options.stream){rl("response",t.status,t.url,t.headers,t.body);return ra.fromSSEResponse(t,e.controller)}if(t.status===204){return null}if(e.options.__binaryResponse){return t}const n=t.headers.get("content-type");if(n?.includes("application/json")){const e=await t.json();rl("response",t.status,t.url,t.headers,e);return e}const s=await t.text();rl("response",t.status,t.url,t.headers,s);return s}class Aa extends Promise{constructor(e,t=Pa){super((e=>{e(null)}));this.responsePromise=e;this.parseResponse=t}_thenUnwrap(e){return new Aa(this.responsePromise,(async t=>e(await this.parseResponse(t))))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){if(!this.parsedPromise){this.parsedPromise=this.responsePromise.then(this.parseResponse)}return this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ra{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:s,fetch:r}){this.baseURL=e;this.maxRetries=za("maxRetries",t);this.timeout=za("timeout",n);this.httpAgent=s;this.fetch=r??Ro}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ua(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${il()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((n=>({method:e,path:t,...n}))))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e==="string"){if(typeof Buffer!=="undefined"){return Buffer.byteLength(e,"utf8").toString()}if(typeof TextEncoder!=="undefined"){const t=new TextEncoder;const n=t.encode(e);return n.length.toString()}}return null}buildRequest(e){const{method:t,path:n,query:s,headers:r={}}=e;const i=ba(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null;const o=this.calculateContentLength(i);const a=this.buildURL(n,s);if("timeout"in e)za("timeout",e.timeout);const l=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??Do(a);const u=l+1e3;if(typeof c?.options?.timeout==="number"&&u>(c.options.timeout??0)){c.options.timeout=u}if(this.idempotencyHeader&&t!=="get"){if(!e.idempotencyKey)e.idempotencyKey=this.defaultIdempotencyKey();r[this.idempotencyHeader]=e.idempotencyKey}const f={...o&&{"Content-Length":o},...this.defaultHeaders(e),...r};if(ba(e.body)&&Ao!=="node"){delete f["Content-Type"]}Object.keys(f).forEach((e=>f[e]===null&&delete f[e]));const d={method:t,...i&&{body:i},headers:f,...c&&{agent:c},signal:e.signal??null};this.validateHeaders(f,r);return{req:d,url:a,timeout:l}}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return!e?{}:Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}}makeStatusError(e,t,n,s){return zo.generate(e,t,n,s)}request(e,t=null){return new Aa(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e;if(t==null){t=n.maxRetries??this.maxRetries}const{req:s,url:r,timeout:i}=this.buildRequest(n);await this.prepareRequest(s,{url:r,options:n});rl("request",r,n,s.headers);if(n.signal?.aborted){throw new Vo}const o=new AbortController;const a=await this.fetchWithTimeout(r,s,i,o).catch(Va);if(a instanceof Error){if(n.signal?.aborted){throw new Vo}if(t){return this.retryRequest(n,t)}if(a.name==="AbortError"){throw new Ko}throw new Jo({cause:a})}const l=Ma(a.headers);if(!a.ok){if(t&&this.shouldRetry(a)){return this.retryRequest(n,t,l)}const e=await a.text().catch((e=>Va(e).message));const s=Ba(e);const i=s?undefined:e;rl("response",a.status,r,l,i);const o=this.makeStatusError(a.status,s,i,l);throw o}return{response:a,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Ia(this,n,e)}buildURL(e,t){const n=Wa(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e));const s=this.defaultQuery();if(!nl(s)){t={...s,...t}}if(t){n.search=this.stringifyQuery(t)}return n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>typeof t!=="undefined")).map((([e,t])=>{if(typeof t==="string"||typeof t==="number"||typeof t==="boolean"){return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`}if(t===null){return`${encodeURIComponent(e)}=`}throw new Xo(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,s){const{signal:r,...i}=t||{};if(r)r.addEventListener("abort",(()=>s.abort()));const o=setTimeout((()=>s.abort()),n);return this.getRequestClient().fetch.call(undefined,e,{signal:s.signal,...i}).finally((()=>{clearTimeout(o)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");if(t==="true")return true;if(t==="false")return false;if(e.status===408)return true;if(e.status===409)return true;if(e.status===429)return true;if(e.status>=500)return true;return false}async retryRequest(e,t,n){let s;const r=n?.["retry-after"];if(r){const e=parseInt(r);if(!Number.isNaN(e)){s=e*1e3}else{s=Date.parse(r)-Date.now()}}if(!s||!Number.isInteger(s)||s<=0||s>60*1e3){const n=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,n)}await Xa(s);return this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=.5;const s=8;const r=t-e;const i=Math.min(n*Math.pow(2,r),s);const o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${So}`}}class Fa{constructor(e,t,n,s){Sa.set(this,void 0);Ea(this,Sa,e,"f");this.options=s;this.response=t;this.body=n}hasNextPage(){const e=this.getPaginatedItems();if(!e.length)return false;return this.nextPageInfo()!=null}async getNextPage(){const e=this.nextPageInfo();if(!e){throw new Xo("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.")}const t={...this.options};if("params"in e){t.query={...t.query,...e.params}}else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,s]of n){e.url.searchParams.set(t,s)}t.query=undefined;t.path=e.url.toString()}return await Ca(this,Sa,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;yield e;while(e.hasNextPage()){e=await e.getNextPage();yield e}}async*[(Sa=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages()){for(const t of e.getPaginatedItems()){yield t}}}}class Ia extends Aa{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await Pa(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e){yield t}}}const Ma=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}});const Oa={method:true,path:true,query:true,body:true,headers:true,maxRetries:true,stream:true,timeout:true,httpAgent:true,signal:true,idempotencyKey:true,__binaryResponse:true};const Ta=e=>typeof e==="object"&&e!==null&&!nl(e)&&Object.keys(e).every((e=>sl(Oa,e)));const La=()=>{if(typeof Deno!=="undefined"&&Deno.build!=null){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":So,"X-Stainless-OS":Da(Deno.build.os),"X-Stainless-Arch":ja(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version}}if(typeof EdgeRuntime!=="undefined"){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":So,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version}}if(Object.prototype.toString.call(typeof process!=="undefined"?process:0)==="[object process]"){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":So,"X-Stainless-OS":Da(process.platform),"X-Stainless-Arch":ja(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version}}const e=Na();if(e){return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":So,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}}return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":So,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Na(){if(typeof navigator==="undefined"||!navigator){return null}const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0;const s=e[2]||0;const r=e[3]||0;return{browser:t,version:`${n}.${s}.${r}`}}}return null}const ja=e=>{if(e==="x32")return"x32";if(e==="x86_64"||e==="x64")return"x64";if(e==="arm")return"arm";if(e==="aarch64"||e==="arm64")return"arm64";if(e)return`other:${e}`;return"unknown"};const Da=e=>{e=e.toLowerCase();if(e.includes("ios"))return"iOS";if(e==="android")return"Android";if(e==="darwin")return"MacOS";if(e==="win32")return"Windows";if(e==="freebsd")return"FreeBSD";if(e==="openbsd")return"OpenBSD";if(e==="linux")return"Linux";if(e)return`Other:${e}`;return"Unknown"};let qa;const Ua=()=>qa??(qa=La());const Ba=e=>{try{return JSON.parse(e)}catch(e){return undefined}};const Ha=new RegExp("^(?:[a-z]+:)?//","i");const Wa=e=>Ha.test(e);const Xa=e=>new Promise((t=>setTimeout(t,e)));const za=(e,t)=>{if(typeof t!=="number"||!Number.isInteger(t)){throw new Xo(`${e} must be an integer`)}if(t<0){throw new Xo(`${e} must be a positive integer`)}return t};const Va=e=>{if(e instanceof Error)return e;return new Error(e)};const Ja=e=>{if(e==null)throw new OpenAIError(`Expected a value to be given but received ${e} instead.`);return e};const Ka=e=>{if(typeof process!=="undefined"){return"MISSING_ENV_VAR"?.[e]??undefined}if(typeof Deno!=="undefined"){return Deno.env?.get?.(e)}return undefined};const Ga=e=>{if(typeof e==="number")return Math.round(e);if(typeof e==="string")return parseInt(e,10);throw new OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};const Qa=e=>{if(typeof e==="number")return e;if(typeof e==="string")return parseFloat(e);throw new OpenAIError(`Could not coerce ${e} (type: ${typeof e}) into a number`)};const Ya=e=>{if(typeof e==="boolean")return e;if(typeof e==="string")return e==="true";return Boolean(e)};const Za=e=>{if(e===undefined){return undefined}return Ga(e)};const el=e=>{if(e===undefined){return undefined}return Qa(e)};const tl=e=>{if(e===undefined){return undefined}return Ya(e)};function nl(e){if(!e)return true;for(const t in e)return false;return true}function sl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function rl(e,...t){if(typeof process!=="undefined"&&"MISSING_ENV_VAR"["DEBUG"]==="true"){console.log(`OpenAI:DEBUG:${e}`,...t)}}const il=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.random()*16|0;const n=e==="x"?t:t&3|8;return n.toString(16)}));const ol=()=>typeof window!=="undefined"&&typeof window.document!=="undefined"&&typeof navigator!=="undefined";const al=e=>typeof e?.get==="function";const ll=(e,t)=>{const n=t.toLowerCase();if(al(e)){const s=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const r of[t,n,t.toUpperCase(),s]){const t=e.get(r);if(t){return t}}}for(const[s,r]of Object.entries(e)){if(s.toLowerCase()===n){if(Array.isArray(r)){if(r.length<=1)return r[0];console.warn(`Received ${r.length} entries for the ${t} header, using the first entry.`);return r[0]}return r}}throw new Error(`Could not find ${t} header`)};const cl=e=>{if(!e)return"";if(typeof Buffer!=="undefined"){return Buffer.from(e).toString("base64")}if(typeof btoa!=="undefined"){return btoa(e)}throw new OpenAIError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")};class ul extends Fa{constructor(e,t,n,s){super(e,t,n,s);this.data=n.data;this.object=n.object}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}class fl extends Fa{constructor(e,t,n,s){super(e,t,n,s);this.data=n.data}getPaginatedItems(){return this.data}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);if(!Object.keys(t).length)return null;return t}nextPageInfo(){if(!this.data?.length){return null}const e=this.data[this.data.length-1]?.id;if(!e)return null;return{params:{after:e}}}}class dl{constructor(e){this._client=e}}class hl extends dl{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??false})}}(function(e){})(hl||(hl={}));class pl extends dl{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??false})}}(function(e){})(pl||(pl={}));class ml extends dl{constructor(){super(...arguments);this.completions=new pl(this._client)}}(function(e){e.Completions=pl})(ml||(ml={}));class gl extends dl{create(e,t){return this._client.post("/edits",{body:e,...t})}}(function(e){})(gl||(gl={}));class yl extends dl{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}(function(e){})(yl||(yl={}));class wl extends dl{create(e,t){return this._client.post("/files",xa({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){if(Ta(e)){return this.list({},e)}return this._client.getAPIList("/files",bl,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:true})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]);const r=Date.now();let i=await this.retrieve(e);while(!i.status||!s.has(i.status)){await Xa(t);i=await this.retrieve(e);if(Date.now()-r>n){throw new Ko({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`})}}return i}}class bl extends ul{}(function(e){e.FileObjectsPage=bl})(wl||(wl={}));class vl extends dl{createVariation(e,t){return this._client.post("/images/variations",xa({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",xa({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}(function(e){})(vl||(vl={}));class xl extends dl{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:true})}}(function(e){})(xl||(xl={}));class _l extends dl{create(e,t){return this._client.post("/audio/transcriptions",xa({body:e,...t}))}}(function(e){})(_l||(_l={}));class $l extends dl{create(e,t){return this._client.post("/audio/translations",xa({body:e,...t}))}}(function(e){})($l||($l={}));class kl extends dl{constructor(){super(...arguments);this.transcriptions=new _l(this._client);this.translations=new $l(this._client);this.speech=new xl(this._client)}}(function(e){e.Transcriptions=_l;e.Translations=$l;e.Speech=xl})(kl||(kl={}));class El extends dl{create(e,t){return this._client.post("/moderations",{body:e,...t})}}(function(e){})(El||(El={}));class Cl extends dl{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Sl,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Sl extends ul{}(function(e){e.ModelsPage=Sl})(Cl||(Cl={}));class Pl extends dl{create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){if(Ta(e)){return this.list({},e)}return this._client.getAPIList("/fine_tuning/jobs",Al,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){if(Ta(t)){return this.listEvents(e,{},t)}return this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Rl,{query:t,...n})}}class Al extends fl{}class Rl extends fl{}(function(e){e.FineTuningJobsPage=Al;e.FineTuningJobEventsPage=Rl})(Pl||(Pl={}));class Fl extends dl{constructor(){super(...arguments);this.jobs=new Pl(this._client)}}(function(e){e.Jobs=Pl;e.FineTuningJobsPage=Al;e.FineTuningJobEventsPage=Rl})(Fl||(Fl={}));class Il extends dl{create(e,t){return this._client.post("/fine-tunes",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine-tunes/${e}`,t)}list(e){return this._client.getAPIList("/fine-tunes",Ml,e)}cancel(e,t){return this._client.post(`/fine-tunes/${e}/cancel`,t)}listEvents(e,t,n){return this._client.get(`/fine-tunes/${e}/events`,{query:t,timeout:864e5,...n,stream:t?.stream??false})}}class Ml extends ul{}(function(e){e.FineTunesPage=Ml})(Il||(Il={}));class Ol extends dl{create(e,t,n){return this._client.post(`/assistants/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/assistants/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e,t={},n){if(Ta(t)){return this.list(e,{},t)}return this._client.getAPIList(`/assistants/${e}/files`,Tl,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}del(e,t,n){return this._client.delete(`/assistants/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}class Tl extends fl{}(function(e){e.AssistantFilesPage=Tl})(Ol||(Ol={}));class Ll extends dl{constructor(){super(...arguments);this.files=new Ol(this._client)}create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e={},t){if(Ta(e)){return this.list({},e)}return this._client.getAPIList("/assistants",Nl,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}}class Nl extends fl{}(function(e){e.AssistantsPage=Nl;e.Files=Ol;e.AssistantFilesPage=Tl})(Ll||(Ll={}));function jl(e){return typeof e.parse==="function"}class Dl{constructor(e){this.function=e.function;this.parse=e.parse;this.parameters=e.parameters;this.description=e.description;this.name=e.name}}const ql=e=>e?.role==="assistant";const Ul=e=>e?.role==="function";const Bl=e=>e?.role==="tool";function Hl(e){return e!=null}var Wl=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n};var Xl=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)};var zl,Vl,Jl,Kl,Gl,Ql,Yl,Zl,ec,tc,nc,sc,rc,ic,oc,ac,lc,cc,uc,fc;const dc=10;class hc{constructor(){zl.add(this);this.controller=new AbortController;Vl.set(this,void 0);Jl.set(this,(()=>{}));Kl.set(this,(()=>{}));Gl.set(this,void 0);Ql.set(this,(()=>{}));Yl.set(this,(()=>{}));Zl.set(this,{});this._chatCompletions=[];this.messages=[];ec.set(this,false);tc.set(this,false);nc.set(this,false);sc.set(this,false);cc.set(this,(e=>{Wl(this,tc,true,"f");if(e instanceof Error&&e.name==="AbortError"){e=new Vo}if(e instanceof Vo){Wl(this,nc,true,"f");return this._emit("abort",e)}if(e instanceof Xo){return this._emit("error",e)}if(e instanceof Error){const t=new Xo(e.message);t.cause=e;return this._emit("error",t)}return this._emit("error",new Xo(String(e)))}));Wl(this,Vl,new Promise(((e,t)=>{Wl(this,Jl,e,"f");Wl(this,Kl,t,"f")})),"f");Wl(this,Gl,new Promise(((e,t)=>{Wl(this,Ql,e,"f");Wl(this,Yl,t,"f")})),"f");Xl(this,Vl,"f").catch((()=>{}));Xl(this,Gl,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal();this._emit("end")}),Xl(this,cc,"f"))}),0)}_addChatCompletion(e){this._chatCompletions.push(e);this._emit("chatCompletion",e);const t=e.choices[0]?.message;if(t)this._addMessage(t);return e}_addMessage(e,t=true){this.messages.push(e);if(t){this._emit("message",e);if((Ul(e)||Bl(e))&&e.content){this._emit("functionCallResult",e.content)}else if(ql(e)&&e.function_call){this._emit("functionCall",e.function_call)}else if(ql(e)&&e.tool_calls){for(const t of e.tool_calls){if(t.type==="function"){this._emit("functionCall",t.function)}}}}}_connected(){if(this.ended)return;Xl(this,Jl,"f").call(this);this._emit("connect")}get ended(){return Xl(this,ec,"f")}get errored(){return Xl(this,tc,"f")}get aborted(){return Xl(this,nc,"f")}abort(){this.controller.abort()}on(e,t){const n=Xl(this,Zl,"f")[e]||(Xl(this,Zl,"f")[e]=[]);n.push({listener:t});return this}off(e,t){const n=Xl(this,Zl,"f")[e];if(!n)return this;const s=n.findIndex((e=>e.listener===t));if(s>=0)n.splice(s,1);return this}once(e,t){const n=Xl(this,Zl,"f")[e]||(Xl(this,Zl,"f")[e]=[]);n.push({listener:t,once:true});return this}emitted(e){return new Promise(((t,n)=>{Wl(this,sc,true,"f");if(e!=="error")this.once("error",n);this.once(e,t)}))}async done(){Wl(this,sc,true,"f");await Xl(this,Gl,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Xo("stream ended without producing a ChatCompletion");return e}async finalContent(){await this.done();return Xl(this,zl,"m",rc).call(this)}async finalMessage(){await this.done();return Xl(this,zl,"m",ic).call(this)}async finalFunctionCall(){await this.done();return Xl(this,zl,"m",oc).call(this)}async finalFunctionCallResult(){await this.done();return Xl(this,zl,"m",ac).call(this)}async totalUsage(){await this.done();return Xl(this,zl,"m",lc).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...t){if(Xl(this,ec,"f"))return;if(e==="end"){Wl(this,ec,true,"f");Xl(this,Ql,"f").call(this)}const n=Xl(this,Zl,"f")[e];if(n){Xl(this,Zl,"f")[e]=n.filter((e=>!e.once));n.forEach((({listener:e})=>e(...t)))}if(e==="abort"){const e=t[0];if(!Xl(this,sc,"f")&&!n?.length){Promise.reject(e)}Xl(this,Kl,"f").call(this,e);Xl(this,Yl,"f").call(this,e);this._emit("end");return}if(e==="error"){const e=t[0];if(!Xl(this,sc,"f")&&!n?.length){Promise.reject(e)}Xl(this,Kl,"f").call(this,e);Xl(this,Yl,"f").call(this,e);this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];if(e)this._emit("finalChatCompletion",e);const t=this.messages[this.messages.length-1];if(t)this._emit("finalMessage",t);const n=Xl(this,zl,"m",rc).call(this);if(n)this._emit("finalContent",n);const s=Xl(this,zl,"m",oc).call(this);if(s)this._emit("finalFunctionCall",s);const r=Xl(this,zl,"m",ac).call(this);if(r!=null)this._emit("finalFunctionCallResult",r);if(this._chatCompletions.some((e=>e.usage))){this._emit("totalUsage",Xl(this,zl,"m",lc).call(this))}}async _createChatCompletion(e,t,n){const s=n?.signal;if(s){if(s.aborted)this.controller.abort();s.addEventListener("abort",(()=>this.controller.abort()))}Xl(this,zl,"m",uc).call(this,t);const r=await e.create({...t,stream:false},{...n,signal:this.controller.signal});this._connected();return this._addChatCompletion(r)}async _runChatCompletion(e,t,n){for(const e of t.messages){this._addMessage(e,false)}return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const s="function";const{function_call:r="auto",stream:i,...o}=t;const a=typeof r!=="string"&&r?.name;const{maxChatCompletions:l=dc}=n||{};const c={};for(const e of t.functions){c[e.name||e.function.name]=e}const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const e of t.messages){this._addMessage(e,false)}for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...o,function_call:r,functions:u,messages:[...this.messages]},n);const i=t.choices[0]?.message;if(!i){throw new Xo(`missing message in ChatCompletion response`)}if(!i.function_call)return;const{name:l,arguments:f}=i.function_call;const d=c[l];if(!d){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:s,name:l,content:e});continue}else if(a&&a!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,name:l,content:e});continue}let h;try{h=jl(d)?await d.parse(f):f}catch(e){this._addMessage({role:s,name:l,content:e instanceof Error?e.message:String(e)});continue}const p=await d.function(h,this);const m=Xl(this,zl,"m",fc).call(this,p);this._addMessage({role:s,name:l,content:m});if(a)return}}async _runTools(e,t,n){const s="tool";const{tool_choice:r="auto",stream:i,...o}=t;const a=typeof r!=="string"&&r?.function?.name;const{maxChatCompletions:l=dc}=n||{};const c={};for(const e of t.tools){if(e.type==="function"){c[e.function.name||e.function.function.name]=e.function}}const u="tools"in t?t.tools.map((e=>e.type==="function"?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description}}:e)):undefined;for(const e of t.messages){this._addMessage(e,false)}for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...o,tool_choice:r,tools:u,messages:[...this.messages]},n);const i=t.choices[0]?.message;if(!i){throw new Xo(`missing message in ChatCompletion response`)}if(!i.tool_calls)return;for(const e of i.tool_calls){if(e.type!=="function")continue;const t=e.id;const{name:n,arguments:r}=e.function;const i=c[n];if(!i){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${u.map((e=>JSON.stringify(e.function.name))).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:t,content:e});continue}else if(a&&a!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:s,tool_call_id:t,content:e});continue}let o;try{o=jl(i)?await i.parse(r):r}catch(e){const n=e instanceof Error?e.message:String(e);this._addMessage({role:s,tool_call_id:t,content:n});continue}const l=await i.function(o,this);const f=Xl(this,zl,"m",fc).call(this,l);this._addMessage({role:s,tool_call_id:t,content:f});if(a)return}}}}Vl=new WeakMap,Jl=new WeakMap,Kl=new WeakMap,Gl=new WeakMap,Ql=new WeakMap,Yl=new WeakMap,Zl=new WeakMap,ec=new WeakMap,tc=new WeakMap,nc=new WeakMap,sc=new WeakMap,cc=new WeakMap,zl=new WeakSet,rc=function e(){return Xl(this,zl,"m",ic).call(this).content},ic=function e(){let t=this.messages.length;while(t-- >0){const e=this.messages[t];if(ql(e)){return e}}throw new Xo("stream ended without producing a ChatCompletionMessage with role=assistant")},oc=function e(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(ql(t)&&t?.function_call){return t.function_call}}return},ac=function e(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Ul(t)&&t.content!=null){return t.content}}return},lc=function e(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions){if(e){t.completion_tokens+=e.completion_tokens;t.prompt_tokens+=e.prompt_tokens;t.total_tokens+=e.total_tokens}}return t},uc=function e(t){if(t.n!=null&&t.n>1){throw new Xo("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")}},fc=function e(t){return typeof t==="string"?t:t===undefined?"undefined":JSON.stringify(t)};class pc extends hc{static runFunctions(e,t,n){const s=new pc;s._run((()=>s._runFunctions(e,t,n)));return s}static runTools(e,t,n){const s=new pc;s._run((()=>s._runTools(e,t,n)));return s}_addMessage(e){super._addMessage(e);if(ql(e)&&e.content){this._emit("content",e.content)}}}var mc=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t==="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)};var gc=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t==="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n};var yc,wc,bc,vc,xc,_c;class $c extends hc{constructor(){super(...arguments);yc.add(this);wc.set(this,void 0)}get currentChatCompletionSnapshot(){return mc(this,wc,"f")}static fromReadableStream(e){const t=new $c;t._run((()=>t._fromReadableStream(e)));return t}static createChatCompletion(e,t,n){const s=new $c;s._run((()=>s._runChatCompletion(e,{...t,stream:true},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})));return s}async _createChatCompletion(e,t,n){const s=n?.signal;if(s){if(s.aborted)this.controller.abort();s.addEventListener("abort",(()=>this.controller.abort()))}mc(this,yc,"m",bc).call(this);const r=await e.create({...t,stream:true},{...n,signal:this.controller.signal});this._connected();for await(const e of r){mc(this,yc,"m",vc).call(this,e)}if(r.controller.signal?.aborted){throw new Vo}return this._addChatCompletion(mc(this,yc,"m",xc).call(this))}async _fromReadableStream(e,t){const n=t?.signal;if(n){if(n.aborted)this.controller.abort();n.addEventListener("abort",(()=>this.controller.abort()))}mc(this,yc,"m",bc).call(this);this._connected();const s=ra.fromReadableStream(e,this.controller);let r;for await(const e of s){if(r&&r!==e.id){this._addChatCompletion(mc(this,yc,"m",xc).call(this))}mc(this,yc,"m",vc).call(this,e);r=e.id}if(s.controller.signal?.aborted){throw new Vo}return this._addChatCompletion(mc(this,yc,"m",xc).call(this))}[(wc=new WeakMap,yc=new WeakSet,bc=function e(){if(this.ended)return;gc(this,wc,undefined,"f")},vc=function e(t){if(this.ended)return;const n=mc(this,yc,"m",_c).call(this,t);this._emit("chunk",t,n);const s=t.choices[0]?.delta?.content;const r=n.choices[0]?.message;if(s!=null&&r?.role==="assistant"&&r?.content){this._emit("content",s,r.content)}},xc=function e(){if(this.ended){throw new Xo(`stream has ended, this shouldn't happen`)}const t=mc(this,wc,"f");if(!t){throw new Xo(`request ended without sending any chunks`)}gc(this,wc,undefined,"f");return kc(t)},_c=function e(t){var n,s;let r=mc(this,wc,"f");const{choices:i,...o}=t;if(!r){r=gc(this,wc,{...o,choices:[]},"f")}else{Object.assign(r,o)}for(const{delta:e,finish_reason:i,index:o,...a}of t.choices){let t=r.choices[o];if(!t){r.choices[o]={finish_reason:i,index:o,message:e,...a};continue}if(i)t.finish_reason=i;Object.assign(t,a);if(!e)continue;const{content:l,function_call:c,role:u,tool_calls:f}=e;if(l)t.message.content=(t.message.content||"")+l;if(u)t.message.role=u;if(c){if(!t.message.function_call){t.message.function_call=c}else{if(c.name)t.message.function_call.name=c.name;if(c.arguments){(n=t.message.function_call).arguments??(n.arguments="");t.message.function_call.arguments+=c.arguments}}}if(f){if(!t.message.tool_calls)t.message.tool_calls=[];for(const{index:e,id:n,type:r,function:i}of f){const o=(s=t.message.tool_calls)[e]??(s[e]={});if(n)o.id=n;if(r)o.type=r;if(i)o.function??(o.function={arguments:""});if(i?.name)o.function.name=i.name;if(i?.arguments)o.function.arguments+=i.arguments}}}return r},Symbol.asyncIterator)](){const e=[];const t=[];let n=false;this.on("chunk",(n=>{const s=t.shift();if(s){s(n)}else{e.push(n)}}));this.on("end",(()=>{n=true;for(const e of t){e(undefined)}t.length=0}));return{next:async()=>{if(!e.length){if(n){return{value:undefined,done:true}}return new Promise((e=>t.push(e))).then((e=>e?{value:e,done:false}:{value:undefined,done:true}))}const s=e.shift();return{value:s,done:false}}}}toReadableStream(){const e=new ra(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}}function kc(e){const{id:t,choices:n,created:s,model:r}=e;return{id:t,choices:n.map((({message:t,finish_reason:n,index:s})=>{if(!n)throw new Xo(`missing finish_reason for choice ${s}`);const{content:r=null,function_call:i,tool_calls:o}=t;const a=t.role;if(!a)throw new Xo(`missing role for choice ${s}`);if(i){const{arguments:e,name:t}=i;if(e==null)throw new Xo(`missing function_call.arguments for choice ${s}`);if(!t)throw new Xo(`missing function_call.name for choice ${s}`);return{message:{content:r,function_call:{arguments:e,name:t},role:a},finish_reason:n,index:s}}if(o){return{index:s,finish_reason:n,message:{role:a,content:r,tool_calls:o.map(((t,n)=>{const{function:r,type:i,id:o}=t;const{arguments:a,name:l}=r||{};if(o==null)throw new Xo(`missing choices[${s}].tool_calls[${n}].id\n${Ec(e)}`);if(i==null)throw new Xo(`missing choices[${s}].tool_calls[${n}].type\n${Ec(e)}`);if(l==null)throw new Xo(`missing choices[${s}].tool_calls[${n}].function.name\n${Ec(e)}`);if(a==null)throw new Xo(`missing choices[${s}].tool_calls[${n}].function.arguments\n${Ec(e)}`);return{id:o,type:i,function:{name:l,arguments:a}}}))}}}return{message:{content:r,role:a},finish_reason:n,index:s}})),created:s,model:r,object:"chat.completion"}}function Ec(e){return JSON.stringify(e)}class Cc extends $c{static fromReadableStream(e){const t=new Cc;t._run((()=>t._fromReadableStream(e)));return t}static runFunctions(e,t,n){const s=new Cc;s._run((()=>s._runFunctions(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}})));return s}static runTools(e,t,n){const s=new Cc;s._run((()=>s._runTools(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}})));return s}}class Sc extends dl{runFunctions(e,t){if(e.stream){return Cc.runFunctions(this._client.chat.completions,e,t)}return pc.runFunctions(this._client.chat.completions,e,t)}runTools(e,t){if(e.stream){return Cc.runTools(this._client.chat.completions,e,t)}return pc.runTools(this._client.chat.completions,e,t)}stream(e,t){return $c.createChatCompletion(this._client.chat.completions,e,t)}}class Pc extends dl{constructor(){super(...arguments);this.completions=new Sc(this._client)}}(function(e){e.Completions=Sc})(Pc||(Pc={}));class Ac extends dl{retrieve(e,t,n,s){return this._client.get(`/threads/${e}/messages/${t}/files/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e,t,n={},s){if(Ta(n)){return this.list(e,t,{},n)}return this._client.getAPIList(`/threads/${e}/messages/${t}/files`,Rc,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}}class Rc extends fl{}(function(e){e.MessageFilesPage=Rc})(Ac||(Ac={}));class Fc extends dl{constructor(){super(...arguments);this.files=new Ac(this._client)}create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e,t={},n){if(Ta(t)){return this.list(e,{},t)}return this._client.getAPIList(`/threads/${e}/messages`,Ic,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}class Ic extends fl{}(function(e){e.ThreadMessagesPage=Ic;e.Files=Ac;e.MessageFilesPage=Rc})(Fc||(Fc={}));class Mc extends dl{retrieve(e,t,n,s){return this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e,t,n={},s){if(Ta(n)){return this.list(e,t,{},n)}return this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Oc,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}}class Oc extends fl{}(function(e){e.RunStepsPage=Oc})(Mc||(Mc={}));class Tc extends dl{constructor(){super(...arguments);this.steps=new Mc(this._client)}create(e,t,n){return this._client.post(`/threads/${e}/runs`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e,t={},n){if(Ta(t)){return this.list(e,{},t)}return this._client.getAPIList(`/threads/${e}/runs`,Lc,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}submitToolOutputs(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}}class Lc extends fl{}(function(e){e.RunsPage=Lc;e.Steps=Mc;e.RunStepsPage=Oc})(Tc||(Tc={}));class Nc extends dl{constructor(){super(...arguments);this.runs=new Tc(this._client);this.messages=new Fc(this._client)}create(e={},t){if(Ta(e)){return this.create({},e)}return this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}}(function(e){e.Runs=Tc;e.RunsPage=Lc;e.Messages=Fc;e.ThreadMessagesPage=Ic})(Nc||(Nc={}));class jc extends dl{constructor(){super(...arguments);this.chat=new Pc(this._client);this.assistants=new Ll(this._client);this.threads=new Nc(this._client)}}(function(e){e.Chat=Pc;e.Assistants=Ll;e.AssistantsPage=Nl;e.Threads=Nc})(jc||(jc={}));var Dc;class qc extends Ra{constructor({apiKey:e=Ka("OPENAI_API_KEY"),organization:t=Ka("OPENAI_ORG_ID")??null,...n}={}){if(e===undefined){throw new Xo("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).")}const s={apiKey:e,organization:t,...n,baseURL:n.baseURL??`https://api.openai.com/v1`};if(!s.dangerouslyAllowBrowser&&ol()){throw new Xo("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n")}super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch});this.completions=new hl(this);this.chat=new ml(this);this.edits=new gl(this);this.embeddings=new yl(this);this.files=new wl(this);this.images=new vl(this);this.audio=new kl(this);this.moderations=new El(this);this.models=new Cl(this);this.fineTuning=new Fl(this);this.fineTunes=new Il(this);this.beta=new jc(this);this._options=s;this.apiKey=e;this.organization=t}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Dc=qc;qc.OpenAI=Dc;qc.OpenAIError=Xo;qc.APIError=zo;qc.APIConnectionError=Jo;qc.APIConnectionTimeoutError=Ko;qc.APIUserAbortError=Vo;qc.NotFoundError=Zo;qc.ConflictError=ea;qc.RateLimitError=na;qc.BadRequestError=Go;qc.AuthenticationError=Qo;qc.InternalServerError=sa;qc.PermissionDeniedError=Yo;qc.UnprocessableEntityError=ta;const{OpenAIError:Uc,APIError:Bc,APIConnectionError:Hc,APIConnectionTimeoutError:Wc,APIUserAbortError:Xc,NotFoundError:zc,ConflictError:Vc,RateLimitError:Jc,BadRequestError:Kc,AuthenticationError:Gc,InternalServerError:Qc,PermissionDeniedError:Yc,UnprocessableEntityError:Zc}=t;var eu=ha;var tu=qo;(function(e){e.toFile=ha;e.fileFromPath=qo;e.Page=ul;e.CursorPage=fl;e.Completions=hl;e.Chat=ml;e.Edits=gl;e.Embeddings=yl;e.Files=wl;e.FileObjectsPage=bl;e.Images=vl;e.Audio=kl;e.Moderations=El;e.Models=Cl;e.ModelsPage=Sl;e.FineTuning=Fl;e.FineTunes=Il;e.FineTunesPage=Ml;e.Beta=jc})(qc||(qc={}));const nu=null&&qc;class su{static providers=[];static proxies=[];displayName;id;defaultConfig;messageRoles;models;runner;constructor(e,t,n,s,r,i){Object.assign(this,{id:e,displayName:t,runner:n,configGetter:s,messageRoles:r,models:i})}static init(){su.providers=[new su("","",iu,{},[],[]),new su("openai-text","OpenAI Text",ou,{key:"",url:"",model:"",stream:false},[],["gpt-3.5-turbo-instruct"]),new su("openai-chat","OpenAI Chat",au,{key:"",url:"",model:"",stream:false,rawUrl:false},["user","assistant","system"],["gpt-4-1106-preview","gpt-4-vision-preview","gpt-4","gpt-4-0314","gpt-4-0613","gpt-4-32k","gpt-4-32k-0314","gpt-4-32k-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-16k","gpt-3.5-turbo","gpt-3.5-turbo-0301","gpt-3.5-turbo-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-16k-0613","gemini-pro","mistral-medium"]),new su("azure-openai-chat","Azure OpenAI Chat",lu,{key:"",resource:"",deployment:"",apiVersion:"",stream:false},["user","assistant","system"],[]),new su("anthropic-text","Anthropic Text",cu,{key:"",url:"",model:"",stream:false},["human","assistant","system"],["claude-1.0","claude-1.2","claude-1.3","claude-1.3-100k","claude-instant-1.0","claude-instant-1.1","claude-instant-1.2","claude-instant-1-100k","claude-instant-1.1-100k","claude-2.0","claude-2.1","anthropic.claude-v1","anthropic.claude-v2","anthropic.claude-v2:1"]),new su("anthropic-messages","Anthropic Messages",uu,{key:"",url:"",model:"",stream:false},["user","assistant","system"],["claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307","anthropic.claude-v2","anthropic.claude-v2:1","anthropic.claude-3-sonnet-20240229-v1:0","anthropic.claude-3-haiku-20240307-v1:0","anthropic.claude-instant-v1"]),new su("natdev","Nat.dev",fu,{key:"",url:"",model:"",stream:false},[],["textgeneration:llama-65b","replicate:alpaca-7b","replicate:llama-13b","huggingface:bigscience/bloomz","openai:gpt-3.5-turbo","openai:gpt-4","openai:text-davinci-002",,"openai:text-davinci-003","anthropic:claude-instant-v1.0","anthropic:claude-v1.2"]),new su("steamship-plugin","SteamShip Plugin",du,{key:"",workspace:"",model:""},[],["gpt-3","gpt-4"]),new su("scale-spellbook","Scale Spellbook",hu,{key:"",url:""},[],[]),new su("scale-spellbook-fish","Scale Spellbook (Fish proxy)",pu,{key:"",url:""},[],[]),new su("chatbotkit","ChatBotKit",mu,{key:"",url:"",model:"",stream:false},["user","bot","context","instruction","backstory"],["gpt-4","gbt-3.5-turbo","text-davinci-003","text-davinci-002","text-algo-003","text-algo-002","text-algo-001"])];su.proxies=[new su("","Direct",yu,{}),new su("cors-anywhere","CORS Anywhere",wu,{url:""})]}createConfig(){return Object.assign({},{typeId:this.id,name:"Name"},this.defaultConfig)}static createConnection(e,t,n){if(e==null)return null;const s=su.getProvider(e.typeId);if(s.runner===iu)return null;const r=su.getProxy(t?.typeId);const i={maxTokens:Bs(n.maxTokens),temperature:Us(n.temperature),frequencyPenalty:Us(n.frequencyPenalty),presencePenalty:Us(n.presencePenalty)};return new s.runner(Object.assign(i,e),new r.runner(t))}static getProvider(e){return su.providers.filter((t=>t.id==e))[0]??su.providers[0]}static getProxy(e){return su.proxies.filter((t=>t.id==e))[0]??su.proxies[0]}static createDefaultProviderConfig(){return su.providers[0].createConfig()}static createDefaultProxyConfig(){return su.proxies[0].createConfig()}}class ru{config;proxy;onMessage;onLogMessage;onError;constructor(e,t){if(this.constructor===ru)throw new vu(this);Object.assign(this,{config:e,proxy:t})}async sendRequest(e){return{error:"Provider not implemented"}}async fetch(e,t){const n=await fetch(e,t);const s={};n.headers.forEach(((e,t)=>s[t]=e));console.log("Received HTTP response:",n,"headers:",s);return n}async handleJsonResponse(e,t){let n;try{n=await t.text()}catch(n){this.raiseError("Failed to decode message",n,e,t);return false}try{return await this.handleJson(JSON.parse(n),e,t)}catch(s){this.raiseError(n.length>4096?"Failed to parse message":n,s,e,t);return false}}async handleJson(e,t,n){throw new bu("handleJson")}raiseLogMessage(e){this.onLogMessage?.call(this,e)}raiseMessage(e){this.onMessage?.call(this,e);return true}raiseError(e,t,n,s){const r=s==null||s.ok?"":` (HTTP code: ${s.status}${` ${s.statusText}`.trim()})`;this.onError?.call(this,{text:`${e}${n.extraText}: ${t?.message}${r}`,error:t});return false}}class iu extends ru{async sendRequest(e){return{error:"Provider not set"}}}class ou extends ru{async sendRequest(e){const t=(e,t)=>{t.headers["Api-Key"]=this.config.key;return this.fetch(this.config.rawUrl?this.config.url:e,t)};const n=new qc({apiKey:this.config.key,baseURL:this.proxy.modifyUrl(this.config.url||"https://api.openai.com"),dangerouslyAllowBrowser:true,fetch:t});n.config=this.config;const s=e.messages.filter((e=>e.text?.length>0));const r={prompt:s.map((e=>`${e.text}\n\n`)).join(""),model:this.config.model,max_tokens:this.config.maxTokens,temperature:this.config.temperature,frequency_penalty:this.config.frequencyPenalty,presence_penalty:this.config.presencePenalty};let i=null;try{if(this.config.stream){const t=await n.completions.create({...r,stream:true});e.signal.addEventListener("abort",(()=>t.controller.abort()));for await(const e of t)this.raiseMessage({text:e.choices[0]?.text??"",role:"assistant",mode:"append"});return this.raiseMessage({text:"",role:"assistant",mode:"done"})}else{const e=await n.completions.create({...r,stream:false});return this.raiseMessage({text:e.choices[0]?.text??"",role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,i)}}}class au extends ru{async sendRequest(e){const t=(e,t)=>{if(this.config.key!="-")t.headers["Api-Key"]=this.config.key;else delete t.headers["Authorization"];return this.fetch(this.config.rawUrl?this.config.url:e,t)};const n=e=>(e||"").match(/system/i)?"system":(e||"").match(/user|human/i)?"user":"assistant";const s=new qc({apiKey:this.config.key,baseURL:this.proxy.modifyUrl(this.config.url||"https://api.openai.com"),dangerouslyAllowBrowser:true,fetch:t});s.config=this.config;const r=e.messages.filter((e=>e.text?.length>0));const i={messages:r.map((e=>({role:n(e.role),content:e.text}))),model:this.config.model,max_tokens:this.config.maxTokens,temperature:this.config.temperature,frequency_penalty:this.config.frequencyPenalty,presence_penalty:this.config.presencePenalty};let o=null;try{if(this.config.stream){const t=await s.chat.completions.create({...i,stream:true});e.signal.addEventListener("abort",(()=>t.controller.abort()));for await(const e of t)this.raiseMessage({text:e.choices[0]?.delta?.content??"",role:"assistant",mode:"append"});return this.raiseMessage({text:"",role:"assistant",mode:"done"})}else{const e=await s.chat.completions.create({...i,stream:false});return this.raiseMessage({text:e.choices[0]?.message?.content??"",role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,o)}}}class lu extends ru{async sendRequest(e){const t=e=>(e||"").match(/system/i)?"system":(e||"").match(/user|human/i)?"user":"assistant";const n=new AzureOpenAIClient(this.proxy.modifyUrl(`https://${this.config.resource}.openai.azure.com/`),new AzureKeyCredential(this.config.key),{apiVersion:this.config.apiVersion});const s=e.messages.filter((e=>e.text?.length>0)).map((e=>({role:t(e.role),content:e.text})));const r={maxTokens:this.config.maxTokens,temperature:this.config.temperature,frequencyPenalty:this.config.frequencyPenalty,presencePenalty:this.config.presencePenalty,abortSignal:e.signal};let i=null;try{if(this.config.stream){const t=await n.streamChatCompletions(this.config.deployment,s,r);e.signal.addEventListener("abort",(()=>t.cancel()));for await(const e of t)this.raiseMessage({text:e.choices[0]?.delta?.content??"",role:"assistant",mode:"append"});return this.raiseMessage({text:"",role:"assistant",mode:"done"})}else{const e=await n.getChatCompletions(this.config.deployment,s,r);return this.raiseMessage({text:e.choices[0]?.message?.content??"",role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,i)}}}class cu extends ru{async sendRequest(e){const t=e=>(e||"").match(/system/i)?"":(e||"").match(/user|human/i)?lo:co;const n=new ao({apiKey:this.config.key,baseURL:this.proxy.modifyUrl(this.config.url||"https://api.anthropic.com")});const s=e.messages.filter((e=>e.text?.length>0));const r={prompt:s.map((e=>`${t(e.role)}${e.text}`)).join("")+(t(s.at(-1)?.role)==co?"":co),model:this.config.model,max_tokens_to_sample:this.config.maxTokens,temperature:this.config.temperature,stop_sequences:[lo]};let i=null;try{if(this.config.stream){const t=await n.completions.create({...r,stream:true});i=t.response;e.signal.addEventListener("abort",(()=>t.controller.abort()));for await(const e of t)this.raiseMessage({text:e.completion,role:"assistant",mode:"append"});return this.raiseMessage({text:"",role:"assistant",mode:"done"})}else{const e=await n.completions.create({...r,stream:false});return this.raiseMessage({text:e.completion,role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,i)}}}class uu extends ru{async sendRequest(e){const t=e=>(e||"").match(/system/i)?"system":(e||"").match(/user|human/i)?"user":"assistant";const n=(e,t)=>this.fetch(e,t);const s=new ao({apiKey:this.config.key,baseURL:this.proxy.modifyUrl(this.config.url||"https://api.anthropic.com"),fetch:n});const r=e.messages.filter((e=>e.text?.length>0));const i={messages:r.filter((e=>t(e.role)!="system")).map((e=>({role:t(e.role),content:e.text.trimRight()}))),system:r.filter((e=>t(e.role)=="system")).map((e=>e.text)).join("\n").trim(),model:this.config.model,max_tokens:this.config.maxTokens,temperature:this.config.temperature};let o=null;try{if(this.config.stream){const t=await s.messages.create({...i,stream:true}).withResponse();o=t.response;e.signal.addEventListener("abort",(()=>t.data.controller.abort()));for await(const e of t.data){switch(e.type){case"content_block_delta":this.raiseMessage({text:e?.delta?.text??"",role:"assistant",mode:"append"});break;case"message_start":this.raiseLogMessage({text:`Message sent (input: ${e.usage?.input_tokens} tokens)`,data:[e]});break;case"message_stop":this.raiseLogMessage({text:`Message received (input: ${e.inputTokenCount} tokens, output: ${e.outputTokenCount})`,data:[e]});break;default:this.raiseLogMessage({text:`Event ${e.type}`,data:[e]});break}console.log("event",e)}return this.raiseMessage({text:"",role:"assistant",mode:"done"})}else{const e=await s.messages.create({...i,stream:false}).withResponse();o=e.response;return this.raiseMessage({text:e.data.content,role:"assistant",mode:"complete"})}}catch(t){return this.raiseError("Query failed",t,e,o)}}}class fu extends ru{constructor(e,t){super(e,t)}async sendRequest(e){let t,n;console.log(this);t=await this.fetch(this.proxy.modifyUrl("https://clerk.nat.dev/v1/client?_clerk_js_version=4.35.0"),{method:"GET",credentials:"include",headers:{Origin:"https://nat.dev",Referer:"https://nat.dev/"},signal:e.signal});console.log(await t.json());console.log("All models",n)}async sendAsyncApi(e){const t=1e4;if(this.pusher!=null)return;const n={key:"a9198d6754ae6285290b",cluster:"mt1"};const s=new URLSearchParams({protocol:7,client:"js",version:"8.0.1"});let r=null;this.pusher=new WebSocket(`wss://ws-${n.cluster}.pusher.com/app/${n.key}?${s}`);this.pusher.addEventListener("message",(t=>{if(e.signal.aborted){this.pusher.close();return}const n=JSON.parse(t.data);const s=typeof n.data==="string"?JSON.parse(n.data):null;console.log("Pusher message",n,"data",s);switch(n.event){case"pusher:connection_established":r?.call();break;case"batchTokensBegin":console.log("Pusher begin tokens",n.channel);break;case"batchTokensAvailable":const e=s.tokens.join("");console.log("Pusher tokens",n.channel,e);this.raiseMessage({text:e,role:"bot",mode:"append"});break;case"batchTokensEnd":console.log("Pusher end tokens",n.channel,s.messageId);this.pusher.close();break}}));this.pusher.addEventListener("error",(t=>{this.raiseError("Pusher error",new Error(`${t}`),e,null)}));console.log(this.pusher);await Promise.race([qs(t),new Promise((e=>{r=e}))])}async callApi(e,t,n,s){const r=this.config.url||"https://nat.dev/api/";const i=await this.fetch(this.proxy.modifyUrl(new URL(n,r).toString()),{method:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.key}`,Origin:"https://nat.dev",Referer:"https://nat.dev/"},body:t=="POST"&&s!=null?JSON.stringify(s):null,signal:e.signal});const o=await this.handleJsonResponse(e,i);return[i,o]}async handleJson(e,t,n){return e}}class du extends ru{async sendRequest(e){const t=2e3;const n=e.messages.filter((e=>e.text?.length>0));let[s,r]=await this.callApi(e,"plugin/instance/generate",{appendOutputToFile:false,text:n.map((e=>e.text)).join("\n"),pluginInstance:this.config.workspace});if(r===false)return false;console.log("SteamShip init",r);const i=r?.status?.taskId;if(i==null)return this.raiseError("Failed to generate",new Error("No task id"),e,s);else this.raiseLogMessage({text:"Sending message (done: generate)"});let o="";while(true){[s,r]=await this.callApi(e,"task/status",{taskId:i});if(r===false)return;console.log("SteamShip poll",r.status.state,r);if(r.data!=null){const e=r.data.blocks[0];return this.raiseMessage({text:e.text,role:e.tags.filter((e=>e.kind=="role"))[0]?.name??"assistant",mode:"complete"})}if(o!=r.status.state){o=r.status.state;this.raiseLogMessage({text:`Sending message (${o})`})}await Ds(t)}}async callApi(e,t,n){const s=this.config.url||"https://api.steamship.com/api/v1/";const r=await this.fetch(this.proxy.modifyUrl(new URL(t,s).toString()),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.key}`,"X-Workspace-Handle":this.config.workspace},body:JSON.stringify(n),signal:e.signal});const i=await this.handleJsonResponse(e,r);return[r,i]}async handleJson(e,t,n){if(e?.status?.state=="failed"){const{statusCode:s,statusMessage:r}=e.status;const i=`${s!=null?`${s}: `:""}${r}`;return this.raiseError("Received error message",new Error(i),t,n)}return e}}class hu extends ru{async sendRequest(e){let t=e.messages.map((e=>e.text)).join("\n");let n=await this.getResponse(e,t);return await this.handleJsonResponse(e,n)}async getResponse(e,t){return await this.fetch(this.proxy.modifyUrl(this.config.url),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+this.config.key},body:JSON.stringify({input:{input:t}}),signal:e.signal})}async handleJson(e,t,n){if(e.output==null||e.message!=null)return this.raiseError("Received error message",new Error(e.message||"Unknown"),t,n);else return this.raiseMessage({text:e.output,role:"",mode:"complete"})}}class pu extends ru{pusher;async getResponse(e,t){return await this.fetch(`https://fishtailprotocol.com/projects/betterGPT4/scale-api.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({OAIToken:this.config.key,scaleURL:this.config.url,chatLog:t}),signal:e.signal})}async handleJson(e,t,n){return super.handleJson(e.response,t,n)}}class mu extends ru{static baseApiUrl="https://api.chatbotkit.com/v1/";async sendRequest(e){const t={assistant:"bot",system:"backstory"};const n=e=>e=="backstory"||e=="system";let s,r;const i=e.messages.filter((e=>e.text?.length>0));const o=i.filter((e=>!n(e.role)));const a=i.filter((e=>n(e.role)));const l=o.slice(0,-1);[s,r]=await this.callApi(e,"conversation/create",{backstory:a.map((e=>e.text)).join("\n"),model:this.config.model,datasetId:"",skillsetId:"",messages:l.map((e=>({type:t[e.role]||e.role||"user",text:e.text})))});if(r===false)return false;const c=r.id;let u=null;try{const t=o.slice(-1)[0];[s,r]=await this.callApi(e,`conversation/${c}/send`,{text:t.text,entities:[]});if(r===false)return false;if(this.config.stream){try{await this.connectToPusher(e)}catch(t){this.raiseError("Failed to receive message",t,e,null);return false}const t=Hs();this.pusher.send(JSON.stringify({event:"pusher:subscribe",data:{auto:"",channel:t}}));[s,r]=await this.callApi(e,`conversation/${c}/receive`,{parse:false,channel:t});u={text:"",role:"bot",mode:"done"}}else{[s,r]=await this.callApi(e,`conversation/${c}/receive`,{parse:false});if(r===false)return false;u={role:"bot",text:r.text,mode:"complete"}}}finally{try{[s,r]=await this.callApi(e,`conversation/${c}/delete`,{},false)}finally{if(u!=null)this.raiseMessage(u)}}return true}async connectToPusher(e){const t=1e4;if(this.pusher!=null)return;const n={key:"a9198d6754ae6285290b",cluster:"mt1"};const s=new URLSearchParams({protocol:7,client:"js",version:"8.0.1"});let r=null;this.pusher=new WebSocket(`wss://ws-${n.cluster}.pusher.com/app/${n.key}?${s}`);this.pusher.addEventListener("message",(t=>{if(e.signal.aborted){this.pusher.close();return}const n=JSON.parse(t.data);const s=typeof n.data==="string"?JSON.parse(n.data):null;console.log("Pusher message",n,"data",s);switch(n.event){case"pusher:connection_established":r?.call();break;case"batchTokensBegin":console.log("Pusher begin tokens",n.channel);break;case"batchTokensAvailable":const e=s.tokens.join("");console.log("Pusher tokens",n.channel,e);this.raiseMessage({text:e,role:"bot",mode:"append"});break;case"batchTokensEnd":console.log("Pusher end tokens",n.channel,s.messageId);this.pusher.close();break}}));this.pusher.addEventListener("error",(t=>{this.raiseError("Pusher error",new Error(`${t}`),e,null)}));console.log(this.pusher);await Promise.race([qs(t),new Promise((e=>{r=e}))])}async callApi(e,t,n,s=true){const r=this.config.url||mu.baseApiUrl;const i=await this.fetch(this.proxy.modifyUrl(new URL(t,r).toString()),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.key}`},body:JSON.stringify(n),signal:e.signal});const o=t.replace(/\/(.*\/)?/," - ");const a=await this.handleJsonResponse(e,i);if(a!==false&&s)this.raiseLogMessage({text:`Sending message (done: ${o})`,data:[a]});return[i,a]}async handleJson(e,t,n){if(e.message!=null)return this.raiseError("Received error message",new Error(`${e.code}: ${e.message}`),t,n);return e}}class gu{config;constructor(e){if(this.constructor===gu)throw new vu(this);Object.assign(this,{config:e})}modifyUrl(e){return e}}class yu extends gu{}class wu extends gu{modifyUrl(e){return(this.config.url||"https://cors-anywhere.herokuapp.com/")+e}}class bu extends Error{constructor(e){super(`Method ${e} not impleented`)}}class vu extends Error{constructor(e){super(`Can not instantiate abstract class ${e.constructor.name}`)}}var xu=n(282);var _u=n(634);var $u=n(232);var ku=n(362);var Eu=n(338);var Cu=n(199);var Su=n(742);var Pu=n(505);var Au=n(494);var Ru=n(55);var Fu=n(221);var Iu=n(948);const{window:Mu}=z;function Ou(e,t,n){const s=e.slice();s[94]=t[n];return s}function Tu(e,t,n){const s=e.slice();s[97]=t[n];return s}function Lu(e,t,n){const s=e.slice();s[100]=t[n];return s}function Nu(e,t,n){const s=e.slice();s[103]=t[n];s[104]=t;s[105]=n;return s}function ju(e,t,n){const s=e.slice();s[106]=t[n];s[107]=t;s[108]=n;return s}function Du(e,t,n){const s=e.slice();s[106]=t[n];return s}function qu(e,t,n){const s=e.slice();s[111]=t[n];s[112]=t;s[113]=n;return s}function Uu(e,t,n){const s=e.slice();s[94]=t[n];return s}function Bu(e){let t;let n=e[94].displayName+"";let r;let i;return{c(){t=ce("option");r=he(n);t.__value=i=e[94].id;t.value=t.__value;$e(t,"class","a")},m(e,n){ie(e,t,n);Z(t,r)},p:s,d(e){if(e)ae(t)}}}function Hu(e){return{c:s,m:s,p:s,d:s}}function Wu(e){let t;let n;let s;let r;function i(e,t){if(e[94].id=="openai-text"||e[94].id=="openai-chat"||e[94].id=="chatbotkit"||e[94].id=="anthropic-text"||e[94].id=="anthropic-messages"||e[94].id=="natdev")return Ku;if(e[94].id=="azure-openai-chat")return Ju;if(e[94].id=="steamship-plugin")return Vu;if(e[94].id=="scale-spellbook"||e[94].id=="scale-spellbook-fish")return zu;return Xu}let o=i(e,[-1,-1,-1,-1]);let a=o(e);let l=e[94].models.length>0&&Gu(e);let c=e[94].id=="openai-chat"&&Qu(e);let u=(e[94].id=="openai-text"||e[94].id=="openai-chat"||e[94].id=="azure-openai-chat"||e[94].id=="chatbotkit"||e[94].id=="anthropic-text"||e[94].id=="anthropic-messages")&&Yu(e);return{c(){a.c();t=pe();if(l)l.c();n=pe();if(c)c.c();s=pe();if(u)u.c();r=me()},m(e,i){a.m(e,i);ie(e,t,i);if(l)l.m(e,i);ie(e,n,i);if(c)c.m(e,i);ie(e,s,i);if(u)u.m(e,i);ie(e,r,i)},p(e,f){if(o===(o=i(e,f))&&a){a.p(e,f)}else{a.d(1);a=o(e);if(a){a.c();a.m(t.parentNode,t)}}if(e[94].models.length>0){if(l){l.p(e,f)}else{l=Gu(e);l.c();l.m(n.parentNode,n)}}else if(l){l.d(1);l=null}if(e[94].id=="openai-chat"){if(c){c.p(e,f)}else{c=Qu(e);c.c();c.m(s.parentNode,s)}}else if(c){c.d(1);c=null}if(e[94].id=="openai-text"||e[94].id=="openai-chat"||e[94].id=="azure-openai-chat"||e[94].id=="chatbotkit"||e[94].id=="anthropic-text"||e[94].id=="anthropic-messages"){if(u){u.p(e,f)}else{u=Yu(e);u.c();u.m(r.parentNode,r)}}else if(u){u.d(1);u=null}},d(e){a.d(e);if(e)ae(t);if(l)l.d(e);if(e)ae(n);if(c)c.d(e);if(e)ae(s);if(u)u.d(e);if(e)ae(r)}}}function Xu(e){let t;return{c(){t=ce("b");t.textContent="Choose endpoint provider";$e(t,"class","a")},m(e,n){ie(e,t,n)},p:s,d(e){if(e)ae(t)}}}function zu(e){let t;let n;let s;let r;let i;let o;let a;let l;let c;let f;let d;function h(){e[43].call(r,e[112],e[113])}function p(){e[44].call(c,e[112],e[113])}return{c(){t=ce("label");n=ce("b");n.textContent="Deployment key";s=pe();r=ce("input");i=pe();o=ce("label");a=ce("b");a.textContent="Deployment URL";l=pe();c=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","Deployment key");$e(r,"class","a");$e(t,"class","over a");$e(a,"class","a");$e(c,"type","text");$e(c,"placeholder","Deployment URL");$e(c,"class","a");$e(o,"class","over a")},m(u,m){ie(u,t,m);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[111].key);ie(u,i,m);ie(u,o,m);Z(o,a);Z(o,l);Z(o,c);Ge(c,e[111].url);if(!f){d=[ye(r,"input",h),ye(c,"input",p)];f=true}},p(t,n){e=t;if(n[0]&2&&r.value!==e[111].key){Ge(r,e[111].key)}if(n[0]&2&&c.value!==e[111].url){Ge(c,e[111].url)}},d(e){if(e)ae(t);if(e)ae(i);if(e)ae(o);f=false;u(d)}}}function Vu(e){let t;let n;let s;let r;let i;let o;let a;let l;let c;let f;let d;function h(){e[41].call(r,e[112],e[113])}function p(){e[42].call(c,e[112],e[113])}return{c(){t=ce("label");n=ce("b");n.textContent="API key";s=pe();r=ce("input");i=pe();o=ce("label");a=ce("b");a.textContent="Workspace";l=pe();c=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","API key");$e(r,"class","a");$e(t,"class","over a");$e(a,"class","a");$e(c,"type","text");$e(c,"placeholder","Workspace");$e(c,"class","a");$e(o,"class","over a")},m(u,m){ie(u,t,m);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[111].key);ie(u,i,m);ie(u,o,m);Z(o,a);Z(o,l);Z(o,c);Ge(c,e[111].workspace);if(!f){d=[ye(r,"input",h),ye(c,"input",p)];f=true}},p(t,n){e=t;if(n[0]&2&&r.value!==e[111].key){Ge(r,e[111].key)}if(n[0]&2&&c.value!==e[111].workspace){Ge(c,e[111].workspace)}},d(e){if(e)ae(t);if(e)ae(i);if(e)ae(o);f=false;u(d)}}}function Ju(e){let t;let n;let s;let r;let i;let o;let a;let l;let c;let f;let d;let h;let p;let m;let g;let y;let w;let b;let v;let x;let _;function $(){e[37].call(r,e[112],e[113])}function k(){e[38].call(c,e[112],e[113])}function E(){e[39].call(m,e[112],e[113])}function C(){e[40].call(v,e[112],e[113])}return{c(){t=ce("label");n=ce("b");n.textContent="API key";s=pe();r=ce("input");i=pe();o=ce("label");a=ce("b");a.textContent="API Version";l=pe();c=ce("input");f=pe();d=ce("label");h=ce("b");h.textContent="Resource";p=pe();m=ce("input");g=pe();y=ce("label");w=ce("b");w.textContent="Deployment";b=pe();v=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","API key");$e(r,"class","a");$e(t,"class","over a");$e(a,"class","a");$e(c,"type","text");$e(c,"placeholder","API Version");$e(c,"class","a");$e(o,"class","over a");$e(h,"class","a");$e(m,"type","text");$e(m,"placeholder","Resource");$e(m,"class","a");$e(d,"class","over a");$e(w,"class","a");$e(v,"type","text");$e(v,"placeholder","Deployment");$e(v,"class","a");$e(y,"class","over a")},m(u,S){ie(u,t,S);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[111].key);ie(u,i,S);ie(u,o,S);Z(o,a);Z(o,l);Z(o,c);Ge(c,e[111].apiVersion);ie(u,f,S);ie(u,d,S);Z(d,h);Z(d,p);Z(d,m);Ge(m,e[111].resource);ie(u,g,S);ie(u,y,S);Z(y,w);Z(y,b);Z(y,v);Ge(v,e[111].deployment);if(!x){_=[ye(r,"input",$),ye(c,"input",k),ye(m,"input",E),ye(v,"input",C)];x=true}},p(t,n){e=t;if(n[0]&2&&r.value!==e[111].key){Ge(r,e[111].key)}if(n[0]&2&&c.value!==e[111].apiVersion){Ge(c,e[111].apiVersion)}if(n[0]&2&&m.value!==e[111].resource){Ge(m,e[111].resource)}if(n[0]&2&&v.value!==e[111].deployment){Ge(v,e[111].deployment)}},d(e){if(e)ae(t);if(e)ae(i);if(e)ae(o);if(e)ae(f);if(e)ae(d);if(e)ae(g);if(e)ae(y);x=false;u(_)}}}function Ku(e){let t;let n;let s;let r;let i;let o;let a;let l;let c;let f;let d;function h(){e[35].call(r,e[112],e[113])}function p(){e[36].call(c,e[112],e[113])}return{c(){t=ce("label");n=ce("b");n.textContent="API key";s=pe();r=ce("input");i=pe();o=ce("label");a=ce("b");a.textContent="Base URL";l=pe();c=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","API key");$e(r,"class","a");$e(t,"class","over a");$e(a,"class","a");$e(c,"type","text");$e(c,"placeholder","Base URL");$e(c,"class","a");$e(o,"class","over a")},m(u,m){ie(u,t,m);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[111].key);ie(u,i,m);ie(u,o,m);Z(o,a);Z(o,l);Z(o,c);Ge(c,e[111].url);if(!f){d=[ye(r,"input",h),ye(c,"input",p)];f=true}},p(t,n){e=t;if(n[0]&2&&r.value!==e[111].key){Ge(r,e[111].key)}if(n[0]&2&&c.value!==e[111].url){Ge(c,e[111].url)}},d(e){if(e)ae(t);if(e)ae(i);if(e)ae(o);f=false;u(d)}}}function Gu(e){let t;let n;let s;let r;let i;let o;let a;function l(){e[45].call(r,e[112],e[113])}return{c(){t=ce("label");n=ce("b");n.textContent="Model name";s=pe();r=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","Model name");$e(r,"list",i=""+(e[94].id+"-models"));$e(r,"class","a");$e(t,"class","over a")},m(i,c){ie(i,t,c);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[111].model);if(!o){a=ye(r,"input",l);o=true}},p(t,n){e=t;if(n[0]&2&&i!==(i=""+(e[94].id+"-models"))){$e(r,"list",i)}if(n[0]&2&&r.value!==e[111].model){Ge(r,e[111].model)}},d(e){if(e)ae(t);o=false;a()}}}function Qu(e){let t;let n;let s;let r;let i;let o;function a(){e[46].call(n,e[112],e[113])}return{c(){t=ce("label");n=ce("input");s=pe();r=ce("b");r.textContent="Raw URL";$e(n,"type","checkbox");$e(n,"class","a");$e(r,"class","a");$e(t,"class","side a")},m(l,c){ie(l,t,c);Z(t,n);n.checked=e[111].rawUrl;Z(t,s);Z(t,r);if(!i){o=ye(n,"change",a);i=true}},p(t,s){e=t;if(s[0]&2){n.checked=e[111].rawUrl}},d(e){if(e)ae(t);i=false;o()}}}function Yu(e){let t;let n;let s;let r;let i;let o;function a(){e[47].call(n,e[112],e[113])}return{c(){t=ce("label");n=ce("input");s=pe();r=ce("b");r.textContent="Stream";$e(n,"type","checkbox");$e(n,"class","a");$e(r,"class","a");$e(t,"class","side a")},m(l,c){ie(l,t,c);Z(t,n);n.checked=e[111].stream;Z(t,s);Z(t,r);if(!i){o=ye(n,"change",a);i=true}},p(t,s){e=t;if(s[0]&2){n.checked=e[111].stream}},d(e){if(e)ae(t);i=false;o()}}}function Zu(e){return{c:s,m:s,p:s,d:s}}function ef(e){let t;let n;let s;let r;let o;let a;let l;let c;let f;let d;let h;let p;let m;let g;let y;let w;let b;let v;let x;let _;let $;let k;let E;let C;let S;let P;let A;function R(){e[33].call(f,e[112],e[113])}let F=su.providers;let I=[];for(let t=0;t<F.length;t+=1){I[t]=Bu(Uu(e,F,t))}function M(){e[34].call(g,e[112],e[113])}let O={ctx:e,current:null,token:null,hasCatch:false,pending:Zu,then:Wu,catch:Hu,value:94};yn(w=su.getProvider(e[111].typeId),O);const T=[{icon:Ru.M6},e[4]];let L={};for(let e=0;e<T.length;e+=1){L=i(L,T[e])}_=new js({props:L});function N(){return e[48](e[113])}const j=[{icon:Iu.FG},e[4]];let D={};for(let e=0;e<j.length;e+=1){D=i(D,j[e])}E=new js({props:D});function q(){return e[49](e[113])}S=Ie(e[32][1]);return{c(){t=ce("div");n=ce("label");s=ce("input");o=pe();a=ce("label");l=ce("b");l.textContent="Display name";c=pe();f=ce("input");d=pe();h=ce("label");p=ce("b");p.textContent="Provider";m=pe();g=ce("select");for(let e=0;e<I.length;e+=1){I[e].c()}y=pe();O.block.c();b=pe();v=ce("div");x=ce("button");Gn(_.$$.fragment);$=pe();k=ce("button");Gn(E.$$.fragment);$e(s,"type","radio");$e(s,"name","selectedEndpoint");s.__value=r=e[113];s.value=s.__value;$e(s,"title","Set endpoint as current");$e(s,"class","a");$e(n,"class","side a");$e(l,"class","a");$e(f,"type","text");$e(f,"placeholder","Display name");$e(f,"class","a");$e(a,"class","over a");$e(p,"class","a");$e(g,"placeholder","Provider");$e(g,"class","a");if(e[111].typeId===void 0)Gt(M);$e(h,"class","over a");$e(x,"type","button");$e(x,"title","Share endpoint link");$e(x,"class","a");$e(k,"type","button");$e(k,"title","Delete endpoint");$e(k,"class","a");$e(v,"class","buttons a");$e(t,"class","endpoint a");S.p(s)},m(r,i){ie(r,t,i);Z(t,n);Z(n,s);s.checked=s.__value===e[0].selectedEndpointIndex;Z(t,o);Z(t,a);Z(a,l);Z(a,c);Z(a,f);Ge(f,e[111].name);Z(t,d);Z(t,h);Z(h,p);Z(h,m);Z(h,g);for(let e=0;e<I.length;e+=1){if(I[e]){I[e].m(g,null)}}Ze(g,e[111].typeId,true);Z(t,y);O.block.m(t,O.anchor=null);O.mount=()=>t;O.anchor=b;Z(t,b);Z(t,v);Z(v,x);Yn(_,x,null);Z(v,$);Z(v,k);Yn(E,k,null);C=true;if(!P){A=[ye(s,"change",e[31]),ye(f,"input",R),ye(g,"change",M),ye(x,"click",N),ye(k,"click",q)];P=true}},p(t,n){e=t;if(n[0]&3){s.checked=s.__value===e[0].selectedEndpointIndex}if(n[0]&2&&f.value!==e[111].name){Ge(f,e[111].name)}if(n&0){F=su.providers;let t;for(t=0;t<F.length;t+=1){const s=Uu(e,F,t);if(I[t]){I[t].p(s,n)}else{I[t]=Bu(s);I[t].c();I[t].m(g,null)}}for(;t<I.length;t+=1){I[t].d(1)}I.length=F.length}if(n[0]&2){Ze(g,e[111].typeId)}O.ctx=e;if(n[0]&2&&w!==(w=su.getProvider(e[111].typeId))&&yn(w,O)){}else{wn(O,e,n)}const r=n[0]&16?En(T,[n&0&&{icon:Ru.M6},n[0]&16&&Cn(e[4])]):{};_.$set(r);const i=n[0]&16?En(j,[n&0&&{icon:Iu.FG},n[0]&16&&Cn(e[4])]):{};E.$set(i)},i(e){if(C)return;fn(_.$$.fragment,e);fn(E.$$.fragment,e);C=true},o(e){dn(_.$$.fragment,e);dn(E.$$.fragment,e);C=false},d(e){if(e)ae(t);le(I,e);O.block.d();O.token=null;O=null;Zn(_);Zn(E);S.r();P=false;u(A)}}}function tf(e){let t;let n=e[106].displayName+"";let r;let i;return{c(){t=ce("option");r=he(n);t.__value=i=e[106].id;t.value=t.__value;$e(t,"class","a")},m(e,n){ie(e,t,n);Z(t,r)},p:s,d(e){if(e)ae(t)}}}function nf(e){return{c:s,m:s,p:s,d:s}}function sf(e){let t;function n(e,t){if(e[94].id=="cors-anywhere")return of;if(e[94].id!="")return rf}let s=n(e,[-1,-1,-1,-1]);let r=s&&s(e);return{c(){if(r)r.c();t=me()},m(e,n){if(r)r.m(e,n);ie(e,t,n)},p(e,i){if(s===(s=n(e,i))&&r){r.p(e,i)}else{if(r)r.d(1);r=s&&s(e);if(r){r.c();r.m(t.parentNode,t)}}},d(e){if(r){r.d(e)}if(e)ae(t)}}}function rf(e){let t;return{c(){t=ce("b");t.textContent="Choose proxy provider";$e(t,"class","a")},m(e,n){ie(e,t,n)},p:s,d(e){if(e)ae(t)}}}function of(e){let t;let n;let s;let r;let i;let o;function a(){e[53].call(r,e[107],e[108])}return{c(){t=ce("label");n=ce("b");n.textContent="Proxy URL";s=pe();r=ce("input");$e(n,"class","a");$e(r,"type","text");$e(r,"placeholder","Proxy URL");$e(r,"class","a");$e(t,"class","over a")},m(l,c){ie(l,t,c);Z(t,n);Z(t,s);Z(t,r);Ge(r,e[106].url);if(!i){o=ye(r,"input",a);i=true}},p(t,n){e=t;if(n[0]&4&&r.value!==e[106].url){Ge(r,e[106].url)}},d(e){if(e)ae(t);i=false;o()}}}function af(e){return{c:s,m:s,p:s,d:s}}function lf(e){let t;let n;let s;let r;let o;let a;let l;let c;let f;let d;let h;let p;let m;let g;let y;let w;let b;let v;let x;let _;let $;let k;let E;function C(){e[51].call(c,e[107],e[108])}let S=su.proxies;let P=[];for(let t=0;t<S.length;t+=1){P[t]=tf(Du(e,S,t))}function A(){e[52].call(m,e[107],e[108])}let R={ctx:e,current:null,token:null,hasCatch:false,pending:af,then:sf,catch:nf,value:94};yn(y=su.getProxy(e[106].typeId),R);const F=[{icon:Iu.FG},e[4]];let I={};for(let e=0;e<F.length;e+=1){I=i(I,F[e])}x=new js({props:I});function M(){return e[54](e[108])}$=Ie(e[32][0]);return{c(){t=ce("div");n=ce("input");r=pe();o=ce("label");a=ce("b");a.textContent="Display name";l=pe();c=ce("input");f=pe();d=ce("label");h=ce("b");h.textContent="Provider";p=pe();m=ce("select");for(let e=0;e<P.length;e+=1){P[e].c()}g=pe();R.block.c();w=pe();b=ce("div");v=ce("button");Gn(x.$$.fragment);$e(n,"type","radio");$e(n,"name","selectedProxy");n.__value=s=e[108];n.value=n.__value;$e(n,"title","Set proxy as current");$e(n,"class","a");$e(a,"class","a");$e(c,"type","text");$e(c,"placeholder","Display name");$e(c,"class","a");$e(o,"class","over a");$e(h,"class","a");$e(m,"placeholder","Provider");$e(m,"class","a");if(e[106].typeId===void 0)Gt(A);$e(d,"class","over a");$e(v,"type","button");$e(v,"title","Delete proxy");$e(v,"class","a");$e(b,"class","buttons a");$e(t,"class","endpoint a");$.p(n)},m(s,i){ie(s,t,i);Z(t,n);n.checked=n.__value===e[0].selectedProxyIndex;Z(t,r);Z(t,o);Z(o,a);Z(o,l);Z(o,c);Ge(c,e[106].name);Z(t,f);Z(t,d);Z(d,h);Z(d,p);Z(d,m);for(let e=0;e<P.length;e+=1){if(P[e]){P[e].m(m,null)}}Ze(m,e[106].typeId,true);Z(t,g);R.block.m(t,R.anchor=null);R.mount=()=>t;R.anchor=w;Z(t,w);Z(t,b);Z(b,v);Yn(x,v,null);_=true;if(!k){E=[ye(n,"change",e[50]),ye(c,"input",C),ye(m,"change",A),ye(v,"click",M)];k=true}},p(t,s){e=t;if(s[0]&5){n.checked=n.__value===e[0].selectedProxyIndex}if(s[0]&4&&c.value!==e[106].name){Ge(c,e[106].name)}if(s&0){S=su.proxies;let t;for(t=0;t<S.length;t+=1){const n=Du(e,S,t);if(P[t]){P[t].p(n,s)}else{P[t]=tf(n);P[t].c();P[t].m(m,null)}}for(;t<P.length;t+=1){P[t].d(1)}P.length=S.length}if(s[0]&4){Ze(m,e[106].typeId)}R.ctx=e;if(s[0]&4&&y!==(y=su.getProxy(e[106].typeId))&&yn(y,R)){}else{wn(R,e,s)}const r=s[0]&16?En(F,[s&0&&{icon:Iu.FG},s[0]&16&&Cn(e[4])]):{};x.$set(r)},i(e){if(_)return;fn(x.$$.fragment,e);_=true},o(e){dn(x.$$.fragment,e);_=false},d(e){if(e)ae(t);le(P,e);R.block.d();R.token=null;R=null;Zn(x);$.r();k=false;u(E)}}}function cf(e){let t;let n;let s;let r;let o;let a;let l;let c;let f;let d;let h;let p;let m;let g;let y;let w;let b;let v;let x;let _;let $;let k;function E(){e[68].call(n,e[104],e[105])}function C(){e[69].call(r,e[104],e[105])}const S=[{icon:_u.FP},e[4]];let P={};for(let e=0;e<S.length;e+=1){P=i(P,S[e])}d=new js({props:P});function A(){return e[70](e[105])}const R=[{icon:xu.r5},e[4]];let F={};for(let e=0;e<R.length;e+=1){F=i(F,R[e])}g=new js({props:F});function I(){return e[71](e[105])}const M=[{icon:Iu.FG},e[4]];let T={};for(let e=0;e<M.length;e+=1){T=i(T,M[e])}v=new js({props:T});function L(){return e[72](e[105])}return{c(){t=ce("div");n=ce("input");s=pe();r=ce("textarea");l=pe();c=ce("div");f=ce("button");Gn(d.$$.fragment);p=pe();m=ce("button");Gn(g.$$.fragment);w=pe();b=ce("button");Gn(v.$$.fragment);x=pe();$e(n,"type","text");$e(n,"list","messageRole");$e(n,"placeholder","Role");$e(n,"class","a");$e(r,"placeholder",o="Message #"+e[103].id+" text");$e(r,"autocomplete","false");$e(r,"class","a");f.disabled=h=e[105]<=0;$e(f,"title","Move message up");$e(f,"class","a");$e(m,"type","button");m.disabled=y=e[105]>=e[3].length-1;$e(m,"title","Move message down");$e(m,"class","a");$e(b,"type","button");$e(b,"title","Delete message");$e(b,"class","a");$e(c,"class","buttons a");$e(t,"class","message a")},m(i,o){ie(i,t,o);Z(t,n);Ge(n,e[103].role);Z(t,s);Z(t,r);Ge(r,e[103].text);Z(t,l);Z(t,c);Z(c,f);Yn(d,f,null);Z(c,p);Z(c,m);Yn(g,m,null);Z(c,w);Z(c,b);Yn(v,b,null);Z(t,x);_=true;if(!$){k=[ye(n,"input",E),ye(r,"input",C),O(a=vf.call(null,r)),ye(f,"click",A),ye(m,"click",I),ye(b,"click",L)];$=true}},p(t,s){e=t;if(s[0]&8&&n.value!==e[103].role){Ge(n,e[103].role)}if(!_||s[0]&8&&o!==(o="Message #"+e[103].id+" text")){$e(r,"placeholder",o)}if(s[0]&8){Ge(r,e[103].text)}const i=s[0]&16?En(S,[s&0&&{icon:_u.FP},s[0]&16&&Cn(e[4])]):{};d.$set(i);const a=s[0]&16?En(R,[s&0&&{icon:xu.r5},s[0]&16&&Cn(e[4])]):{};g.$set(a);if(!_||s[0]&8&&y!==(y=e[105]>=e[3].length-1)){m.disabled=y}const l=s[0]&16?En(M,[s&0&&{icon:Iu.FG},s[0]&16&&Cn(e[4])]):{};v.$set(l)},i(e){if(_)return;fn(d.$$.fragment,e);fn(g.$$.fragment,e);fn(v.$$.fragment,e);_=true},o(e){dn(d.$$.fragment,e);dn(g.$$.fragment,e);dn(v.$$.fragment,e);_=false},d(e){if(e)ae(t);Zn(d);Zn(g);Zn(v);$=false;u(k)}}}function uf(e){let t;let n=e[100]+"";let s;let r;return{c(){t=ce("option");s=he(n);t.__value=r=e[100];t.value=t.__value;$e(t,"class","a")},m(e,n){ie(e,t,n);Z(t,s)},p(e,i){if(i[0]&512&&n!==(n=e[100]+""))Ve(s,n);if(i[0]&512&&r!==(r=e[100])){t.__value=r;t.value=t.__value}},d(e){if(e)ae(t)}}}function ff(e){let t;let n=e[97]+"";let r;let i;return{c(){t=ce("option");r=he(n);t.__value=i=e[97];t.value=t.__value;$e(t,"class","a")},m(e,n){ie(e,t,n);Z(t,r)},p:s,d(e){if(e)ae(t)}}}function df(e){let t;let n;let s=e[94].models;let r=[];for(let t=0;t<s.length;t+=1){r[t]=ff(Tu(e,s,t))}return{c(){t=ce("datalist");for(let e=0;e<r.length;e+=1){r[e].c()}$e(t,"id",n=""+(e[94].id+"-models"));$e(t,"class","a")},m(e,n){ie(e,t,n);for(let e=0;e<r.length;e+=1){if(r[e]){r[e].m(t,null)}}},p(e,n){if(n&0){s=e[94].models;let i;for(i=0;i<s.length;i+=1){const o=Tu(e,s,i);if(r[i]){r[i].p(o,n)}else{r[i]=ff(o);r[i].c();r[i].m(t,null)}}for(;i<r.length;i+=1){r[i].d(1)}r.length=s.length}},d(e){if(e)ae(t);le(r,e)}}}function hf(e){let t;let n;let s;let r;let o;let a;let l;let c;let f;let d;let h;let p;let m;let g;let y;let w;let b;let v;let x;let _;let $;let k;let E;let C;let S;let P;let A;let R;let F;let I;let M;let T;let L;let N;let j;let D;let q;let U;let B;let H;let W;let X;let z;let V;let J;let K;let G;let Q;let Y;let ee;let te;let ne;let se;let re;let oe;let ue;let fe;let de;let me;let ge;let we;let be;let ve;let xe;let _e;let ke;let Ee;let Ce;let Se;let Pe;let Ae;let Re;let Fe;let Ie;let Me;let Oe;let Te;let Le;let Ne;let je;let De;let qe;let Ue;let Be;let He;let We;let Xe;let ze;let Je;let Ke;let Qe;let et;let tt;let nt;let st;let rt;let it;let ot;let at;let lt;let ct;let ut;let ft;let dt;let ht;let pt;let mt;let gt;let yt;let wt;let bt;let vt;let xt;let _t;let $t;let kt;let Et;let Ct;let St;let Pt;let At;let Rt;let Ft;let It;let Mt;let Ot;let Tt;let Lt;let Nt;let jt;let Dt;let qt;let Ut;let Bt;let Ht;let Wt;let Xt;let zt;let Vt;let Jt;let Kt;let Qt;let Yt;let Zt;let en;let tn;let nn;let sn;let rn;let on;let an;let ln;let hn;let pn;let mn;let gn;let yn;let wn;let bn;let vn;let xn;let _n;let $n;let kn;let Sn;let Pn;let An;let Rn;let Fn;let In;let Mn;let On;let Tn;let Ln;let Nn;let jn;let Dn;let qn;let Un;let Bn;let Hn;let Wn;const Xn=[{icon:Pu.RL},e[4]];let zn={};for(let e=0;e<Xn.length;e+=1){zn=i(zn,Xn[e])}f=new js({props:zn});let Vn=e[1];let Jn=[];for(let t=0;t<Vn.length;t+=1){Jn[t]=ef(qu(e,Vn,t))}const Kn=e=>dn(Jn[e],1,1,(()=>{Jn[e]=null}));const Qn=[{icon:Pu.RL},e[4]];let es={};for(let e=0;e<Qn.length;e+=1){es=i(es,Qn[e])}y=new js({props:es});let ts=e[2];let ns=[];for(let t=0;t<ts.length;t+=1){ns[t]=lf(ju(e,ts,t))}const ss=e=>dn(ns[e],1,1,(()=>{ns[e]=null}));const rs=[{icon:Cu.cC},e[10]];let is={};for(let e=0;e<rs.length;e+=1){is=i(is,rs[e])}Re=new js({props:is});const os=[{icon:Cu.cC},e[10]];let as={};for(let e=0;e<os.length;e+=1){as=i(as,os[e])}Oe=new js({props:as});const ls=[{icon:Eu.Ed},e[10]];let cs={};for(let e=0;e<ls.length;e+=1){cs=i(cs,ls[e])}je=new js({props:cs});const us=[{icon:Cu.cC},e[10]];let fs={};for(let e=0;e<us.length;e+=1){fs=i(fs,us[e])}Xe=new js({props:fs});const ds=[{icon:Cu.cC},e[10]];let hs={};for(let e=0;e<ds.length;e+=1){hs=i(hs,ds[e])}Qe=new js({props:hs});const ps=[{icon:Eu.Ed},e[10]];let ms={};for(let e=0;e<ps.length;e+=1){ms=i(ms,ps[e])}st=new js({props:ms});let gs=e[3];let ys=[];for(let t=0;t<gs.length;t+=1){ys[t]=cf(Nu(e,gs,t))}const ws=e=>dn(ys[e],1,1,(()=>{ys[e]=null}));const bs=[{icon:Su.XC},e[4]];let vs={};for(let e=0;e<bs.length;e+=1){vs=i(vs,bs[e])}an=new js({props:vs});const xs=[{icon:Au.XE},e[4]];let _s={};for(let e=0;e<xs.length;e+=1){_s=i(_s,xs[e])}pn=new js({props:_s});const $s=[{icon:Fu.ct},e[4]];let ks={};for(let e=0;e<$s.length;e+=1){ks=i(ks,$s[e])}wn=new js({props:ks});const Es=[{icon:$u.gP},e[4]];let Cs={};for(let e=0;e<Es.length;e+=1){Cs=i(Cs,Es[e])}_n=new js({props:Cs});const Ss=[{icon:Pu.RL},e[4]];let Ps={};for(let e=0;e<Ss.length;e+=1){Ps=i(Ps,Ss[e])}Pn=new js({props:Ps});const As=[{icon:ku.kZ},e[4],{flip:"vertical"}];let Rs={};for(let e=0;e<As.length;e+=1){Rs=i(Rs,As[e])}Fn=new js({props:Rs});let Fs=su.getProvider(e[9]?.typeId).messageRoles;let Is=[];for(let t=0;t<Fs.length;t+=1){Is[t]=uf(Lu(e,Fs,t))}let Ms=su.providers.filter(xf);let Os=[];for(let t=0;t<Ms.length;t+=1){Os[t]=df(Ou(e,Ms,t))}return{c(){t=ce("div");n=ce("details");s=ce("summary");s.textContent="Options";r=pe();o=ce("div");a=ce("h3");l=he("API Endpoints ");c=ce("button");Gn(f.$$.fragment);d=pe();for(let e=0;e<Jn.length;e+=1){Jn[e].c()}h=pe();p=ce("h3");m=he("Proxies ");g=ce("button");Gn(y.$$.fragment);w=pe();for(let e=0;e<ns.length;e+=1){ns[e].c()}b=pe();v=ce("h3");v.textContent="Model options";x=pe();_=ce("div");$=ce("div");k=ce("label");k.textContent="Max tokens";E=pe();C=ce("input");S=pe();P=ce("div");A=ce("label");A.textContent="Temperature";R=pe();F=ce("input");I=pe();M=ce("div");T=ce("label");T.textContent="Frequency penalty";L=pe();N=ce("input");j=pe();D=ce("div");q=ce("label");q.textContent="Presence penalty";U=pe();B=ce("input");H=pe();W=ce("h3");W.textContent="Behavior";X=pe();z=ce("div");V=ce("div");J=ce("label");J.textContent="UI Density";K=pe();G=ce("select");Q=ce("option");Q.textContent="Compact";ee=ce("option");ee.textContent="Comfortable";ne=ce("option");ne.textContent="Accessible";re=pe();oe=ce("div");ue=ce("label");ue.textContent="Multi-message count";fe=pe();de=ce("input");me=pe();ge=ce("div");we=ce("label");we.textContent="Retry message count";be=pe();ve=ce("input");xe=pe();_e=ce("h3");_e.textContent="Backups";ke=pe();Ee=ce("div");Ce=ce("div");Se=ce("header");Se.textContent="Endpoints";Pe=pe();Ae=ce("button");Gn(Re.$$.fragment);Fe=he("Load");Ie=pe();Me=ce("button");Gn(Oe.$$.fragment);Te=he("Append");Le=pe();Ne=ce("button");Gn(je.$$.fragment);De=he("Save");qe=pe();Ue=ce("div");Be=ce("header");Be.textContent="Messages";He=pe();We=ce("button");Gn(Xe.$$.fragment);ze=he("Load");Je=pe();Ke=ce("button");Gn(Qe.$$.fragment);et=he("Append");tt=pe();nt=ce("button");Gn(st.$$.fragment);rt=he("Save");it=pe();ot=ce("details");at=ce("summary");at.textContent="Instructions";lt=pe();ct=ce("h3");ct.textContent="Scale API keys";ut=pe();ft=ce("p");ft.textContent="You can use one of the public keys or provide your own. Having your own keys gives more flexibility and better privacy. ";dt=ce("ol");ht=ce("li");ht.innerHTML=`Register on <a href="https://spellbook.scale.com/" class="a">Scale Spellbook</a>. `;pt=ce("li");pt.textContent='Create an "app". ';mt=ce("li");gt=he('Add a "prompt" with ');yt=ce("code");yt.textContent="model=GPT-4";wt=he(", ");bt=ce("code");bt.textContent="max_tokens=512";vt=he(", ");xt=ce("code");xt.textContent="temperature=1";_t=he(", ");$t=ce("code");$t.textContent=`user_template=${"{{"}input${"}}"}`;kt=he(". ");Et=ce("ul");Ct=ce("li");Ct.textContent="Max token limit drastically (non-linearly) affects how fast the website responds. You can try lowering it, especially if you plan to use it for chat, but forget about going above 1024 tokens. ";St=ce("li");St.textContent="Temperature affects how wild the generations are, where 0.0 generates consistent responses and 2.0 is completely nuts. Default value in OpenAI interface is 0.7. Recommended values are 0.4–1.0. ";Pt=ce("li");At=he("Adjust the template if you plan to use the app for chat or other purposes. GPT-4 model will see the text around ");Rt=ce("code");Rt.textContent=`${"{{"}input${"}}"}`;Ft=he(", but the chat app will not.");It=pe();Mt=ce("li");Mt.textContent='Add a "deployment" with this "prompt". ';Ot=ce("li");Ot.textContent="Add a new Scale API endpoint in the chat's options and copy API key and URL from Scale website.";Tt=pe();Lt=ce("h3");Lt.textContent="Proxy";Nt=pe();jt=ce("p");jt.textContent="The method of bypassing CORS restrictions for the chat script. One is enough. ";Dt=ce("ul");Dt.innerHTML=`<li class="a"><b class="a">Direct</b>: <ul class="a"><li class="a"><b class="a">User script</b> <i class="a">(desktop/mobile)</i>: Install <a href="https://athari.github.io/ScaleChat/userscripts/bypasscors.user.js" class="a">Bypass CORS</a> userscript. Install <a href="https://www.tampermonkey.net/" class="a">TamperMonkey</a> extension or any other user script manager first, in case you don&#39;t an option to install the script when you click the link. This method enables bypassing CORS only for specific user script and domain, however running locally is impossible and running on another server requires editing the user script. </li><li class="a"><b class="a">Extension</b> <i class="a">(desktop)</i>: Install <a href="https://microsoftedge.microsoft.com/addons/detail/cors-unblock/hkjklmhkbkdhlgnnfbbcihcajofmjgbh" class="a">CORS Unblock</a> extension. Click on the extension&#39;s button to enable it. This method allows to choose what websites bypass CORS and when. It allows running the script locally or on any server. </li><li class="a"><b class="a">Command Line</b> <i class="a">(desktop)</i>: Close all Chrome windows, then run it with <b class="a"><code class="a">chrome --no-web-security</code></b> command line. This method applies to all websites until you restart Chrome.</li></ul>  </li><li class="a"><b class="a">CORS demo</b> <i class="a">(desktop/mobile)</i>: Go to <a href="https://cors-anywhere.herokuapp.com/corsdemo" class="a">CORS Anywhere Demo</a> page and click on the button to enable it. You may be asked to solve CAPTCHA. Note that CORS Demo can timeout way earlier than actual API. This method allows all websites using that specific website to bypass CORS. </li><li class="a"><b class="a">Web proxy</b> <i class="a">(desktop/mobile)</i>: Use <a href="https://fishtailprotocol.com/projects/betterGPT4/" class="a">Web proxy by Feril</a>. No configuration required. This method works exclusively with Scale API.</li>`;qt=pe();Ut=ce("h3");Ut.textContent="Privacy";Bt=pe();Ht=ce("p");Ht.textContent="Privacy does not exist. ";Wt=ce("ul");Wt.innerHTML=`<li class="a">All your prompts and responses are visible to the owner of the Scale API key. </li><li class="a">All your prompts, responses and keys are visible to the company that owns Scale API. </li><li class="a">All your prompts, responses and keys are visible to the owner of CORS and web proxies.</li>`;Xt=pe();zt=ce("p");zt.textContent="Recommendations for maximum privacy: ";Vt=ce("ul");Vt.innerHTML=`<li class="a">Do not use public Scale API keys. <lI class="a">Do not use proxies owned by people you don&#39;t trust. <li class="a">Do not send any information which could be used to identify you. </li><li class="a">Do register on Scale with fake data, including fake email. </li><li class="a">Do live in countries where FBI can&#39;t reach you and put in jail for having bad thoughts.</li></lI></li>`;Jt=pe();Kt=ce("div");for(let e=0;e<ys.length;e+=1){ys[e].c()}Qt=pe();Yt=ce("div");Zt=ce("input");en=pe();tn=ce("textarea");sn=pe();rn=ce("div");on=ce("button");Gn(an.$$.fragment);ln=pe();hn=ce("button");Gn(pn.$$.fragment);gn=pe();yn=ce("button");Gn(wn.$$.fragment);vn=pe();xn=ce("button");Gn(_n.$$.fragment);kn=pe();Sn=ce("button");Gn(Pn.$$.fragment);An=pe();Rn=ce("button");Gn(Fn.$$.fragment);In=pe();Mn=ce("div");On=ce("p");Tn=he(e[8]);Ln=pe();Nn=ce("p");jn=he(e[7]);Dn=pe();qn=ce("datalist");for(let e=0;e<Is.length;e+=1){Is[e].c()}Un=pe();for(let e=0;e<Os.length;e+=1){Os[e].c()}$e(s,"class","a");$e(c,"title","Add endpoint");$e(c,"class","a");$e(a,"class","a");$e(g,"title","Add proxy");$e(g,"class","a");$e(p,"class","a");$e(v,"class","a");$e(k,"for","maxTokens");$e(k,"class","a");$e(C,"type","text");$e(C,"id","maxTokens");$e(C,"class","a");$e($,"class","option a");$e(A,"for","temperature");$e(A,"class","a");$e(F,"type","text");$e(F,"id","temperature");$e(F,"class","a");$e(P,"class","option a");$e(T,"for","frequencyPenalty");$e(T,"class","a");$e(N,"type","text");$e(N,"id","frequencyPenalty");$e(N,"class","a");$e(M,"class","option a");$e(q,"for","presencePenalty");$e(q,"class","a");$e(B,"type","text");$e(B,"id","presencePenalty");$e(B,"class","a");$e(D,"class","option a");$e(_,"class","options a");$e(W,"class","a");$e(J,"for","density");$e(J,"class","a");Q.__value=Y="compact";Q.value=Q.__value;$e(Q,"class","a");ee.__value=te="mobile";ee.value=ee.__value;$e(ee,"class","a");ne.__value=se="access";ne.value=ne.__value;$e(ne,"class","a");$e(G,"id","density");$e(G,"class","a");if(e[0].density===void 0)Gt((()=>e[59].call(G)));$e(V,"class","option a");$e(ue,"for","multiMessageCount");$e(ue,"class","a");$e(de,"type","text");$e(de,"id","multiMessageCount");$e(de,"class","a");$e(oe,"class","option a");$e(we,"for","retryMessageCount");$e(we,"class","a");$e(ve,"type","text");$e(ve,"id","retryMessageCount");$e(ve,"class","a");$e(ge,"class","option a");$e(z,"class","options a");$e(_e,"class","a");$e(Se,"class","a");$e(Ae,"type","button");$e(Ae,"class","a");$e(Me,"type","button");$e(Me,"class","a");$e(Ne,"type","button");$e(Ne,"class","a");$e(Ce,"class","option-long a");$e(Be,"class","a");$e(We,"type","button");$e(We,"class","a");$e(Ke,"type","button");$e(Ke,"class","a");$e(nt,"type","button");$e(nt,"class","a");$e(Ue,"class","option-long a");$e(Ee,"class","options a");$e(o,"class","endpoints a");$e(at,"class","a");$e(ct,"class","a");$e(ft,"class","a");$e(ht,"class","a");$e(pt,"class","a");$e(yt,"class","a");$e(bt,"class","a");$e(xt,"class","a");$e($t,"class","a");$e(Ct,"class","a");$e(St,"class","a");$e(Rt,"class","a");$e(Pt,"class","a");$e(Et,"class","a");$e(mt,"class","a");$e(Mt,"class","a");$e(Ot,"class","a");$e(dt,"class","a");$e(Lt,"class","a");$e(jt,"class","a");$e(Dt,"class","a");$e(Ut,"class","a");$e(Ht,"class","a");$e(Wt,"class","a");$e(zt,"class","a");$e(Vt,"class","a");$e(ot,"class","a");n.open=true;$e(n,"class","a");$e(Kt,"class","messages a");$e(Zt,"type","text");Zt.disabled=e[6];$e(Zt,"list","messageRole");$e(Zt,"placeholder","New message role");$e(Zt,"class","a");tn.disabled=e[6];$e(tn,"placeholder","New message text");$e(tn,"autocomplete","false");$e(tn,"class","a");$e(on,"type","button");on.disabled=e[6];$e(on,"title","Send message");$e(on,"class","a");$e(hn,"type","button");hn.disabled=e[6];$e(hn,"title",mn="Send message and receive "+e[0].multiMessageCount+" messages");$e(hn,"class","a");$e(yn,"type","button");yn.disabled=e[6];$e(yn,"title",bn="Try sending message "+e[0].retryMessageCount+" times");$e(yn,"class","a");$e(xn,"type","button");xn.disabled=$n=!e[6];$e(xn,"title","Cancel sending");$e(xn,"class","a");$e(Sn,"type","button");Sn.disabled=e[6];$e(Sn,"title","Add message without sending");$e(Sn,"class","a");$e(Rn,"type","button");$e(Rn,"title","Copy all messages to clipboard");$e(Rn,"class","a");$e(rn,"class","buttons a");$e(Yt,"class","message new-message a");$e(On,"class","message a");$e(Nn,"class","time a");Ye(Nn,"display",e[6]?"block":"none");$e(Mn,"class","status a");$e(qn,"id","messageRole");$e(qn,"class","a");$e(t,"class","app a")},m(i,u){ie(i,t,u);Z(t,n);Z(n,s);Z(n,r);Z(n,o);Z(o,a);Z(a,l);Z(a,c);Yn(f,c,null);Z(o,d);for(let e=0;e<Jn.length;e+=1){if(Jn[e]){Jn[e].m(o,null)}}Z(o,h);Z(o,p);Z(p,m);Z(p,g);Yn(y,g,null);Z(o,w);for(let e=0;e<ns.length;e+=1){if(ns[e]){ns[e].m(o,null)}}Z(o,b);Z(o,v);Z(o,x);Z(o,_);Z(_,$);Z($,k);Z($,E);Z($,C);Ge(C,e[0].maxTokens);Z(_,S);Z(_,P);Z(P,A);Z(P,R);Z(P,F);Ge(F,e[0].temperature);Z(_,I);Z(_,M);Z(M,T);Z(M,L);Z(M,N);Ge(N,e[0].frequencyPenalty);Z(_,j);Z(_,D);Z(D,q);Z(D,U);Z(D,B);Ge(B,e[0].presencePenalty);Z(o,H);Z(o,W);Z(o,X);Z(o,z);Z(z,V);Z(V,J);Z(V,K);Z(V,G);Z(G,Q);Z(G,ee);Z(G,ne);Ze(G,e[0].density,true);Z(z,re);Z(z,oe);Z(oe,ue);Z(oe,fe);Z(oe,de);Ge(de,e[0].multiMessageCount);Z(z,me);Z(z,ge);Z(ge,we);Z(ge,be);Z(ge,ve);Ge(ve,e[0].retryMessageCount);Z(o,xe);Z(o,_e);Z(o,ke);Z(o,Ee);Z(Ee,Ce);Z(Ce,Se);Z(Ce,Pe);Z(Ce,Ae);Yn(Re,Ae,null);Z(Ae,Fe);Z(Ce,Ie);Z(Ce,Me);Yn(Oe,Me,null);Z(Me,Te);Z(Ce,Le);Z(Ce,Ne);Yn(je,Ne,null);Z(Ne,De);Z(Ee,qe);Z(Ee,Ue);Z(Ue,Be);Z(Ue,He);Z(Ue,We);Yn(Xe,We,null);Z(We,ze);Z(Ue,Je);Z(Ue,Ke);Yn(Qe,Ke,null);Z(Ke,et);Z(Ue,tt);Z(Ue,nt);Yn(st,nt,null);Z(nt,rt);Z(n,it);Z(n,ot);Z(ot,at);Z(ot,lt);Z(ot,ct);Z(ot,ut);Z(ot,ft);Z(ot,dt);Z(dt,ht);Z(dt,pt);Z(dt,mt);Z(mt,gt);Z(mt,yt);Z(mt,wt);Z(mt,bt);Z(mt,vt);Z(mt,xt);Z(mt,_t);Z(mt,$t);Z(mt,kt);Z(mt,Et);Z(Et,Ct);Z(Et,St);Z(Et,Pt);Z(Pt,At);Z(Pt,Rt);Z(Pt,Ft);Z(mt,It);Z(dt,Mt);Z(dt,Ot);Z(ot,Tt);Z(ot,Lt);Z(ot,Nt);Z(ot,jt);Z(ot,Dt);Z(ot,qt);Z(ot,Ut);Z(ot,Bt);Z(ot,Ht);Z(ot,Wt);Z(ot,Xt);Z(ot,zt);Z(ot,Vt);Z(t,Jt);Z(t,Kt);for(let e=0;e<ys.length;e+=1){if(ys[e]){ys[e].m(Kt,null)}}Z(t,Qt);Z(t,Yt);Z(Yt,Zt);Ge(Zt,e[5].role);Z(Yt,en);Z(Yt,tn);Ge(tn,e[5].text);Z(Yt,sn);Z(Yt,rn);Z(rn,on);Yn(an,on,null);Z(rn,ln);Z(rn,hn);Yn(pn,hn,null);Z(rn,gn);Z(rn,yn);Yn(wn,yn,null);Z(rn,vn);Z(rn,xn);Yn(_n,xn,null);Z(rn,kn);Z(rn,Sn);Yn(Pn,Sn,null);Z(rn,An);Z(rn,Rn);Yn(Fn,Rn,null);Z(t,In);Z(t,Mn);Z(Mn,On);Z(On,Tn);Z(Mn,Ln);Z(Mn,Nn);Z(Nn,jn);Z(t,Dn);Z(t,qn);for(let e=0;e<Is.length;e+=1){if(Is[e]){Is[e].m(qn,null)}}Z(t,Un);for(let e=0;e<Os.length;e+=1){if(Os[e]){Os[e].m(t,null)}}Bn=true;if(!Hn){Wn=[ye(Mu,"resize",bf),ye(c,"click",e[23]),ye(g,"click",e[26]),ye(C,"input",e[55]),ye(F,"input",e[56]),ye(N,"input",e[57]),ye(B,"input",e[58]),ye(G,"change",e[59]),ye(de,"input",e[60]),ye(ve,"input",e[61]),ye(Ae,"click",e[62]),ye(Me,"click",e[63]),ye(Ne,"click",e[64]),ye(We,"click",e[65]),ye(Ke,"click",e[66]),ye(nt,"click",e[67]),ye(Zt,"input",e[73]),ye(tn,"input",e[74]),O(nn=vf.call(null,tn)),ye(on,"click",e[75]),ye(hn,"click",e[76]),ye(yn,"click",e[77]),ye(xn,"click",e[18]),ye(Sn,"click",e[78]),ye(Rn,"click",e[22])];Hn=true}},p(e,n){const s=n[0]&16?En(Xn,[n&0&&{icon:Pu.RL},n[0]&16&&Cn(e[4])]):{};f.$set(s);if(n[0]&50331667){Vn=e[1];let t;for(t=0;t<Vn.length;t+=1){const s=qu(e,Vn,t);if(Jn[t]){Jn[t].p(s,n);fn(Jn[t],1)}else{Jn[t]=ef(s);Jn[t].c();fn(Jn[t],1);Jn[t].m(o,h)}}cn();for(t=Vn.length;t<Jn.length;t+=1){Kn(t)}un()}const r=n[0]&16?En(Qn,[n&0&&{icon:Pu.RL},n[0]&16&&Cn(e[4])]):{};y.$set(r);if(n[0]&134217749){ts=e[2];let t;for(t=0;t<ts.length;t+=1){const s=ju(e,ts,t);if(ns[t]){ns[t].p(s,n);fn(ns[t],1)}else{ns[t]=lf(s);ns[t].c();fn(ns[t],1);ns[t].m(o,b)}}cn();for(t=ts.length;t<ns.length;t+=1){ss(t)}un()}if(n[0]&1&&C.value!==e[0].maxTokens){Ge(C,e[0].maxTokens)}if(n[0]&1&&F.value!==e[0].temperature){Ge(F,e[0].temperature)}if(n[0]&1&&N.value!==e[0].frequencyPenalty){Ge(N,e[0].frequencyPenalty)}if(n[0]&1&&B.value!==e[0].presencePenalty){Ge(B,e[0].presencePenalty)}if(n[0]&1){Ze(G,e[0].density)}if(n[0]&1&&de.value!==e[0].multiMessageCount){Ge(de,e[0].multiMessageCount)}if(n[0]&1&&ve.value!==e[0].retryMessageCount){Ge(ve,e[0].retryMessageCount)}const i=n[0]&1024?En(rs,[n&0&&{icon:Cu.cC},n[0]&1024&&Cn(e[10])]):{};Re.$set(i);const a=n[0]&1024?En(os,[n&0&&{icon:Cu.cC},n[0]&1024&&Cn(e[10])]):{};Oe.$set(a);const l=n[0]&1024?En(ls,[n&0&&{icon:Eu.Ed},n[0]&1024&&Cn(e[10])]):{};je.$set(l);const c=n[0]&1024?En(us,[n&0&&{icon:Cu.cC},n[0]&1024&&Cn(e[10])]):{};Xe.$set(c);const u=n[0]&1024?En(ds,[n&0&&{icon:Cu.cC},n[0]&1024&&Cn(e[10])]):{};Qe.$set(u);const d=n[0]&1024?En(ps,[n&0&&{icon:Eu.Ed},n[0]&1024&&Cn(e[10])]):{};st.$set(d);if(n[0]&3145752){gs=e[3];let t;for(t=0;t<gs.length;t+=1){const s=Nu(e,gs,t);if(ys[t]){ys[t].p(s,n);fn(ys[t],1)}else{ys[t]=cf(s);ys[t].c();fn(ys[t],1);ys[t].m(Kt,null)}}cn();for(t=gs.length;t<ys.length;t+=1){ws(t)}un()}if(!Bn||n[0]&64){Zt.disabled=e[6]}if(n[0]&32&&Zt.value!==e[5].role){Ge(Zt,e[5].role)}if(!Bn||n[0]&64){tn.disabled=e[6]}if(n[0]&32){Ge(tn,e[5].text)}const p=n[0]&16?En(bs,[n&0&&{icon:Su.XC},n[0]&16&&Cn(e[4])]):{};an.$set(p);if(!Bn||n[0]&64){on.disabled=e[6]}const m=n[0]&16?En(xs,[n&0&&{icon:Au.XE},n[0]&16&&Cn(e[4])]):{};pn.$set(m);if(!Bn||n[0]&64){hn.disabled=e[6]}if(!Bn||n[0]&1&&mn!==(mn="Send message and receive "+e[0].multiMessageCount+" messages")){$e(hn,"title",mn)}const g=n[0]&16?En($s,[n&0&&{icon:Fu.ct},n[0]&16&&Cn(e[4])]):{};wn.$set(g);if(!Bn||n[0]&64){yn.disabled=e[6]}if(!Bn||n[0]&1&&bn!==(bn="Try sending message "+e[0].retryMessageCount+" times")){$e(yn,"title",bn)}const w=n[0]&16?En(Es,[n&0&&{icon:$u.gP},n[0]&16&&Cn(e[4])]):{};_n.$set(w);if(!Bn||n[0]&64&&$n!==($n=!e[6])){xn.disabled=$n}const v=n[0]&16?En(Ss,[n&0&&{icon:Pu.RL},n[0]&16&&Cn(e[4])]):{};Pn.$set(v);if(!Bn||n[0]&64){Sn.disabled=e[6]}const x=n[0]&16?En(As,[n&0&&{icon:ku.kZ},n[0]&16&&Cn(e[4]),As[2]]):{};Fn.$set(x);if(!Bn||n[0]&256)Ve(Tn,e[8]);if(!Bn||n[0]&128)Ve(jn,e[7]);if(n[0]&64){Ye(Nn,"display",e[6]?"block":"none")}if(n[0]&512){Fs=su.getProvider(e[9]?.typeId).messageRoles;let t;for(t=0;t<Fs.length;t+=1){const s=Lu(e,Fs,t);if(Is[t]){Is[t].p(s,n)}else{Is[t]=uf(s);Is[t].c();Is[t].m(qn,null)}}for(;t<Is.length;t+=1){Is[t].d(1)}Is.length=Fs.length}if(n&0){Ms=su.providers.filter(xf);let s;for(s=0;s<Ms.length;s+=1){const r=Ou(e,Ms,s);if(Os[s]){Os[s].p(r,n)}else{Os[s]=df(r);Os[s].c();Os[s].m(t,null)}}for(;s<Os.length;s+=1){Os[s].d(1)}Os.length=Ms.length}},i(e){if(Bn)return;fn(f.$$.fragment,e);for(let e=0;e<Vn.length;e+=1){fn(Jn[e])}fn(y.$$.fragment,e);for(let e=0;e<ts.length;e+=1){fn(ns[e])}fn(Re.$$.fragment,e);fn(Oe.$$.fragment,e);fn(je.$$.fragment,e);fn(Xe.$$.fragment,e);fn(Qe.$$.fragment,e);fn(st.$$.fragment,e);for(let e=0;e<gs.length;e+=1){fn(ys[e])}fn(an.$$.fragment,e);fn(pn.$$.fragment,e);fn(wn.$$.fragment,e);fn(_n.$$.fragment,e);fn(Pn.$$.fragment,e);fn(Fn.$$.fragment,e);Bn=true},o(e){dn(f.$$.fragment,e);Jn=Jn.filter(Boolean);for(let e=0;e<Jn.length;e+=1){dn(Jn[e])}dn(y.$$.fragment,e);ns=ns.filter(Boolean);for(let e=0;e<ns.length;e+=1){dn(ns[e])}dn(Re.$$.fragment,e);dn(Oe.$$.fragment,e);dn(je.$$.fragment,e);dn(Xe.$$.fragment,e);dn(Qe.$$.fragment,e);dn(st.$$.fragment,e);ys=ys.filter(Boolean);for(let e=0;e<ys.length;e+=1){dn(ys[e])}dn(an.$$.fragment,e);dn(pn.$$.fragment,e);dn(wn.$$.fragment,e);dn(_n.$$.fragment,e);dn(Pn.$$.fragment,e);dn(Fn.$$.fragment,e);Bn=false},d(e){if(e)ae(t);Zn(f);le(Jn,e);Zn(y);le(ns,e);Zn(Re);Zn(Oe);Zn(je);Zn(Xe);Zn(Qe);Zn(st);le(ys,e);Zn(an);Zn(pn);Zn(wn);Zn(_n);Zn(Pn);Zn(Fn);le(Is,e);le(Os,e);Hn=false;u(Wn)}}}const pf=20;function mf(){return(new Date).toISOString().substring(0,19).replace("T"," ").replaceAll(":","-")}function gf(e){wf({target:e.target.closest(".message").querySelector("textarea")})}function yf({target:e}){const t=window.pageYOffset;e.style.height="0";e.style.overflow="hidden";e.style.height=`${Math.max(e.scrollHeight,pf)+2}px`;e.style.overflow="";window.scrollTo(window.pageXOffset,t)}function wf({target:e}){yf({target:e});setTimeout((()=>{yf({target:e})}),50)}function bf(){for(const e of document.querySelectorAll("textarea"))yf({target:e})}function vf(e){wf({target:e});e.addEventListener("input",yf);return{destroy:()=>e.removeEventListener("input",yf)}}const xf=e=>e.models.length>0;function _f(e,t,n){"use strict";su.init();let s={selectedEndpointIndex:0,selectedProxyIndex:0,multiMessageCount:10,retryMessageCount:5,density:"compact",maxTokens:1024,temperature:1,frequencyPenalty:0,presencePenalty:0};let r=[su.createDefaultProviderConfig()];let i=[su.createDefaultProxyConfig()];let o=[{id:1,role:"user",text:"Hello GPT-4!"}];let a={id:0,role:"user",text:""};let l=false;let c=null;let u="";let f=0;let d="Welcome!";let h=null;let p=false;let m=null;let g=null;let y=null;let w={scale:1.3};let b=Object.assign({},w);const v={compact:1.3,mobile:1.7,access:2.1};const x=new Intl.NumberFormat("en-gb",{style:"unit",unit:"second",unitDisplay:"short",maximumFractionDigits:0});const _=new Intl.NumberFormat("en-gb",{style:"unit",unit:"millisecond",unitDisplay:"short",maximumFractionDigits:2});It((()=>{n(3,o=Ws("messages",o));n(1,r=Ws("endpoints",r));n(2,i=Ws("proxies",i));n(0,s=Ws("options",s));try{const e=B(new URLSearchParams(location.search));if(e!==null)n(0,s.selectedEndpointIndex=e,s);if(location.protocol=="about:")document.querySelector("head style").innerHTML=""}catch(e){console.log(e)}n(29,p=true);n(30,y=document.documentElement);setInterval((()=>{if(l)n(28,f++,f)}),1e3)}));function $(e,...t){console.log(e,...t);n(8,d=e)}function k(){S("Endpoints",r)}function E(){S("Proxies",i)}function C(){S("Messages",o)}function S(e,t){zs("application/json",`NotAIChat ${e} ${mf()}.json`,JSON.stringify(t,null," "))}async function P(e){const t=await Vs(".json, application/json");if(!(t instanceof Array&&typeof t[0].typeId=="string"))return;n(1,r=e?[...r,...t]:t)}async function A(e){const t=await Vs(".json, application/json");if(!(t instanceof Array&&typeof t[0].typeId=="string"))return;n(1,r=e?[...r,...t]:t)}async function R(e){const t=await Vs(".json, application/json");if(!(t instanceof Array&&typeof t[0].text=="string"))return;n(3,o=e?[...o,...t]:t);await Ds(0);bf()}function F(){const e=Math.max(...o.map((e=>e.id)));return Number.isFinite(e)?e+1:1}async function I(e,t,r){$("Sending message");N({target:e.target});n(6,l=true);const i=su.createConnection(m,g,s);if(i==null){$("No endpoint selected");return}h=new AbortController;const a=o.at(-1);let u=a?.text==""||a.role=="assistant"?a:null;let d=false;let p;const y={get signal(){return h.signal},get extraText(){return`${p} in ${J()}`},get messages(){return o}};Object.assign(i,{onMessage(e){if(e.mode!="done"){if(u==null){u={id:F(),text:e.text,role:e.role};n(3,o=[...o,u])}else{u.text+=e.text;n(3,o=[...o]);d|=e.text.length>0;gf({target:[...document.querySelectorAll(".messages textarea")].slice(-1)[0]})}}if(e.mode=="complete"||e.mode=="done")$(`Received message${y.extraText}`,e);else e.mode=="append";$(`Receiving message${y.extraText}`,e)},onLogMessage(e){if(e.data)$(e.text,...e.data);else $(e.text)},onError(e){$(e.text,e.error)}});for(let e=0;e<t;e++){p=t>1?` (${e+1}/${t})`:"";n(28,[c,f]=[performance.now(),0],f);try{await i.sendRequest(y)}catch(e){if(e instanceof DOMException&&e.name=="AbortError"){$(`User cancelled message${y.extraText}`,e);return}else{$(`Unexpected error${y.extraText}: ${e.message} `+`(Console and Network tabs in DevTools may contain extra details)`,e);continue}}if(h.signal.aborted||r&&d)break}n(6,l=false)}async function M(e){return await I(e,1,false)}async function O(e){return await I(e,+s.retryMessageCount,true)}async function T(e){return await I(e,+s.multiMessageCount,false)}function L(){if(h==null)return;n(6,l=false);h.abort();$("Receiving message cancelled")}function N(e){if(a.text=="")return;n(3,o=[...o,{id:F(),text:a.text,role:a.role}]);n(5,a.text="",a);gf(e)}async function j(e){n(3,o=o.filter(((t,n)=>n!==e)));await Ds(0);bf()}function D(e,t){if(o[e]===undefined||o[t]===undefined)return;n(3,[o[e],o[t]]=[o[t],o[e]],o);n(3,o=[...o])}async function q(){try{await navigator.clipboard.writeText(o.map((e=>e.text)).join("\n"));$("Messages copied to clipboard")}catch(e){$(`Failed to copy messages to clipboard: ${e.message}`,e)}}function U(){n(1,r=[...r,su.createDefaultProviderConfig()])}function B(e){const t={name:e.get("name")??"Shared endpoint",provider:e.get("provider"),key:e.get("key"),url:e.get("url")};const s=r.findIndex((e=>e.key==t.key));if(s!=-1)return s;else if(t.key==null)return null;const i=su.createDefaultProviderConfig().key;n(1,r=[...r.filter((e=>e.key!=i)),t]);return r.length-1}async function H(e){const t=r[e];const n=new URLSearchParams({name:t.name,provider:t.provider,key:t.key,url:t.url});const s=`${location.origin}${location.pathname}?${n}`;try{await navigator.clipboard.writeText(s);$(`Endpoint share link copied to clipboard: ${s}`)}catch(e){$(`Failed to copy endpoint share link to clipboard: ${e.message}`,e)}}function W(e){n(1,r=r.filter(((t,n)=>n!==e)));if(r[s.selectedEndpointIndex]===undefined)n(0,s.selectedEndpointIndex=null,s)}function X(){n(2,i=[...i,su.createDefaultProxyConfig()])}function z(e){n(2,i=i.filter(((t,n)=>n!==e)));if(i[s.selectedProxyIndex]===undefined)n(0,s.selectedProxyIndex=null,s)}function V(){return x.format((performance.now()-c)/1e3)}function J(){return _.format(performance.now()-c)}const K=[[],[]];function G(){s.selectedEndpointIndex=this.__value;n(0,s)}function Q(e,t){e[t].name=this.value;n(1,r)}function Y(e,t){e[t].typeId=tt(this);n(1,r)}function Z(e,t){e[t].key=this.value;n(1,r)}function ee(e,t){e[t].url=this.value;n(1,r)}function te(e,t){e[t].key=this.value;n(1,r)}function ne(e,t){e[t].apiVersion=this.value;n(1,r)}function se(e,t){e[t].resource=this.value;n(1,r)}function re(e,t){e[t].deployment=this.value;n(1,r)}function ie(e,t){e[t].key=this.value;n(1,r)}function oe(e,t){e[t].workspace=this.value;n(1,r)}function ae(e,t){e[t].key=this.value;n(1,r)}function le(e,t){e[t].url=this.value;n(1,r)}function ce(e,t){e[t].model=this.value;n(1,r)}function ue(e,t){e[t].rawUrl=this.checked;n(1,r)}function fe(e,t){e[t].stream=this.checked;n(1,r)}const de=e=>H(e);const he=e=>W(e);function pe(){s.selectedProxyIndex=this.__value;n(0,s)}function me(e,t){e[t].name=this.value;n(2,i)}function ge(e,t){e[t].typeId=tt(this);n(2,i)}function ye(e,t){e[t].url=this.value;n(2,i)}const we=e=>z(e);function be(){s.maxTokens=this.value;n(0,s)}function ve(){s.temperature=this.value;n(0,s)}function xe(){s.frequencyPenalty=this.value;n(0,s)}function _e(){s.presencePenalty=this.value;n(0,s)}function $e(){s.density=tt(this);n(0,s)}function ke(){s.multiMessageCount=this.value;n(0,s)}function Ee(){s.retryMessageCount=this.value;n(0,s)}const Ce=()=>P(false);const Se=()=>P(true);const Pe=()=>k();const Ae=()=>R(false);const Re=()=>R(true);const Fe=()=>C();function Ie(e,t){e[t].role=this.value;n(3,o)}function Me(e,t){e[t].text=this.value;n(3,o)}const Oe=e=>D(e,e-1);const Te=e=>D(e,e+1);const Le=e=>j(e);function Ne(){a.role=this.value;n(5,a)}function je(){a.text=this.value;n(5,a)}const De=e=>M(e);const qe=e=>T(e);const Ue=e=>O(e);const Be=e=>N(e);e.$$.update=()=>{if(e.$$.dirty[0]&536870927){e:{if(p){Xs("messages",o);Xs("endpoints",r);Xs("proxies",i);Xs("options",s)}}}if(e.$$.dirty[0]&1073741825){e:y!==null&&(e=>n(30,y.className=`d-${e.density}`,y))(s)}if(e.$$.dirty[0]&1){e:s.density!==null&&bf()}if(e.$$.dirty[0]&1){e:n(4,w={scale:v[s.density]})}if(e.$$.dirty[0]&16){e:n(10,b=Object.assign({},w,{style:"margin: 0 calc(var(--gap) * 1.5) 0 calc(var(--gap) * 0.5)"}))}if(e.$$.dirty[0]&268435456){e:n(7,u=(()=>V())(f))}if(e.$$.dirty[0]&3){e:n(9,m=r[s.selectedEndpointIndex])}if(e.$$.dirty[0]&5){e:g=i[s.selectedProxyIndex]}};return[s,r,i,o,w,a,l,u,d,m,b,k,C,P,R,M,O,T,L,N,j,D,q,U,H,W,X,z,f,p,y,G,K,Q,Y,Z,ee,te,ne,se,re,ie,oe,ae,le,ce,ue,fe,de,he,pe,me,ge,ye,we,be,ve,xe,_e,$e,ke,Ee,Ce,Se,Pe,Ae,Re,Fe,Ie,Me,Oe,Te,Le,Ne,je,De,qe,Ue,Be]}class $f extends ss{constructor(e){super();ts(this,e,_f,hf,d,{},null,[-1,-1,-1,-1])}}const kf=$f;const Ef=new kf({target:document.querySelector("#root")});const Cf=null&&Ef})()})();</script></body></html>